<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>Time Series Forecasting with the Long Short-Term Memory Network in Python</title><link rel="stylesheet" href="https://machinelearningmastery.com/wp-content/cache/min/1/e6c897758d03cc796198492f28ebd15b.css" media="all" data-minify="1" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php" />
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>

	<!-- This site is optimized with the Yoast SEO plugin v16.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Time Series Forecasting with the Long Short-Term Memory Network in Python</title>
	<link rel="canonical" href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Time Series Forecasting with the Long Short-Term Memory Network in Python" />
	<meta property="og:description" content="The Long Short-Term Memory recurrent neural network has the promise of learning long sequences of observations. It seems a perfect [&hellip;]" />
	<meta property="og:url" content="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" />
	<meta property="og:site_name" content="Machine Learning Mastery" />
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:published_time" content="2017-04-06T19:00:50+00:00" />
	<meta property="article:modified_time" content="2020-08-27T23:38:40+00:00" />
	<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python.jpg" />
	<meta property="og:image:width" content="640" />
	<meta property="og:image:height" content="480" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Jason Brownlee">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="33 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://machinelearningmastery.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#primaryimage","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python.jpg","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python.jpg","width":640,"height":480,"caption":"Time Series Forecasting with the Long Short-Term Memory Network in Python Photo by Matt MacGillivray, some rights reserved."},{"@type":"WebPage","@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#webpage","url":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/","name":"Time Series Forecasting with the Long Short-Term Memory Network in Python","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#primaryimage"},"datePublished":"2017-04-06T19:00:50+00:00","dateModified":"2020-08-27T23:38:40+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/"]}]},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/","url":"https://machinelearningmastery.com/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/blog/","url":"https://machinelearningmastery.com/blog/","name":"Blog"}},{"@type":"ListItem","position":3,"item":{"@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#webpage"}}]},{"@type":"Article","@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#article","isPartOf":{"@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"Time Series Forecasting with the Long Short-Term Memory Network in Python","datePublished":"2017-04-06T19:00:50+00:00","dateModified":"2020-08-27T23:38:40+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#webpage"},"commentCount":667,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#primaryimage"},"articleSection":["Deep Learning for Time Series"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["http://MachineLearningMastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//ads.adthrive.com' />
<link rel='dns-prefetch' href='//www.google-analytics.com' />
<link rel='dns-prefetch' href='//loadeu.exelator.com' />
<link rel='dns-prefetch' href='//sync.crwdcntrl.net' />
<link rel='dns-prefetch' href='//gdpr-wrapper.privacymanager.io' />
<link rel='dns-prefetch' href='//securepubads.g.doubleclick.net' />
<link rel='dns-prefetch' href='//gdpr.privacymanager.io' />
<link rel='dns-prefetch' href='//sb.scorecardresearch.com' />
<link rel='dns-prefetch' href='//confiant-integrations.global.ssl.fastly.net' />

<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Feed" href="https://feeds.feedburner.com/MachineLearningMastery" />
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Comments Feed" href="https://machinelearningmastery.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Time Series Forecasting with the Long Short-Term Memory Network in Python Comments Feed" href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/feed/" />
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	










<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript" src='https://machinelearningmastery.com/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js' defer></script>



<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript" id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"50fa25f4c3"};
/* ]]> */
</script>




<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/" /><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/3882" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://machinelearningmastery.com/?p=3882' />
    <style type="text/css">

      .mpcs-classroom .nav-back i,
      .mpcs-classroom .navbar-section a.btn,
      .mpcs-classroom .navbar-section a,
      .mpcs-classroom .navbar-section button {
        color: rgba(255, 255, 255) !important;
      }

      .mpcs-classroom .navbar-section .dropdown .menu a {
        color: rgba(44, 54, 55) !important;
      }

      .mpcs-classroom .mpcs-progress-ring {
        background-color: rgba(29, 166, 154) !important;
      }

      .mpcs-classroom .mpcs-course-filter .dropdown .btn span,
      .mpcs-classroom .mpcs-course-filter .dropdown .btn i,
      .mpcs-classroom .mpcs-course-filter .input-group .input-group-btn,
      .mpcs-classroom .mpcs-course-filter .input-group .mpcs-search,
      .mpcs-classroom .mpcs-course-filter .input-group input[type=text],
      .mpcs-classroom .mpcs-course-filter .dropdown a,
      .mpcs-classroom .pagination,
      .mpcs-classroom .pagination i,
      .mpcs-classroom .pagination a {
        color: rgba(44, 54, 55) !important;
        border-color: rgba(44, 54, 55) !important;
      }

      /* body.mpcs-classroom a{
        color: rgba();
      } */

      #mpcs-navbar,
      #mpcs-navbar button#previous_lesson_link,
      #mpcs-navbar button#previous_lesson_link:hover {
        background: rgba(44, 54, 55);
      }

      .course-progress .user-progress,
      .btn-green,
      #mpcs-navbar button:not(#previous_lesson_link){
        background: rgba(29, 166, 154, 0.9);
      }

      .btn-green:hover,
      #mpcs-navbar button:not(#previous_lesson_link):focus,
      #mpcs-navbar button:not(#previous_lesson_link):hover{
        background: rgba(29, 166, 154);
      }

      .btn-green{border: rgba(29, 166, 154)}

      .course-progress .progress-text,
      .mpcs-lesson i.mpcs-circle-regular {
        color: rgba(29, 166, 154)
      }

      #mpcs-main #bookmark, .mpcs-lesson.current{background: rgba(29, 166, 154, 0.3)}

      .mpcs-instructor .tile-subtitle{
        color: rgba(29, 166, 154, 1)
      }

    </style>
     <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 3.2.2 -->
<meta property="og:title" content="Time Series Forecasting with the Long Short-Term Memory Network in Python - Machine Learning Mastery" />
<meta property="og:description" content="The Long Short-Term Memory recurrent neural network has the promise of learning long sequences of observations.

It seems a perfect match for time series forecasting, and in fact, it may be.

In this tutorial, you will discover how to develop an LSTM forecast model for a one-step univariate time series forecasting problem.

After completing this tutorial, you will know:

 	How to develop a" />
<meta property="og:url" content="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" />
<meta property="og:site_name" content="Machine Learning Mastery" />
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="The Long Short-Term Memory recurrent neural network has the promise of learning long sequences of observations.

It seems a perfect match for time series forecasting, and in fact, it may be.

In this tutorial, you will discover how to develop an LSTM forecast model for a one-step univariate time series forecasting problem.

After completing this tutorial, you will know:

 	How to develop a" />
<meta name="twitter:title" content="Time Series Forecasting with the Long Short-Term Memory Network in Python - Machine Learning Mastery" />
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python.jpg" />
    
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png"/>
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->


<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21" />
<meta name="generator" content="WooFramework 6.2.9" />



<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript">
(function(w, d) {
	w.adthrive = w.adthrive || {};
	w.adthrive.cmd = w.adthrive.cmd || [];
	w.adthrive.plugin = 'adthrive-ads-1.0.40-manual';
	w.adthrive.host = 'ads.adthrive.com';
	w.adthrive.threshold = Math.floor(Math.random() * 100 + 1);
	var s = d.createElement('script');
	s.async = true;
	s.referrerpolicy='no-referrer-when-downgrade';
	s.src = 'https://' + w.adthrive.host + '/sites/5d4c8ca4693e634b2e5d98cf/ads.min.js?referrer=' + w.encodeURIComponent(w.location.href) + '&threshold='+w.adthrive.threshold;
	var n = d.getElementsByTagName('script')[0];
	n.parentNode.insertBefore(s, n);
})(window, document);
</script><link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" />
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript></head>
<body class="post-template-default single single-post postid-3882 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img width="480" height="80" src="https://machinelearningmastery.com/wp-content/uploads/2019/09/Header_smaller_text_better-1.png" alt="Machine Learning Mastery" /></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-35" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<a href="https://machinelearningmastery.lpages.co/deep-learning-for-time-series-forecasting-mini-course/">Click to Take the FREE Deep Learning Time Series Crash-Course</a>
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/" >
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == 'Search...') {this.value = '';}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == '') {this.value = 'Search...';}" data-cf-modified-3b5abb8e72fb21a4ffcb9f32-="" />
		<input type="hidden" name="post_type" value="post" />
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-3882 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-time-series">
	<header>
	<h1 class="title entry-title">Time Series Forecasting with the Long Short-Term Memory Network in Python</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-04-07T05:00:50+1000">April 7, 2017</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/" title="View all items in Deep Learning for Time Series">Deep Learning for Time Series</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3882 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Time+Series+Forecasting+with+the+Long+Short-Term+Memory+Network+in+Python&url=https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-3b5abb8e72fb21a4ffcb9f32-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"/><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"/></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-3b5abb8e72fb21a4ffcb9f32-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-3b5abb8e72fb21a4ffcb9f32-="">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on August 28, 2020</p>
<p>The Long Short-Term Memory recurrent neural network has the promise of learning long sequences of observations.</p>
<p>It seems a perfect match for <a href="https://machinelearningmastery.com/time-series-forecasting/">time series forecasting</a>, and in fact, it may be.</p>
<p>In this tutorial, you will discover how to develop an LSTM forecast model for a one-step univariate time series forecasting problem.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to develop a baseline of performance for a forecast problem.</li>
<li>How to design a robust test harness for one-step time series forecasting.</li>
<li>How to prepare data, develop, and evaluate an LSTM recurrent neural network for time series forecasting.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/">Deep Learning for Time Series Forecasting</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let&#8217;s get started.</p>
<ul>
<li><strong>Update May/2017</strong>: Fixed bug in invert_scale() function, thanks Max.</li>
<li><strong>Updated Apr/2019</strong>: Updated the link to dataset.</li>
</ul>
<div id="attachment_3886" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3886" loading="lazy" class="size-full wp-image-3886" src="https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python.jpg" alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2017/04/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-300x225.jpg 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-3886" class="wp-caption-text">Time Series Forecasting with the Long Short-Term Memory Network in Python<br />Photo by <a href="https://www.flickr.com/photos/qmnonic/179791867/">Matt MacGillivray</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This is a big topic and we are going to cover a lot of ground. Strap in.</p>
<p>This tutorial is broken down into 9 parts; they are:</p>
<ol>
<li>Shampoo Sales Dataset</li>
<li>Test Setup</li>
<li>Persistence Model Forecast</li>
<li>LSTM Data Preparation</li>
<li>LSTM Model Development</li>
<li>LSTM Forecast</li>
<li>Complete LSTM Example</li>
<li>Develop a Robust Result</li>
<li>Tutorial Extensions</li>
</ol>
<h3>Python Environment</h3>
<p>This tutorial assumes you have a Python SciPy environment installed. You can use either Python 2 or 3 with this tutorial.</p>
<p>You must have Keras (2.0 or higher) installed with either the TensorFlow or Theano backend.</p>
<p>The tutorial also assumes you have scikit-learn, Pandas, NumPy and Matplotlib installed.</p>
<p>If you need help with your environment, see this post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a></li>
</ul>
<p><div class="woo-sc-hr"></div></p>
<center>
<h3>Need help with Deep Learning for Time Series?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" target="_blank" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" rel="noopener noreferrer">Download Your FREE Mini-Course</a></p>
</center>
<p><div class="woo-sc-hr"></div></p>
<h2>Shampoo Sales Dataset</h2>
<p>This dataset describes the monthly number of sales of shampoo over a 3-year period.</p>
<p>The units are a sales count and there are 36 observations. The original dataset is credited to Makridakis, Wheelwright, and Hyndman (1998).</p>
<ul>
<li><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/shampoo.csv">Download the dataset</a>.</li>
</ul>
<p>Download the dataset to your current working directory with the name &#8220;<em>shampoo-sales.csv</em>&#8220;.</p>
<p>The example below loads and creates a plot of the loaded dataset.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907b0955644108" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load and plot dataset
from pandas import read_csv
from pandas import datetime
from matplotlib import pyplot
# load dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)
# summarize first few rows
print(series.head())
# line plot
series.plot()
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b0955644108-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-1"><span class="crayon-p"># load and plot dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-5"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-6"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-7"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-8"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-9"><span class="crayon-p"># summarize first few rows</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-11"><span class="crayon-p"># line plot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-12"><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b0955644108-13"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example loads the dataset as a Pandas Series and prints the first 5 rows.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907b5776836824" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Month
1901-01-01 266.0
1901-02-01 145.9
1901-03-01 183.1
1901-04-01 119.3
1901-05-01 180.3
Name: Sales, dtype: float64</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b5776836824-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b5776836824-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b5776836824-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b5776836824-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b5776836824-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b5776836824-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b5776836824-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b5776836824-1">Month</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b5776836824-2">1901-01-01 266.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b5776836824-3">1901-02-01 145.9</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b5776836824-4">1901-03-01 183.1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b5776836824-5">1901-04-01 119.3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b5776836824-6">1901-05-01 180.3</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b5776836824-7">Name: Sales, dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A line plot of the series is then created showing a clear increasing trend.</p>
<div id="attachment_3867" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3867" loading="lazy" class="size-full wp-image-3867" src="https://machinelearningmastery.com/wp-content/uploads/2017/03/Line-Plot-of-Monthly-Shampoo-Sales-Dataset.png" alt="Line Plot of Monthly Shampoo Sales Dataset" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/03/Line-Plot-of-Monthly-Shampoo-Sales-Dataset.png 640w, https://machinelearningmastery.com/wp-content/uploads/2017/03/Line-Plot-of-Monthly-Shampoo-Sales-Dataset-300x225.png 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-3867" class="wp-caption-text">Line Plot of Monthly Shampoo Sales Dataset</p></div>
<h2>Experimental Test Setup</h2>
<p>We will split the Shampoo Sales dataset into two parts: a training and a test set.</p>
<p>The first two years of data will be taken for the training dataset and the remaining one year of data will be used for the test set.</p>
<p>For example:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907b7033915906" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# split data into train and test
X = series.values
train, test = X[0:-12], X[-12:]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b7033915906-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b7033915906-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b7033915906-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b7033915906-1"><span class="crayon-p"># split data into train and test</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b7033915906-2"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b7033915906-3"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Models will be developed using the training dataset and will make predictions on the test dataset.</p>
<p>A rolling forecast scenario will be used, also called walk-forward model validation.</p>
<p>Each time step of the test dataset will be walked one at a time. A model will be used to make a forecast for the time step, then the actual expected value from the test set will be taken and made available to the model for the forecast on the next time step.</p>
<p>For example:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907b9429416714" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# walk-forward validation
history = [x for x in train]
predictions = list()
for i in range(len(test)):
	# make prediction...</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b9429416714-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b9429416714-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b9429416714-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907b9429416714-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907b9429416714-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b9429416714-1"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b9429416714-2"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b9429416714-3"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907b9429416714-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907b9429416714-5"><span class="crayon-h">	</span><span class="crayon-p"># make prediction...</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>This mimics a real-world scenario where new Shampoo Sales observations would be available each month and used in the forecasting of the following month.</p>
<p>Finally, all forecasts on the test dataset will be collected and an error score calculated to summarize the skill of the model. The root mean squared error (RMSE) will be used as it punishes large errors and results in a score that is in the same units as the forecast data, namely monthly shampoo sales.</p>
<p>For example:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907ba039638872" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from sklearn.metrics import mean_squared_error
rmse = sqrt(mean_squared_error(test, predictions))
print('RMSE: %.3f' % rmse)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ba039638872-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ba039638872-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ba039638872-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ba039638872-1"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ba039638872-2"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ba039638872-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h2>Persistence Model Forecast</h2>
<p>A good baseline forecast for a time series with a linear increasing trend is a persistence forecast.</p>
<p>The persistence forecast is where the observation from the prior time step (t-1) is used to predict the observation at the current time step (t).</p>
<p>We can implement this by taking the last observation from the training data and history accumulated by walk-forward validation and using that to predict the current time step.</p>
<p>For example:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907bb822551861" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# make prediction
yhat = history[-1]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bb822551861-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bb822551861-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bb822551861-1"><span class="crayon-p"># make prediction</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bb822551861-2"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We will accumulate all predictions in an array so that they can be directly compared to the test dataset.</p>
<p>The complete example of the persistence forecast model on the Shampoo Sales dataset is listed below.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907bd598803610" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from pandas import read_csv
from pandas import datetime
from sklearn.metrics import mean_squared_error
from math import sqrt
from matplotlib import pyplot
# load dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)
# split data into train and test
X = series.values
train, test = X[0:-12], X[-12:]
# walk-forward validation
history = [x for x in train]
predictions = list()
for i in range(len(test)):
	# make prediction
	predictions.append(history[-1])
	# observation
	history.append(test[i])
# report performance
rmse = sqrt(mean_squared_error(test, predictions))
print('RMSE: %.3f' % rmse)
# line plot of observed vs predicted
pyplot.plot(test)
pyplot.plot(predictions)
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bd598803610-27">27</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-4"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-6"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-7"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-9"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-10"><span class="crayon-p"># split data into train and test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-11"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-12"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-13"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-14"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-15"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-16"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-17"><span class="crayon-h">	</span><span class="crayon-p"># make prediction</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-18"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-19"><span class="crayon-h">	</span><span class="crayon-p"># observation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-20"><span class="crayon-h">	</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-21"><span class="crayon-p"># report performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-22"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-24"><span class="crayon-p"># line plot of observed vs predicted</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-25"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-26"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bd598803610-27"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p><p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>
</p>
<p>Running the example prints the RMSE of about 136 monthly shampoo sales for the forecasts on the test dataset.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907bf133186289" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
RMSE: 136.761</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907bf133186289-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907bf133186289-1">RMSE: 136.761</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A line plot of the test dataset (blue) compared to the predicted values (orange) is also created showing the persistence model forecast in context.</p>
<div id="attachment_3883" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3883" loading="lazy" class="size-full wp-image-3883" src="https://machinelearningmastery.com/wp-content/uploads/2017/03/Persistence-Forecast-of-Observed-vs-Predicted-for-Shampoo-Sales-Dataset.png" alt="Persistence Forecast of Observed vs Predicted for Shampoo Sales Dataset" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/03/Persistence-Forecast-of-Observed-vs-Predicted-for-Shampoo-Sales-Dataset.png 640w, https://machinelearningmastery.com/wp-content/uploads/2017/03/Persistence-Forecast-of-Observed-vs-Predicted-for-Shampoo-Sales-Dataset-300x225.png 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-3883" class="wp-caption-text">Persistence Forecast of Observed vs Predicted for Shampoo Sales Dataset</p></div>
<p>For more on the persistence model for time series forecasting, see this post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/">How to Make Baseline Predictions for Time Series Forecasting with Python</a></li>
</ul>
<p>Now that we have a baseline of performance on the dataset, we can get started developing an LSTM model for the data.</p>
<div class="woo-sc-hr"></div>
<center>
<h3>Need help with LSTMs for Sequence Prediction?</h3>
<p>Take my free 7-day email course and discover 6 different LSTM architectures (with code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" href="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" target="_blank" rel="noopener noreferrer">Start Your FREE Mini-Course Now!</a></p>
</center>
<div class="woo-sc-hr"></div>
<h2>LSTM Data Preparation</h2>
<p>Before we can fit an LSTM model to the dataset, we must transform the data.</p>
<p>This section is broken down into three steps:</p>
<ol>
<li>Transform the time series into a supervised learning problem</li>
<li>Transform the time series data so that it is stationary.</li>
<li>Transform the observations to have a specific scale.</li>
</ol>
<h3>Transform Time Series to Supervised Learning</h3>
<p>The LSTM model in Keras assumes that your data is divided into input (X) and output (y) components.</p>
<p>For a time series problem, we can achieve this by using the observation from the last time step (t-1) as the input and the observation at the current time step (t) as the output.</p>
<p>We can achieve this using the <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.shift.html">shift()</a> function in Pandas that will push all values in a series down by a specified number places. We require a shift of 1 place, which will become the input variables. The time series as it stands will be the output variables.</p>
<p>We can then concatenate these two series together to create a DataFrame ready for supervised learning. The pushed-down series will have a new position at the top with no value. A NaN (not a number) value will be used in this position. We will replace these NaN values with 0 values, which the LSTM model will have to learn as &#8220;the start of the series&#8221; or &#8220;I have no data here,” as a month with zero sales on this dataset has not been observed.</p>
<p>The code below defines a helper function to do this called <em>timeseries_to_supervised()</em>. It takes a NumPy array of the raw time series data and a lag or number of shifted series to create and use as inputs.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907c0016680128" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# frame a sequence as a supervised learning problem
def timeseries_to_supervised(data, lag=1):
	df = DataFrame(data)
	columns = [df.shift(i) for i in range(1, lag+1)]
	columns.append(df)
	df = concat(columns, axis=1)
	df.fillna(0, inplace=True)
	return df</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c0016680128-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-1"><span class="crayon-p"># frame a sequence as a supervised learning problem</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-2"><span class="crayon-e">def </span><span class="crayon-e">timeseries_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-3"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-4"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-5"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-6"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-7"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">fillna</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c0016680128-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We can test this function with our loaded Shampoo Sales dataset and convert it into a supervised learning problem.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907c2167040639" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from pandas import read_csv
from pandas import datetime
from pandas import DataFrame
from pandas import concat

# frame a sequence as a supervised learning problem
def timeseries_to_supervised(data, lag=1):
	df = DataFrame(data)
	columns = [df.shift(i) for i in range(1, lag+1)]
	columns.append(df)
	df = concat(columns, axis=1)
	df.fillna(0, inplace=True)
	return df

# load dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)
# transform to supervised learning
X = series.values
supervised = timeseries_to_supervised(X, 1)
print(supervised.head())</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c2167040639-22">22</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-i">concat</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-6"><span class="crayon-p"># frame a sequence as a supervised learning problem</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-7"><span class="crayon-e">def </span><span class="crayon-e">timeseries_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-8"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-9"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-10"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-11"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-12"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">fillna</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-13"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">df</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-15"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-16"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-17"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-18"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-19"><span class="crayon-p"># transform to supervised learning</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-20"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-21"><span class="crayon-v">supervised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">timeseries_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c2167040639-22"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">supervised</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example prints the first 5 rows of the new supervised learning problem.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907c3776074161" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
            0           0
0    0.000000  266.000000
1  266.000000  145.899994
2  145.899994  183.100006
3  183.100006  119.300003
4  119.300003  180.300003</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c3776074161-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c3776074161-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c3776074161-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c3776074161-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c3776074161-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c3776074161-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c3776074161-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c3776074161-2">0&nbsp;&nbsp;&nbsp;&nbsp;0.000000&nbsp;&nbsp;266.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c3776074161-3">1&nbsp;&nbsp;266.000000&nbsp;&nbsp;145.899994</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c3776074161-4">2&nbsp;&nbsp;145.899994&nbsp;&nbsp;183.100006</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c3776074161-5">3&nbsp;&nbsp;183.100006&nbsp;&nbsp;119.300003</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c3776074161-6">4&nbsp;&nbsp;119.300003&nbsp;&nbsp;180.300003</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>For more information on transforming a time series problem into a supervised learning problem, see the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/">Time Series Forecasting as Supervised Learning</a></li>
</ul>
<h3>Transform Time Series to Stationary</h3>
<p>The Shampoo Sales dataset is not stationary.</p>
<p>This means that there is a structure in the data that is dependent on the time. Specifically, there is an increasing trend in the data.</p>
<p>Stationary data is easier to model and will very likely result in more skillful forecasts.</p>
<p>The trend can be removed from the observations, then added back to forecasts later to return the prediction to the original scale and calculate a comparable error score.</p>
<p>A standard way to remove a trend is by differencing the data. That is the observation from the previous time step (t-1) is subtracted from the current observation (t). This removes the trend and we are left with a difference series, or the changes to the observations from one time step to the next.</p>
<p>We can achieve this automatically using the <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.diff.html">diff() function</a> in pandas. Alternatively, we can get finer grained control and write our own function to do this, which is preferred for its flexibility in this case.</p>
<p>Below is a function called <em>difference()</em> that calculates a differenced series. Note that the first observation in the series is skipped as there is no prior observation with which to calculate a differenced value.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907c5110755179" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return Series(diff)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c5110755179-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c5110755179-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c5110755179-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c5110755179-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c5110755179-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c5110755179-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c5110755179-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c5110755179-1"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c5110755179-2"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c5110755179-3"><span class="crayon-h">	</span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c5110755179-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c5110755179-5"><span class="crayon-h">		</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c5110755179-6"><span class="crayon-h">		</span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c5110755179-7"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We also need to invert this process in order to take forecasts made on the differenced series back into their original scale.</p>
<p>The function below, called <em>inverse_difference()</em>, inverts this operation.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907c6066348305" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c6066348305-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c6066348305-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c6066348305-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c6066348305-1"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c6066348305-2"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c6066348305-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We can test out these functions by differencing the whole series, then returning it to the original scale, as follows:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907c8441388066" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from pandas import read_csv
from pandas import datetime
from pandas import Series

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return Series(diff)

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# load dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)
print(series.head())
# transform to be stationary
differenced = difference(series, 1)
print(differenced.head())
# invert transform
inverted = list()
for i in range(len(differenced)):
	value = inverse_difference(series, differenced[i], len(series)-i)
	inverted.append(value)
inverted = Series(inverted)
print(inverted.head())</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c8441388066-31">31</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-i">Series</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-5"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-6"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-7"><span class="crayon-h">	</span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-9"><span class="crayon-h">		</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-10"><span class="crayon-h">		</span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-13"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-14"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-17"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-18"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-19"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-20"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-21"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-22"><span class="crayon-p"># transform to be stationary</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-23"><span class="crayon-v">differenced</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">differenced</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-25"><span class="crayon-p"># invert transform</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-26"><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-27"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">differenced</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-28"><span class="crayon-h">	</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">differenced</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-29"><span class="crayon-h">	</span><span class="crayon-v">inverted</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-30"><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">inverted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c8441388066-31"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inverted</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example prints the first 5 rows of the loaded data, then the first 5 rows of the differenced series, then finally the first 5 rows with the difference operation inverted.</p>
<p>Note that the first observation in the original dataset was removed from the inverted difference data. Besides that, the last set of data matches the first as expected.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907c9026179719" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Month
1901-01-01    266.0
1901-02-01    145.9
1901-03-01    183.1
1901-04-01    119.3
1901-05-01    180.3

Name: Sales, dtype: float64
0   -120.1
1     37.2
2    -63.8
3     61.0
4    -11.8
dtype: float64

0    145.9
1    183.1
2    119.3
3    180.3
4    168.5
dtype: float64</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907c9026179719-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-1">Month</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-2">1901-01-01&nbsp;&nbsp;&nbsp;&nbsp;266.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-3">1901-02-01&nbsp;&nbsp;&nbsp;&nbsp;145.9</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-4">1901-03-01&nbsp;&nbsp;&nbsp;&nbsp;183.1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-5">1901-04-01&nbsp;&nbsp;&nbsp;&nbsp;119.3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-6">1901-05-01&nbsp;&nbsp;&nbsp;&nbsp;180.3</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-8">Name: Sales, dtype: float64</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-9">0&nbsp;&nbsp; -120.1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-10">1&nbsp;&nbsp;&nbsp;&nbsp; 37.2</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-11">2&nbsp;&nbsp;&nbsp;&nbsp;-63.8</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-12">3&nbsp;&nbsp;&nbsp;&nbsp; 61.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-13">4&nbsp;&nbsp;&nbsp;&nbsp;-11.8</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-14">dtype: float64</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-16">0&nbsp;&nbsp;&nbsp;&nbsp;145.9</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-17">1&nbsp;&nbsp;&nbsp;&nbsp;183.1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-18">2&nbsp;&nbsp;&nbsp;&nbsp;119.3</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-19">3&nbsp;&nbsp;&nbsp;&nbsp;180.3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-20">4&nbsp;&nbsp;&nbsp;&nbsp;168.5</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907c9026179719-21">dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>For more information on making the time series stationary and differencing, see the posts:</p>
<ul>
<li><a href="https://machinelearningmastery.com/time-series-data-stationary-python/">How to Check if Time Series Data is Stationary with Python</a></li>
<li><a href="https://machinelearningmastery.com/difference-time-series-dataset-python/">How to Difference a Time Series Dataset with Python</a></li>
</ul>
<h3>Transform Time Series to Scale</h3>
<p>Like other neural networks, LSTMs expect data to be within the scale of the activation function used by the network.</p>
<p>The default activation function for LSTMs is the hyperbolic tangent (<em>tanh</em>), which outputs values between -1 and 1. This is the preferred range for the time series data.</p>
<p>To make the experiment fair, the scaling coefficients (min and max) values must be calculated on the training dataset and applied to scale the test dataset and any forecasts. This is to avoid contaminating the experiment with knowledge from the test dataset, which might give the model a small edge.</p>
<p>We can transform the dataset to the range [-1, 1] using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html">MinMaxScaler class</a>. Like other scikit-learn transform classes, it requires data provided in a matrix format with rows and columns. Therefore, we must reshape our NumPy arrays before transforming.</p>
<p>For example:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907cb433109204" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# transform scale
X = series.values
X = X.reshape(len(X), 1)
scaler = MinMaxScaler(feature_range=(-1, 1))
scaler = scaler.fit(X)
scaled_X = scaler.transform(X)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cb433109204-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cb433109204-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cb433109204-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cb433109204-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cb433109204-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cb433109204-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cb433109204-1"><span class="crayon-p"># transform scale</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cb433109204-2"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cb433109204-3"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cb433109204-4"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cb433109204-5"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cb433109204-6"><span class="crayon-v">scaled_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Again, we must invert the scale on forecasts to return the values back to the original scale so that the results can be interpreted and a comparable error score can be calculated.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907cc852440147" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# invert transform
inverted_X = scaler.inverse_transform(scaled_X)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cc852440147-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cc852440147-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cc852440147-1"><span class="crayon-p"># invert transform</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cc852440147-2"><span class="crayon-v">inverted_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">scaled_X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Putting all of this together, the example below transforms the scale of the Shampoo Sales data.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907cd515146669" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from pandas import read_csv
from pandas import datetime
from pandas import Series
from sklearn.preprocessing import MinMaxScaler
# load dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)
print(series.head())
# transform scale
X = series.values
X = X.reshape(len(X), 1)
scaler = MinMaxScaler(feature_range=(-1, 1))
scaler = scaler.fit(X)
scaled_X = scaler.transform(X)
scaled_series = Series(scaled_X[:, 0])
print(scaled_series.head())
# invert transform
inverted_X = scaler.inverse_transform(scaled_X)
inverted_series = Series(inverted_X[:, 0])
print(inverted_series.head())</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cd515146669-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-i">MinMaxScaler</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-5"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-6"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-7"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-8"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-9"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-10"><span class="crayon-p"># transform scale</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-11"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-13"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-14"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-15"><span class="crayon-v">scaled_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-16"><span class="crayon-v">scaled_series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">scaled_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">scaled_series</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-18"><span class="crayon-p"># invert transform</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-19"><span class="crayon-v">inverted_X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">scaled_X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-20"><span class="crayon-v">inverted_series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">inverted_X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cd515146669-21"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inverted_series</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example first prints the first 5 rows of the loaded data, then the first 5 rows of the scaled data, then the first 5 rows with the scale transform inverted, matching the original data.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907cf492088565" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Month
1901-01-01    266.0
1901-02-01    145.9
1901-03-01    183.1
1901-04-01    119.3
1901-05-01    180.3

Name: Sales, dtype: float64
0   -0.478585
1   -0.905456
2   -0.773236
3   -1.000000
4   -0.783188
dtype: float64

0    266.0
1    145.9
2    183.1
3    119.3
4    180.3
dtype: float64</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907cf492088565-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-1">Month</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-2">1901-01-01&nbsp;&nbsp;&nbsp;&nbsp;266.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-3">1901-02-01&nbsp;&nbsp;&nbsp;&nbsp;145.9</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-4">1901-03-01&nbsp;&nbsp;&nbsp;&nbsp;183.1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-5">1901-04-01&nbsp;&nbsp;&nbsp;&nbsp;119.3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-6">1901-05-01&nbsp;&nbsp;&nbsp;&nbsp;180.3</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-8">Name: Sales, dtype: float64</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-9">0&nbsp;&nbsp; -0.478585</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-10">1&nbsp;&nbsp; -0.905456</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-11">2&nbsp;&nbsp; -0.773236</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-12">3&nbsp;&nbsp; -1.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-13">4&nbsp;&nbsp; -0.783188</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-14">dtype: float64</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-16">0&nbsp;&nbsp;&nbsp;&nbsp;266.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-17">1&nbsp;&nbsp;&nbsp;&nbsp;145.9</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-18">2&nbsp;&nbsp;&nbsp;&nbsp;183.1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-19">3&nbsp;&nbsp;&nbsp;&nbsp;119.3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-20">4&nbsp;&nbsp;&nbsp;&nbsp;180.3</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907cf492088565-21">dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Now that we know how to prepare data for the LSTM network, we can start developing our model.</p>
<h2>LSTM Model Development</h2>
<p>The Long Short-Term Memory network (LSTM) is a type of Recurrent Neural Network (RNN).</p>
<p>A benefit of this type of network is that it can learn and remember over long sequences and does not rely on a pre-specified window lagged observation as input.</p>
<p>In Keras, this is referred to as stateful, and involves setting the &#8220;<em>stateful</em>&#8221; argument to &#8220;<em>True</em>&#8221; when defining an LSTM layer.</p>
<p>By default, an LSTM layer in Keras maintains state between data within one batch. A batch of data is a fixed-sized number of rows from the training dataset that defines how many patterns to process before updating the weights of the network. State in the LSTM layer between batches is cleared by default, therefore we must make the LSTM stateful. This gives us fine-grained control over when state of the LSTM layer is cleared, by calling the <em>reset_states()</em> function.</p>
<p>The LSTM layer expects input to be in a matrix with the dimensions: [<em>samples, time steps, features</em>].</p>
<ul>
<li><strong>Samples</strong>: These are independent observations from the domain, typically rows of data.</li>
<li><strong>Time steps</strong>: These are separate time steps of a given variable for a given observation.</li>
<li><strong>Features</strong>: These are separate measures observed at the time of observation.</li>
</ul>
<p>We have some flexibility in how the Shampoo Sales dataset is framed for the network. We will keep it simple and frame the problem as each time step in the original sequence is one separate sample, with one timestep and one feature.</p>
<p>Given that the training dataset is defined as X inputs and y outputs, it must be reshaped into the Samples/TimeSteps/Features format, for example:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907d0489029682" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
X, y = train[:, 0:-1], train[:, -1]
X = X.reshape(X.shape[0], 1, X.shape[1])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907d0489029682-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907d0489029682-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907d0489029682-1"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907d0489029682-2"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The shape of the input data must be specified in the LSTM layer using the &#8220;<em>batch_input_shape</em>&#8221; argument as a tuple that specifies the expected number of observations to read each batch, the number of time steps, and the number of features.</p>
<p>The batch size is often much smaller than the total number of samples. It, along with the number of epochs, defines how quickly the network learns the data (how often the weights are updated).</p>
<p>The final import parameter in defining the LSTM layer is the number of neurons, also called the number of memory units or blocks. This is a reasonably simple problem and a number between 1 and 5 should be sufficient.</p>
<p>The line below creates a single LSTM hidden layer that also specifies the expectations of the input layer via the &#8220;<em>batch_input_shape</em>&#8221; argument.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907e0804967625" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
layer = LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907e0804967625-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907e0804967625-1"><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The network requires a single neuron in the output layer with a linear activation to predict the number of shampoo sales at the next time step.</p>
<p>Once the network is specified, it must be compiled into an efficient symbolic representation using a backend mathematical library, such as TensorFlow or Theano.</p>
<p>In compiling the network, we must specify a loss function and optimization algorithm. We will use &#8220;<em>mean_squared_error</em>&#8221; as the loss function as it closely matches RMSE that we will are interested in, and the efficient ADAM optimization algorithm.</p>
<p>Using the Sequential Keras API to define the network, the below snippet creates and compiles the network.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907e2125090724" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
model = Sequential()
model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907e2125090724-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907e2125090724-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907e2125090724-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907e2125090724-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907e2125090724-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907e2125090724-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907e2125090724-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907e2125090724-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Once compiled, it can be fit to the training data. Because the network is stateful, we must control when the internal state is reset. Therefore, we must manually manage the training process one epoch at a time across the desired number of epochs.</p>
<p>By default, the samples within an epoch are shuffled prior to being exposed to the network. Again, this is undesirable for the LSTM because we want the network to build up state as it learns across the sequence of observations. We can disable the shuffling of samples by setting &#8220;<em>shuffle</em>&#8221; to &#8220;<em>False</em>&#8220;.</p>
<p>Also by default, the network reports a lot of debug information about the learning progress and skill of the model at the end of each epoch. We can disable this by setting the &#8220;<em>verbose</em>&#8221; argument to the level of &#8220;<em>0</em>&#8220;.</p>
<p>We can then reset the internal state at the end of the training epoch, ready for the next training iteration.</p>
<p>Below is a loop that manually fits the network to the training data.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907e3979003277" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
for i in range(nb_epoch):
	model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)
	model.reset_states()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907e3979003277-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907e3979003277-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907e3979003277-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907e3979003277-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">nb_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907e3979003277-2"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907e3979003277-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Putting this all together, we can define a function called <em>fit_lstm()</em> that trains and returns an LSTM model. As arguments, it takes the training dataset in a supervised learning format, a batch size, a number of epochs, and a number of neurons.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907ed096705190" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def fit_lstm(train, batch_size, nb_epoch, neurons):
	X, y = train[:, 0:-1], train[:, -1]
	X = X.reshape(X.shape[0], 1, X.shape[1])
	model = Sequential()
	model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True))
	model.add(Dense(1))
	model.compile(loss='mean_squared_error', optimizer='adam')
	for i in range(nb_epoch):
		model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)
		model.reset_states()
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ed096705190-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-1"><span class="crayon-e">def </span><span class="crayon-e">fit_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neurons</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-2"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">nb_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-9"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-10"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ed096705190-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The batch_size must be set to 1. This is because it must be a factor of the size of the training and test datasets.</p>
<p>The <em>predict()</em> function on the model is also constrained by the batch size; there it must be set to 1 because we are interested in making one-step forecasts on the test data.</p>
<p>We will not tune the network parameters in this tutorial; instead we will use the following configuration, found with a little trial and error:</p>
<ul>
<li>Batch Size: 1</li>
<li>Epochs: 3000</li>
<li>Neurons: 4</li>
</ul>
<p>As an extension to this tutorial, you might like to explore different model parameters and see if you can improve performance.</p>
<ul>
<li><strong>Update</strong>: Consider trying 1500 epochs and 1 neuron, the performance may be better!</li>
</ul>
<p>Next, we will look at how we can use a fit LSTM model to make a one-step forecast.</p>
<h2>LSTM Forecast</h2>
<p>Once the LSTM model is fit to the training data, it can be used to make forecasts.</p>
<p>Again, we have some flexibility. We can decide to fit the model once on all of the training data, then predict each new time step one at a time from the test data (we&#8217;ll call this the fixed approach), or we can re-fit the model or update the model each time step of the test data as new observations from the test data are made available (we&#8217;ll call this the dynamic approach).</p>
<p>In this tutorial, we will go with the fixed approach for its simplicity, although, we would expect the dynamic approach to result in better model skill.</p>
<p>To make a forecast, we can call the <em>predict()</em> function on the model. This requires a 3D NumPy array input as an argument. In this case, it will be an array of one value, the observation at the previous time step.</p>
<p>The <em>predict()</em> function returns an array of predictions, one for each input row provided. Because we are providing a single input, the output will be a 2D NumPy array with one value.</p>
<p>We can capture this behavior in a function named <em>forecast()</em> listed below. Given a fit model, a batch-size used when fitting the model (e.g. 1), and a row from the test data, the function will separate out the input data from the test row, reshape it, and return the prediction as a single floating point value.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907ef454720549" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def forecast(model, batch_size, row):
	X = row[0:-1]
	X = X.reshape(1, 1, len(X))
	yhat = model.predict(X, batch_size=batch_size)
	return yhat[0,0]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ef454720549-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ef454720549-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ef454720549-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907ef454720549-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907ef454720549-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ef454720549-1"><span class="crayon-e">def </span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ef454720549-2"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ef454720549-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907ef454720549-4"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907ef454720549-5"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>During training, the internal state is reset after each epoch. While forecasting, we will not want to reset the internal state between forecasts. In fact, we would like the model to build up state as we forecast each time step in the test dataset.</p>
<p>This raises the question as to what would be a good initial state for the network prior to forecasting the test dataset.</p>
<p>In this tutorial, we will seed the state by making a prediction on all samples in the training dataset. In theory, the internal state should be set up ready to forecast the next time step.</p>
<p>We now have all of the pieces to fit an LSTM Network model for the Shampoo Sales dataset and evaluate its performance.</p>
<p>In the next section, we will put all of these pieces together.</p>
<h2>Complete LSTM Example</h2>
<p>In this section, we will fit an LSTM to the Shampoo Sales dataset and evaluate the model.</p>
<p>This will involve drawing together all of the elements from the prior sections. There are a lot of them, so let&#8217;s review:</p>
<ol>
<li>Load the dataset from CSV file.</li>
<li>Transform the dataset to make it suitable for the LSTM model, including:
<ol>
<li>Transforming the data to a supervised learning problem.</li>
<li>Transforming the data to be stationary.</li>
<li>Transforming the data so that it has the scale -1 to 1.</li>
</ol>
</li>
<li>Fitting a stateful LSTM network model to the training data.</li>
<li>Evaluating the static LSTM model on the test data.</li>
<li>Report the performance of the forecasts.</li>
</ol>
<p>Some things to note about the example:</p>
<ul>
<li>The scaling and inverse scaling behaviors have been moved to the functions <em>scale()</em> and <em>invert_scale()</em> for brevity.</li>
<li>The test data is scaled using the fit of the scaler on the training data, as is required to ensure the min/max values of the test data do not influence the model.</li>
<li>The order of data transforms was adjusted for convenience to first make the data stationary, then a supervised learning problem, then scaled.</li>
<li>Differencing was performed on the entire dataset prior to splitting into train and test sets for convenience. We could just as easily collect observations during the walk-forward validation and difference them as we go. I decided against it for readability.</li>
</ul>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907f1207714440" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from pandas import DataFrame
from pandas import Series
from pandas import concat
from pandas import read_csv
from pandas import datetime
from sklearn.metrics import mean_squared_error
from sklearn.preprocessing import MinMaxScaler
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from math import sqrt
from matplotlib import pyplot
import numpy

# date-time parsing function for loading the dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')

# frame a sequence as a supervised learning problem
def timeseries_to_supervised(data, lag=1):
	df = DataFrame(data)
	columns = [df.shift(i) for i in range(1, lag+1)]
	columns.append(df)
	df = concat(columns, axis=1)
	df.fillna(0, inplace=True)
	return df

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return Series(diff)

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# scale train and test data to [-1, 1]
def scale(train, test):
	# fit scaler
	scaler = MinMaxScaler(feature_range=(-1, 1))
	scaler = scaler.fit(train)
	# transform train
	train = train.reshape(train.shape[0], train.shape[1])
	train_scaled = scaler.transform(train)
	# transform test
	test = test.reshape(test.shape[0], test.shape[1])
	test_scaled = scaler.transform(test)
	return scaler, train_scaled, test_scaled

# inverse scaling for a forecasted value
def invert_scale(scaler, X, value):
	new_row = [x for x in X] + [value]
	array = numpy.array(new_row)
	array = array.reshape(1, len(array))
	inverted = scaler.inverse_transform(array)
	return inverted[0, -1]

# fit an LSTM network to training data
def fit_lstm(train, batch_size, nb_epoch, neurons):
	X, y = train[:, 0:-1], train[:, -1]
	X = X.reshape(X.shape[0], 1, X.shape[1])
	model = Sequential()
	model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True))
	model.add(Dense(1))
	model.compile(loss='mean_squared_error', optimizer='adam')
	for i in range(nb_epoch):
		model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)
		model.reset_states()
	return model

# make a one-step forecast
def forecast_lstm(model, batch_size, X):
	X = X.reshape(1, 1, len(X))
	yhat = model.predict(X, batch_size=batch_size)
	return yhat[0,0]

# load dataset
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)

# transform data to be stationary
raw_values = series.values
diff_values = difference(raw_values, 1)

# transform data to be supervised learning
supervised = timeseries_to_supervised(diff_values, 1)
supervised_values = supervised.values

# split data into train and test-sets
train, test = supervised_values[0:-12], supervised_values[-12:]

# transform the scale of the data
scaler, train_scaled, test_scaled = scale(train, test)

# fit the model
lstm_model = fit_lstm(train_scaled, 1, 3000, 4)
# forecast the entire training dataset to build up state for forecasting
train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)
lstm_model.predict(train_reshaped, batch_size=1)

# walk-forward validation on the test data
predictions = list()
for i in range(len(test_scaled)):
	# make one-step forecast
	X, y = test_scaled[i, 0:-1], test_scaled[i, -1]
	yhat = forecast_lstm(lstm_model, 1, X)
	# invert scaling
	yhat = invert_scale(scaler, X, yhat)
	# invert differencing
	yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)
	# store forecast
	predictions.append(yhat)
	expected = raw_values[len(train) + i + 1]
	print('Month=%d, Predicted=%f, Expected=%f' % (i+1, yhat, expected))

# report performance
rmse = sqrt(mean_squared_error(raw_values[-12:], predictions))
print('Test RMSE: %.3f' % rmse)
# line plot of observed vs predicted
pyplot.plot(raw_values[-12:])
pyplot.plot(predictions)
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f1207714440-124">124</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-5"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-11"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-12"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-13"><span class="crayon-e">import </span><span class="crayon-i">numpy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-15"><span class="crayon-p"># date-time parsing function for loading the dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-16"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-17"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-19"><span class="crayon-p"># frame a sequence as a supervised learning problem</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-20"><span class="crayon-e">def </span><span class="crayon-e">timeseries_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-21"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-22"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-23"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-24"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-25"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">fillna</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-26"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">df</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-28"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-29"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-30"><span class="crayon-h">	</span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-31"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-32"><span class="crayon-h">		</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-33"><span class="crayon-h">		</span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-34"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-36"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-37"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-38"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-40"><span class="crayon-p"># scale train and test data to [-1, 1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-41"><span class="crayon-e">def </span><span class="crayon-e">scale</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-42"><span class="crayon-h">	</span><span class="crayon-p"># fit scaler</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-43"><span class="crayon-h">	</span><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-44"><span class="crayon-h">	</span><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-45"><span class="crayon-h">	</span><span class="crayon-p"># transform train</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-46"><span class="crayon-h">	</span><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-47"><span class="crayon-h">	</span><span class="crayon-v">train_scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-48"><span class="crayon-h">	</span><span class="crayon-p"># transform test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-49"><span class="crayon-h">	</span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-50"><span class="crayon-h">	</span><span class="crayon-v">test_scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-51"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>scaled</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-52">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-53"><span class="crayon-p"># inverse scaling for a forecasted value</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-54"><span class="crayon-e">def </span><span class="crayon-e">invert_scale</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-55"><span class="crayon-h">	</span><span class="crayon-v">new_row</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-56"><span class="crayon-h">	</span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">new_row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-57"><span class="crayon-h">	</span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">array</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-58"><span class="crayon-h">	</span><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-t">array</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-59"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inverted</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-61"><span class="crayon-p"># fit an LSTM network to training data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-62"><span class="crayon-e">def </span><span class="crayon-e">fit_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neurons</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-63"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-64"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-65"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-66"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-67"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-68"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-69"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">nb_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-70"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-71"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-72"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-73">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-74"><span class="crayon-p"># make a one-step forecast</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-75"><span class="crayon-e">def </span><span class="crayon-e">forecast_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-76"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-77"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-78"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-79">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-80"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-81"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-82">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-83"><span class="crayon-p"># transform data to be stationary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-84"><span class="crayon-v">raw_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-85"><span class="crayon-v">diff_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-86">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-87"><span class="crayon-p"># transform data to be supervised learning</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-88"><span class="crayon-v">supervised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">timeseries_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">diff_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-89"><span class="crayon-v">supervised_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">supervised</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-90">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-91"><span class="crayon-p"># split data into train and test-sets</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-92"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">supervised_values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">supervised_values</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-93">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-94"><span class="crayon-p"># transform the scale of the data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-95"><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scale</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-96">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-97"><span class="crayon-p"># fit the model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-98"><span class="crayon-v">lstm_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">fit_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">train_scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-99"><span class="crayon-p"># forecast the entire training dataset to build up state for forecasting</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-100"><span class="crayon-v">train_reshaped</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_scaled</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train_scaled</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-101"><span class="crayon-v">lstm_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">train_reshaped</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-102">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-103"><span class="crayon-p"># walk-forward validation on the test data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-104"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-105"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_scaled</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-106"><span class="crayon-h">	</span><span class="crayon-p"># make one-step forecast</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-107"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-108"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forecast_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">lstm_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-109"><span class="crayon-h">	</span><span class="crayon-p"># invert scaling</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-110"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">invert_scale</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-111"><span class="crayon-h">	</span><span class="crayon-p"># invert differencing</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-112"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_scaled</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-113"><span class="crayon-h">	</span><span class="crayon-p"># store forecast</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-114"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-115"><span class="crayon-h">	</span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">raw_values</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-116"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Month=%d, Predicted=%f, Expected=%f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-117">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-118"><span class="crayon-p"># report performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-119"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-120"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-121"><span class="crayon-p"># line plot of observed vs predicted</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-122"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-123"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f1207714440-124"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example prints the expected and predicted values for each of the 12 months in the test dataset.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>The example also prints the RMSE of all forecasts. The model shows an RMSE of 71.721 monthly shampoo sales, which is better than the persistence model that achieved an RMSE of 136.761 shampoo sales.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907f5797648236" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Month=1, Predicted=351.582196, Expected=339.700000
Month=2, Predicted=432.169667, Expected=440.400000
Month=3, Predicted=378.064505, Expected=315.900000
Month=4, Predicted=441.370077, Expected=439.300000
Month=5, Predicted=446.872627, Expected=401.300000
Month=6, Predicted=514.021244, Expected=437.400000
Month=7, Predicted=525.608903, Expected=575.500000
Month=8, Predicted=473.072365, Expected=407.600000
Month=9, Predicted=523.126979, Expected=682.000000
Month=10, Predicted=592.274106, Expected=475.300000
Month=11, Predicted=589.299863, Expected=581.300000
Month=12, Predicted=584.149152, Expected=646.900000
Test RMSE: 71.721</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f5797648236-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-1">Month=1, Predicted=351.582196, Expected=339.700000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-2">Month=2, Predicted=432.169667, Expected=440.400000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-3">Month=3, Predicted=378.064505, Expected=315.900000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-4">Month=4, Predicted=441.370077, Expected=439.300000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-5">Month=5, Predicted=446.872627, Expected=401.300000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-6">Month=6, Predicted=514.021244, Expected=437.400000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-7">Month=7, Predicted=525.608903, Expected=575.500000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-8">Month=8, Predicted=473.072365, Expected=407.600000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-9">Month=9, Predicted=523.126979, Expected=682.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-10">Month=10, Predicted=592.274106, Expected=475.300000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-11">Month=11, Predicted=589.299863, Expected=581.300000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-12">Month=12, Predicted=584.149152, Expected=646.900000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f5797648236-13">Test RMSE: 71.721</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A line plot of the test data (blue) vs the predicted values (orange) is also created, providing context for the model skill.</p>
<div id="attachment_3884" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3884" loading="lazy" class="size-full wp-image-3884" src="https://machinelearningmastery.com/wp-content/uploads/2017/03/Line-Plot-of-LSTM-Forecast-vs-Expected-Values.png" alt="Line Plot of LSTM Forecast vs Expected Values" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/03/Line-Plot-of-LSTM-Forecast-vs-Expected-Values.png 640w, https://machinelearningmastery.com/wp-content/uploads/2017/03/Line-Plot-of-LSTM-Forecast-vs-Expected-Values-300x225.png 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-3884" class="wp-caption-text">Line Plot of LSTM Forecast vs Expected Values</p></div>
<p>As an afternote, you can do a quick experiment to build your trust in the test harness and all of the transforms and inverse transforms.</p>
<p>Comment out the line that fits the LSTM model in walk-forward validation:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907f9302625817" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
yhat = forecast_lstm(lstm_model, 1, X)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907f9302625817-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907f9302625817-1"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forecast_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">lstm_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>And replace it with the following:</p>
		<div id="urvanov-syntax-highlighter-6092adfe907fd355731735" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
yhat = y</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fd355731735-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fd355731735-1"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>This should produce a model with perfect skill (e.g. a model that predicts the expected outcome as the model output).</p>
<p>The results should look as follows, showing that if the LSTM model could predict the series perfectly, the inverse transforms and error calculation would show it correctly.</p>
		<div id="urvanov-syntax-highlighter-6092adfe907fe033342903" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Month=1, Predicted=339.700000, Expected=339.700000
Month=2, Predicted=440.400000, Expected=440.400000
Month=3, Predicted=315.900000, Expected=315.900000
Month=4, Predicted=439.300000, Expected=439.300000
Month=5, Predicted=401.300000, Expected=401.300000
Month=6, Predicted=437.400000, Expected=437.400000
Month=7, Predicted=575.500000, Expected=575.500000
Month=8, Predicted=407.600000, Expected=407.600000
Month=9, Predicted=682.000000, Expected=682.000000
Month=10, Predicted=475.300000, Expected=475.300000
Month=11, Predicted=581.300000, Expected=581.300000
Month=12, Predicted=646.900000, Expected=646.900000
Test RMSE: 0.000</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe907fe033342903-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-1">Month=1, Predicted=339.700000, Expected=339.700000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-2">Month=2, Predicted=440.400000, Expected=440.400000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-3">Month=3, Predicted=315.900000, Expected=315.900000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-4">Month=4, Predicted=439.300000, Expected=439.300000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-5">Month=5, Predicted=401.300000, Expected=401.300000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-6">Month=6, Predicted=437.400000, Expected=437.400000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-7">Month=7, Predicted=575.500000, Expected=575.500000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-8">Month=8, Predicted=407.600000, Expected=407.600000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-9">Month=9, Predicted=682.000000, Expected=682.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-10">Month=10, Predicted=475.300000, Expected=475.300000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-11">Month=11, Predicted=581.300000, Expected=581.300000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-12">Month=12, Predicted=646.900000, Expected=646.900000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe907fe033342903-13">Test RMSE: 0.000</div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h2>Develop a Robust Result</h2>
<p>A difficulty with neural networks is that they give different results with different starting conditions.</p>
<p>One approach might be to fix the random number seed used by Keras to ensure the results are reproducible. Another approach would be to control for the random initial conditions using a different experimental setup.</p>
<p>We can repeat the experiment from the previous section multiple times, then take the average RMSE as an indication of how well the configuration would be expected to perform on unseen data on average.</p>
<p>This is often called multiple repeats or multiple restarts.</p>
<p>We can wrap the model fitting and walk-forward validation in a loop of fixed number of repeats. Each iteration the RMSE of the run can be recorded. We can then summarize the distribution of RMSE scores.</p>
		<div id="urvanov-syntax-highlighter-6092adfe90800516169831" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# repeat experiment
repeats = 30
error_scores = list()
for r in range(repeats):
	# fit the model
	lstm_model = fit_lstm(train_scaled, 1, 3000, 4)
	# forecast the entire training dataset to build up state for forecasting
	train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)
	lstm_model.predict(train_reshaped, batch_size=1)
	# walk-forward validation on the test data
	predictions = list()
	for i in range(len(test_scaled)):
		# make one-step forecast
		X, y = test_scaled[i, 0:-1], test_scaled[i, -1]
		yhat = forecast_lstm(lstm_model, 1, X)
		# invert scaling
		yhat = invert_scale(scaler, X, yhat)
		# invert differencing
		yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)
		# store forecast
		predictions.append(yhat)
	# report performance
	rmse = sqrt(mean_squared_error(raw_values[-12:], predictions))
	print('%d) Test RMSE: %.3f' % (r+1, rmse))
	error_scores.append(rmse)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90800516169831-25">25</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-1"><span class="crayon-p"># repeat experiment</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-2"><span class="crayon-v">repeats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-3"><span class="crayon-v">error_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">r</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">repeats</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-5"><span class="crayon-h">	</span><span class="crayon-p"># fit the model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-6"><span class="crayon-h">	</span><span class="crayon-v">lstm_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">fit_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">train_scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-7"><span class="crayon-h">	</span><span class="crayon-p"># forecast the entire training dataset to build up state for forecasting</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-8"><span class="crayon-h">	</span><span class="crayon-v">train_reshaped</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_scaled</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train_scaled</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-9"><span class="crayon-h">	</span><span class="crayon-v">lstm_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">train_reshaped</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-10"><span class="crayon-h">	</span><span class="crayon-p"># walk-forward validation on the test data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-11"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-12"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_scaled</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-13"><span class="crayon-h">		</span><span class="crayon-p"># make one-step forecast</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-14"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-15"><span class="crayon-h">		</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forecast_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">lstm_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-16"><span class="crayon-h">		</span><span class="crayon-p"># invert scaling</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-17"><span class="crayon-h">		</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">invert_scale</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-18"><span class="crayon-h">		</span><span class="crayon-p"># invert differencing</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-19"><span class="crayon-h">		</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_scaled</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-20"><span class="crayon-h">		</span><span class="crayon-p"># store forecast</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-21"><span class="crayon-h">		</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-22"><span class="crayon-h">	</span><span class="crayon-p"># report performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-23"><span class="crayon-h">	</span><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-24"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%d) Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">r</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90800516169831-25"><span class="crayon-h">	</span><span class="crayon-v">error_scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The data preparation would be the same as before.</p>
<p>We will use 30 repeats as that is sufficient to provide a good distribution of RMSE scores.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6092adfe90801597788268" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from pandas import DataFrame
from pandas import Series
from pandas import concat
from pandas import read_csv
from pandas import datetime
from sklearn.metrics import mean_squared_error
from sklearn.preprocessing import MinMaxScaler
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from math import sqrt
from matplotlib import pyplot
import numpy

# date-time parsing function for loading the dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')

# frame a sequence as a supervised learning problem
def timeseries_to_supervised(data, lag=1):
	df = DataFrame(data)
	columns = [df.shift(i) for i in range(1, lag+1)]
	columns.append(df)
	df = concat(columns, axis=1)
	df.fillna(0, inplace=True)
	return df

# create a differenced series
def difference(dataset, interval=1):
	diff = list()
	for i in range(interval, len(dataset)):
		value = dataset[i] - dataset[i - interval]
		diff.append(value)
	return Series(diff)

# invert differenced value
def inverse_difference(history, yhat, interval=1):
	return yhat + history[-interval]

# scale train and test data to [-1, 1]
def scale(train, test):
	# fit scaler
	scaler = MinMaxScaler(feature_range=(-1, 1))
	scaler = scaler.fit(train)
	# transform train
	train = train.reshape(train.shape[0], train.shape[1])
	train_scaled = scaler.transform(train)
	# transform test
	test = test.reshape(test.shape[0], test.shape[1])
	test_scaled = scaler.transform(test)
	return scaler, train_scaled, test_scaled

# inverse scaling for a forecasted value
def invert_scale(scaler, X, value):
	new_row = [x for x in X] + [value]
	array = numpy.array(new_row)
	array = array.reshape(1, len(array))
	inverted = scaler.inverse_transform(array)
	return inverted[0, -1]

# fit an LSTM network to training data
def fit_lstm(train, batch_size, nb_epoch, neurons):
	X, y = train[:, 0:-1], train[:, -1]
	X = X.reshape(X.shape[0], 1, X.shape[1])
	model = Sequential()
	model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True))
	model.add(Dense(1))
	model.compile(loss='mean_squared_error', optimizer='adam')
	for i in range(nb_epoch):
		model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)
		model.reset_states()
	return model

# make a one-step forecast
def forecast_lstm(model, batch_size, X):
	X = X.reshape(1, 1, len(X))
	yhat = model.predict(X, batch_size=batch_size)
	return yhat[0,0]

# load dataset
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)

# transform data to be stationary
raw_values = series.values
diff_values = difference(raw_values, 1)

# transform data to be supervised learning
supervised = timeseries_to_supervised(diff_values, 1)
supervised_values = supervised.values

# split data into train and test-sets
train, test = supervised_values[0:-12], supervised_values[-12:]

# transform the scale of the data
scaler, train_scaled, test_scaled = scale(train, test)

# repeat experiment
repeats = 30
error_scores = list()
for r in range(repeats):
	# fit the model
	lstm_model = fit_lstm(train_scaled, 1, 3000, 4)
	# forecast the entire training dataset to build up state for forecasting
	train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)
	lstm_model.predict(train_reshaped, batch_size=1)
	# walk-forward validation on the test data
	predictions = list()
	for i in range(len(test_scaled)):
		# make one-step forecast
		X, y = test_scaled[i, 0:-1], test_scaled[i, -1]
		yhat = forecast_lstm(lstm_model, 1, X)
		# invert scaling
		yhat = invert_scale(scaler, X, yhat)
		# invert differencing
		yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)
		# store forecast
		predictions.append(yhat)
	# report performance
	rmse = sqrt(mean_squared_error(raw_values[-12:], predictions))
	print('%d) Test RMSE: %.3f' % (r+1, rmse))
	error_scores.append(rmse)

# summarize results
results = DataFrame()
results['rmse'] = error_scores
print(results.describe())
results.boxplot()
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90801597788268-128">128</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-5"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-11"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-12"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-13"><span class="crayon-e">import </span><span class="crayon-i">numpy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-15"><span class="crayon-p"># date-time parsing function for loading the dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-16"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-17"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-19"><span class="crayon-p"># frame a sequence as a supervised learning problem</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-20"><span class="crayon-e">def </span><span class="crayon-e">timeseries_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-21"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-22"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-23"><span class="crayon-h">	</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-24"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-25"><span class="crayon-h">	</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">fillna</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-26"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">df</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-28"><span class="crayon-p"># create a differenced series</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-29"><span class="crayon-e">def </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-30"><span class="crayon-h">	</span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-31"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">interval</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-32"><span class="crayon-h">		</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-33"><span class="crayon-h">		</span><span class="crayon-v">diff</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-34"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">diff</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-36"><span class="crayon-p"># invert differenced value</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-37"><span class="crayon-e">def </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-38"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">interval</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-40"><span class="crayon-p"># scale train and test data to [-1, 1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-41"><span class="crayon-e">def </span><span class="crayon-e">scale</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-42"><span class="crayon-h">	</span><span class="crayon-p"># fit scaler</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-43"><span class="crayon-h">	</span><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-v">feature_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-44"><span class="crayon-h">	</span><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-45"><span class="crayon-h">	</span><span class="crayon-p"># transform train</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-46"><span class="crayon-h">	</span><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-47"><span class="crayon-h">	</span><span class="crayon-v">train_scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-48"><span class="crayon-h">	</span><span class="crayon-p"># transform test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-49"><span class="crayon-h">	</span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-50"><span class="crayon-h">	</span><span class="crayon-v">test_scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-51"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>scaled</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-52">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-53"><span class="crayon-p"># inverse scaling for a forecasted value</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-54"><span class="crayon-e">def </span><span class="crayon-e">invert_scale</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-55"><span class="crayon-h">	</span><span class="crayon-v">new_row</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-56"><span class="crayon-h">	</span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">new_row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-57"><span class="crayon-h">	</span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">array</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-58"><span class="crayon-h">	</span><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-t">array</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-59"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inverted</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-61"><span class="crayon-p"># fit an LSTM network to training data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-62"><span class="crayon-e">def </span><span class="crayon-e">fit_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neurons</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-63"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-64"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-65"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-66"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stateful</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-67"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-68"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-69"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">nb_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-70"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-71"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">reset_states</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-72"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-73">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-74"><span class="crayon-p"># make a one-step forecast</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-75"><span class="crayon-e">def </span><span class="crayon-e">forecast_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-76"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-77"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-78"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-79">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-80"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-81"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-82">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-83"><span class="crayon-p"># transform data to be stationary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-84"><span class="crayon-v">raw_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-85"><span class="crayon-v">diff_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-86">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-87"><span class="crayon-p"># transform data to be supervised learning</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-88"><span class="crayon-v">supervised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">timeseries_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">diff_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-89"><span class="crayon-v">supervised_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">supervised</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-90">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-91"><span class="crayon-p"># split data into train and test-sets</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-92"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">supervised_values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">supervised_values</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-93">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-94"><span class="crayon-p"># transform the scale of the data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-95"><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scale</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-96">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-97"><span class="crayon-p"># repeat experiment</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-98"><span class="crayon-v">repeats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-99"><span class="crayon-v">error_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-100"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">r</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">repeats</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-101"><span class="crayon-h">	</span><span class="crayon-p"># fit the model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-102"><span class="crayon-h">	</span><span class="crayon-v">lstm_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">fit_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">train_scaled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-103"><span class="crayon-h">	</span><span class="crayon-p"># forecast the entire training dataset to build up state for forecasting</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-104"><span class="crayon-h">	</span><span class="crayon-v">train_reshaped</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_scaled</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train_scaled</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-105"><span class="crayon-h">	</span><span class="crayon-v">lstm_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">train_reshaped</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-106"><span class="crayon-h">	</span><span class="crayon-p"># walk-forward validation on the test data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-107"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-108"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_scaled</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-109"><span class="crayon-h">		</span><span class="crayon-p"># make one-step forecast</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-110"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_scaled</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-111"><span class="crayon-h">		</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forecast_lstm</span><span class="crayon-sy">(</span><span class="crayon-v">lstm_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-112"><span class="crayon-h">		</span><span class="crayon-p"># invert scaling</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-113"><span class="crayon-h">		</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">invert_scale</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-114"><span class="crayon-h">		</span><span class="crayon-p"># invert differencing</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-115"><span class="crayon-h">		</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test_scaled</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-116"><span class="crayon-h">		</span><span class="crayon-p"># store forecast</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-117"><span class="crayon-h">		</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-118"><span class="crayon-h">	</span><span class="crayon-p"># report performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-119"><span class="crayon-h">	</span><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">raw_values</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-120"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%d) Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">r</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-121"><span class="crayon-h">	</span><span class="crayon-v">error_scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-122">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-123"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-124"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-125"><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-s">'rmse'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">error_scores</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-126"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-127"><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90801597788268-128"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example prints the RMSE score each repeat. The end of the run provides summary statistics of the collected RMSE scores.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>We can see that the mean and standard deviation RMSE scores are 138.491905 and 46.313783 monthly shampoo sales respectively.</p>
<p>This is a very useful result as it suggests the result reported above was probably a statistical fluke. The experiment suggests that the model is probably about as good as the persistence model on average (136.761), if not slightly worse.</p>
<p>This indicates that, at the very least, further model tuning is required.</p>
		<div id="urvanov-syntax-highlighter-6092adfe90804854117558" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
1) Test RMSE: 136.191
2) Test RMSE: 169.693
3) Test RMSE: 176.553
4) Test RMSE: 198.954
5) Test RMSE: 148.960
6) Test RMSE: 103.744
7) Test RMSE: 164.344
8) Test RMSE: 108.829
9) Test RMSE: 232.282
10) Test RMSE: 110.824
11) Test RMSE: 163.741
12) Test RMSE: 111.535
13) Test RMSE: 118.324
14) Test RMSE: 107.486
15) Test RMSE: 97.719
16) Test RMSE: 87.817
17) Test RMSE: 92.920
18) Test RMSE: 112.528
19) Test RMSE: 131.687
20) Test RMSE: 92.343
21) Test RMSE: 173.249
22) Test RMSE: 182.336
23) Test RMSE: 101.477
24) Test RMSE: 108.171
25) Test RMSE: 135.880
26) Test RMSE: 254.507
27) Test RMSE: 87.198
28) Test RMSE: 122.588
29) Test RMSE: 228.449
30) Test RMSE: 94.427
             rmse
count   30.000000
mean   138.491905
std     46.313783
min     87.198493
25%    104.679391
50%    120.456233
75%    168.356040
max    254.507272</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfe90804854117558-39">39</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-1">1) Test RMSE: 136.191</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-2">2) Test RMSE: 169.693</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-3">3) Test RMSE: 176.553</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-4">4) Test RMSE: 198.954</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-5">5) Test RMSE: 148.960</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-6">6) Test RMSE: 103.744</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-7">7) Test RMSE: 164.344</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-8">8) Test RMSE: 108.829</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-9">9) Test RMSE: 232.282</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-10">10) Test RMSE: 110.824</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-11">11) Test RMSE: 163.741</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-12">12) Test RMSE: 111.535</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-13">13) Test RMSE: 118.324</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-14">14) Test RMSE: 107.486</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-15">15) Test RMSE: 97.719</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-16">16) Test RMSE: 87.817</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-17">17) Test RMSE: 92.920</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-18">18) Test RMSE: 112.528</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-19">19) Test RMSE: 131.687</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-20">20) Test RMSE: 92.343</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-21">21) Test RMSE: 173.249</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-22">22) Test RMSE: 182.336</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-23">23) Test RMSE: 101.477</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-24">24) Test RMSE: 108.171</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-25">25) Test RMSE: 135.880</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-26">26) Test RMSE: 254.507</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-27">27) Test RMSE: 87.198</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-28">28) Test RMSE: 122.588</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-29">29) Test RMSE: 228.449</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-30">30) Test RMSE: 94.427</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rmse</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-32">count&nbsp;&nbsp; 30.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-33">mean&nbsp;&nbsp; 138.491905</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-34">std&nbsp;&nbsp;&nbsp;&nbsp; 46.313783</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-35">min&nbsp;&nbsp;&nbsp;&nbsp; 87.198493</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-36">25%&nbsp;&nbsp;&nbsp;&nbsp;104.679391</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-37">50%&nbsp;&nbsp;&nbsp;&nbsp;120.456233</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-38">75%&nbsp;&nbsp;&nbsp;&nbsp;168.356040</div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfe90804854117558-39">max&nbsp;&nbsp;&nbsp;&nbsp;254.507272</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A box and whisker plot is created from the distribution shown below. This captures the middle of the data as well as the extents and outlier results.</p>
<div id="attachment_3885" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3885" loading="lazy" class="size-full wp-image-3885" src="https://machinelearningmastery.com/wp-content/uploads/2017/03/LSTM-Repeated-Experiment-Box-and-Whisker-Plot.png" alt="LSTM Repeated Experiment Box and Whisker Plot" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/03/LSTM-Repeated-Experiment-Box-and-Whisker-Plot.png 640w, https://machinelearningmastery.com/wp-content/uploads/2017/03/LSTM-Repeated-Experiment-Box-and-Whisker-Plot-300x225.png 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-3885" class="wp-caption-text">LSTM Repeated Experiment Box and Whisker Plot</p></div>
<p>This is an experimental setup that could be used to compare one configuration of the LSTM model or set up to another.</p>
<h2>Tutorial Extensions</h2>
<p>There are many extensions to this tutorial that we may consider.</p>
<p>Perhaps you could explore some of these yourself and post your discoveries in the comments below.</p>
<ul>
<li><strong>Multi-Step Forecast</strong>. The experimental setup could be changed to predict the next <em>n</em>-time steps rather than the next single time step. This would also permit a larger batch size and faster training. Note that we are basically performing a type of 12 one-step forecast in this tutorial given the model is not updated, although new observations are available and are used as input variables.</li>
<li><strong>Tune LSTM model</strong>. The model was not tuned; instead, the configuration was found with some quick trial and error. I believe much better results could be achieved by tuning at least the number of neurons and number of training epochs. I also think early stopping via a callback might be useful during training.</li>
<li><strong>Seed State Experiments</strong>. It is not clear whether seeding the system prior to forecasting by predicting all of the training data is beneficial. It seems like a good idea in theory, but this needs to be demonstrated. Also, perhaps other methods of seeding the model prior to forecasting would be beneficial.</li>
<li><strong>Update Model</strong>. The model could be updated in each time step of the walk-forward validation. Experiments are needed to determine if it would be better to refit the model from scratch or update the weights with a few more training epochs including the new sample.</li>
<li><strong>Input Time Steps</strong>. The LSTM input supports multiple time steps for a sample. Experiments are needed to see if including lag observations as time steps provides any benefit.</li>
<li><strong>Input Lag Features</strong>. Lag observations may be included as input features. Experiments are needed to see if including lag features provide any benefit, not unlike an AR(k) linear model.</li>
<li><strong>Input Error Series</strong>. An error series may be constructed (forecast error from a persistence model) and used as an additional input feature, not unlike an MA(k) linear model. Experiments are needed to see if this provides any benefit.</li>
<li><strong>Learn Non-Stationary</strong>. The LSTM network may be able to learn the trend in the data and make reasonable predictions. Experiments are needed to see if temporal dependent structures, like trends and seasonality, left in data can be learned and effectively predicted by LSTMs.</li>
<li><strong>Contrast Stateless</strong>. Stateful LSTMs were used in this tutorial. The results should be compared with stateless LSTM configurations.</li>
<li><strong>Statistical Significance</strong>. The multiple repeats experimental protocol can be extended further to include statistical significance tests to demonstrate whether the difference between populations of RMSE results with different configurations are statistically significant.</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop an LSTM model for time series forecasting.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to prepare time series data for developing an LSTM model.</li>
<li>How to develop an LSTM model for time series forecasting.</li>
<li>How to evaluate an LSTM model using a robust test harness.</li>
</ul>
<p>Can you get a better result?<br />
Share your findings in the comments below.</p>
<div class="widget_text awac-wrapper" id="custom_html-67"><div class="widget_text awac widget custom_html-67"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Time Series Today!</h2>
<a href="/deep-learning-for-time-series-forecasting/" rel="nofollow"><img width="220" height="311" style="border: 0;" src="/wp-content/uploads/2018/08/Cover-220.png" alt="Deep Learning for Time Series Forecasting" align="left" /></a>
<h4>Develop Your Own Forecasting models in Minutes</h4>
<p>...with just a few lines of python code</p>

<p>Discover how in my new Ebook:<br>
<a href="/deep-learning-for-time-series-forecasting/" rel="nofollow">Deep Learning for Time Series Forecasting</a></p>

<p>It provides <strong>self-study tutorials</strong> on topics like: <br>
<em>CNNs</em>, <em>LSTMs</em>,
<em>Multivariate Forecasting</em>, <em>Multi-Step Forecasting</em> and much more...</p>

<h4>Finally Bring Deep Learning to your Time Series Forecasting Projects</h4>
<p>Skip the Academics. Just Results.</p>

<a href="/deep-learning-for-time-series-forecasting/" class="woo-sc-button  red" ><span class="woo-">See What's Inside</span></a>
<div class="woo-sc-hr"></div>
</div>
</div></div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3882 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Time+Series+Forecasting+with+the+Long+Short-Term+Memory+Network+in+Python&url=https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-3b5abb8e72fb21a4ffcb9f32-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"/><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"/></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-3b5abb8e72fb21a4ffcb9f32-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-3b5abb8e72fb21a4ffcb9f32-="">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=160&#038;d=mm&#038;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' loading='lazy'/></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">&rarr;</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/seasonal-persistence-forecasting-python/" rel="prev"><i class="fa fa-angle-left"></i> Seasonal Persistence Forecasting With Python</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/seed-state-lstms-time-series-forecasting-python/" rel="next">How to Seed State for LSTMs for Time Series Forecasting in Python <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">667 Responses to <em>Time Series Forecasting with the Long Short-Term Memory Network in Python</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-395611" class="comment even thread-even depth-1">

	      	<div id="li-comment-395611" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2070866c0175dc61d99cbef3a5b05b01?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2070866c0175dc61d99cbef3a5b05b01?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chang</span>
	                <span class="date">April 7, 2017 at 4:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-395611" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;ve been working on multi-step-ahead forecast after reading your ebook and following one step ahead tutorials. But still struggling getting nothing. It seems that seq2seq model is used, but I want to configure simple lstm for multi step ahead prediction. Can you help me in getting basic idea to do this?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-395611' data-commentid="395611" data-postid="3882" data-belowelement="comment-395611" data-respondelement="respond" data-replyto="Reply to Chang" aria-label='Reply to Chang'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395817" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-395817" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-395817" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I have some seq2seq examples scheduled to come out on the blog soon.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-395817' data-commentid="395817" data-postid="3882" data-belowelement="comment-395817" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395752" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-395752" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/43cc6ce12de070c2b79830a9cb26e8f7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/43cc6ce12de070c2b79830a9cb26e8f7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Supriya</span>
	                <span class="date">April 9, 2017 at 9:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-395752" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thank you for this blog. I am working on  multi-step-ahead forecast using recursive prediction technique  and I have some difficulty. Blog on this particular topic would be really helpful.<br />
Also, is it possible to somehow implement recursive technique in ARIMA?.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-395752' data-commentid="395752" data-postid="3882" data-belowelement="comment-395752" data-respondelement="respond" data-replyto="Reply to Supriya" aria-label='Reply to Supriya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395828" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-395828" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 3:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-395828" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Absolutely, you can take the predictions as history and re-fit the ARIMA.</p>
<p>Thanks for the suggestion, it would make a good blog post.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-395828' data-commentid="395828" data-postid="3882" data-belowelement="comment-395828" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407587" class="comment even depth-3">

	      	<div id="li-comment-407587" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bf2c5c24800dc323de5ac11cb41b354d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bf2c5c24800dc323de5ac11cb41b354d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack Dan</span>
	                <span class="date">July 28, 2017 at 5:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407587" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am wondering if I have predictions (not good prediction) and  refitting without validating with the test set, wouldn&#8217;t it give false prediction again?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407587' data-commentid="407587" data-postid="3882" data-belowelement="comment-407587" data-respondelement="respond" data-replyto="Reply to Jack Dan" aria-label='Reply to Jack Dan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407625" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-407625" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 28, 2017 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may, design an experiment to test the approach.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407625' data-commentid="407625" data-postid="3882" data-belowelement="comment-407625" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424986" class="comment even depth-3">

	      	<div id="li-comment-424986" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5bf980a045580ed2cdd2c45073ca24e6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5bf980a045580ed2cdd2c45073ca24e6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shifu jain</span>
	                <span class="date">December 27, 2017 at 11:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-424986" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this blog. Can you please share an example of multi-step-ahead forecast using recursive prediction technique using LSTM.</p>
<p>Thanks,<br />
Shifu</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-424986' data-commentid="424986" data-postid="3882" data-belowelement="comment-424986" data-respondelement="respond" data-replyto="Reply to Shifu jain" aria-label='Reply to Shifu jain'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425008" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-425008" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 28, 2017 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425008" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>
<p>I have an example of a direct model for multi-step forecasting here:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow ugc">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425008' data-commentid="425008" data-postid="3882" data-belowelement="comment-425008" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395804" class="comment even thread-even depth-1">

	      	<div id="li-comment-395804" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c591b3aa78239d67786996bca4485c78?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c591b3aa78239d67786996bca4485c78?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter Marelas</span>
	                <span class="date">April 9, 2017 at 2:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-395804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>LSTM remember sequences but is there a way to encode calendar effects in the network so that it remembers or learns events that occur at different intervals within the sequence and each cycles? A concrete example would be a time series that exhibits specific events that repeat themselves on specific times in the year, example first Monday of every month and/or last day of every month. I am thinking whether we can label this data in advance to help the LSTM predict these events better?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-395804' data-commentid="395804" data-postid="3882" data-belowelement="comment-395804" data-respondelement="respond" data-replyto="Reply to Peter Marelas" aria-label='Reply to Peter Marelas'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405402" class="comment odd alt depth-2">

	      	<div id="li-comment-405402" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/51a4833f6219f8fec7182a2fba2fb392?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/51a4833f6219f8fec7182a2fba2fb392?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Guillaume</span>
	                <span class="date">July 10, 2017 at 8:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Peter,</p>
<p>You might want to check out the X-11 method to separate trend, seasonal, and random change to your sequence. Then apply an algorithm to each part.</p>
<p>You can look at the following article :<br />
Study of the Long-term Performance Prediction Methods Using the Spacecraft Telemetry Data<br />
from Hongzeng Fang<br />
(Sorry but I can&#8217;t find a free dl page anymore ..).</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405402' data-commentid="405402" data-postid="3882" data-belowelement="comment-405402" data-respondelement="respond" data-replyto="Reply to Guillaume" aria-label='Reply to Guillaume'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405479" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-405479" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 11, 2017 at 10:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405479" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tip.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405479' data-commentid="405479" data-postid="3882" data-belowelement="comment-405479" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437896" class="comment odd alt depth-4">

	      	<div id="li-comment-437896" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6f6716b151ccf5bce7e8d9f060828e30?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6f6716b151ccf5bce7e8d9f060828e30?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yasmine Sayed</span>
	                <span class="date">May 18, 2018 at 11:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, in the case of taking the last observation in the dataset in order to predict the next future timestep (for which we don&#8217;t have current values for), does the model use only that 1 observation to predict the next??? Or because it&#8217;s an LSTM , does it use both the memory from all the preceding observations during training + the last observation in order to predict the next timestep?</p>
<p>If it&#8217;s the latter &#8211; it would make more sense to me. Otherwise I can&#8217;t see the sense in using nothing but 1 observation to predict one ahead and guarantee any type of accuracy.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-437896' data-commentid="437896" data-postid="3882" data-belowelement="comment-437896" data-respondelement="respond" data-replyto="Reply to Yasmine Sayed" aria-label='Reply to Yasmine Sayed'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437927" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-437927" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 19, 2018 at 7:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437927" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The way the model is defined, an input sequence is provided in order to predict one time step.</p>
<p>You can define the mapping any way you wish for your problem though.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395894" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-395894" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2c2fc2d581e40949e709d4c0be2a206f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2c2fc2d581e40949e709d4c0be2a206f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kunpeng Zhang</span>
	                <span class="date">April 10, 2017 at 5:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-395894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Nice post. Is there any tutorial available on multivariate time series forecasting problem?<br />
I got two sets of data: traffic flow data and weather data.  I am thinking to predict the traffic flow using these two data sets.<br />
I&#8217;d like to learn if I get weather condition involved what will happen for my model.<br />
Could you kindly give me some advice?<br />
Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-395894' data-commentid="395894" data-postid="3882" data-belowelement="comment-395894" data-respondelement="respond" data-replyto="Reply to Kunpeng Zhang" aria-label='Reply to Kunpeng Zhang'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395913" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395913" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 10, 2017 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-395913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I do not have a multivariate regression example, but I hope to post one soon.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-395913' data-commentid="395913" data-postid="3882" data-belowelement="comment-395913" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396190" class="comment odd alt depth-3">

	      	<div id="li-comment-396190" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2c2fc2d581e40949e709d4c0be2a206f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2c2fc2d581e40949e709d4c0be2a206f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kunpeng Zhang</span>
	                <span class="date">April 12, 2017 at 10:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396190" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great. Thank you in advance.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396190' data-commentid="396190" data-postid="3882" data-belowelement="comment-396190" data-respondelement="respond" data-replyto="Reply to Kunpeng Zhang" aria-label='Reply to Kunpeng Zhang'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-396217" class="comment even depth-3">

	      	<div id="li-comment-396217" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ef10133ba4bbc7d63f56446ed831b1bd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ef10133ba4bbc7d63f56446ed831b1bd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">galdo trouchky</span>
	                <span class="date">April 12, 2017 at 7:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That would be awesome, indeed</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396217' data-commentid="396217" data-postid="3882" data-belowelement="comment-396217" data-respondelement="respond" data-replyto="Reply to galdo trouchky" aria-label='Reply to galdo trouchky'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415107" class="comment odd alt depth-3">

	      	<div id="li-comment-415107" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/60621ea4285d8f8b2de21f0c44dfe602?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/60621ea4285d8f8b2de21f0c44dfe602?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wenhan Wang</span>
	                <span class="date">September 29, 2017 at 10:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-415107" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. It is really a nice example of using LSTM. I&#8217;m working on it.<br />
I also have the same question, are you going to give an example on multivariate time series forecasting? I&#8217;m struggling on it.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-415107' data-commentid="415107" data-postid="3882" data-belowelement="comment-415107" data-respondelement="respond" data-replyto="Reply to Wenhan Wang" aria-label='Reply to Wenhan Wang'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415163" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-415163" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 30, 2017 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-415163" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have an example here:<br />
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow ugc">https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-415163' data-commentid="415163" data-postid="3882" data-belowelement="comment-415163" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396238" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-396238" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/31b071afa6e0c4c270edbddc304a8fba?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31b071afa6e0c4c270edbddc304a8fba?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gabriel Beauplet</span>
	                <span class="date">April 13, 2017 at 12:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396238" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You did a great job. This is very detailed ! Bravo 😉</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396238' data-commentid="396238" data-postid="3882" data-belowelement="comment-396238" data-respondelement="respond" data-replyto="Reply to Gabriel Beauplet" aria-label='Reply to Gabriel Beauplet'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396287" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396287" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 13, 2017 at 10:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396287" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m glad you found it useful Gabriel.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396287' data-commentid="396287" data-postid="3882" data-belowelement="comment-396287" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396895" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-396895" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hand</span>
	                <span class="date">April 19, 2017 at 1:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396895" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tutorial,</p>
<p>How do we get a prediction on a currently not existing point in the future?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396895' data-commentid="396895" data-postid="3882" data-belowelement="comment-396895" data-respondelement="respond" data-replyto="Reply to Hand" aria-label='Reply to Hand'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396983" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396983" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 20, 2017 at 9:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396983" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>yhat = model.predict(X)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396983' data-commentid="396983" data-postid="3882" data-belowelement="comment-396983" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396948" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-396948" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 20, 2017 at 1:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396948" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean without a y. </p>
<p>Error measurements are cool, but I also want to make a prediction for a next step.<br />
That&#8217;s my main intention to read this tutorial.</p>
<p>Since there are other tutorials out there, lacking the same issue, it would be great to have a complete example, with a real live ouput/result/value. </p>
<p>I&#8217;m aware of the fact that every problem should have its own solution/model, but with a real result (or a comprehensible way to it), the code would be more practical/reusable- especially for python-ml beginners trying to predict some values in the future.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396948' data-commentid="396948" data-postid="3882" data-belowelement="comment-396948" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396994" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396994" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 20, 2017 at 9:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-396994" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Fit your model on the entire training dataset then predict the next time step as:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6092adfec8575721109577" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
yhat = model.predict(X)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec8575721109577-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec8575721109577-1"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-396994' data-commentid="396994" data-postid="3882" data-belowelement="comment-396994" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400228" class="comment odd alt depth-3">

	      	<div id="li-comment-400228" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e6d3d830a29cf720d19da7e53d6aea0c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e6d3d830a29cf720d19da7e53d6aea0c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Donna</span>
	                <span class="date">May 22, 2017 at 7:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-400228" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for your tutorial. But can you specify how to fit the model on the entire training set and do the prediction for future point? Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-400228' data-commentid="400228" data-postid="3882" data-belowelement="comment-400228" data-respondelement="respond" data-replyto="Reply to Donna" aria-label='Reply to Donna'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400243" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-400243" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 22, 2017 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-400243" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is just a little too much hand holding Donna. What are you having trouble with exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-400243' data-commentid="400243" data-postid="3882" data-belowelement="comment-400243" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451789" class="comment odd alt depth-3">

	      	<div id="li-comment-451789" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/674b7cd612be60c75ab37ef46c82ebcc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/674b7cd612be60c75ab37ef46c82ebcc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.360doc.com/content/16/0804/10/1489589_580685937.shtml' rel='external nofollow ugc' class='url'>tuotuo</a></span>
	                <span class="date">October 16, 2018 at 8:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-451789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jsson:<br />
yhat = model.predict(X):X means current values? and yhad means predict value?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-451789' data-commentid="451789" data-postid="3882" data-belowelement="comment-451789" data-respondelement="respond" data-replyto="Reply to tuotuo" aria-label='Reply to tuotuo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451840" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-451840" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 17, 2018 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-451840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, X is the input required to make one or more predictions and yhat are the predictions.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-451840' data-commentid="451840" data-postid="3882" data-belowelement="comment-451840" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491268" class="comment odd alt depth-5">

	      	<div id="li-comment-491268" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2da66f2c974c55f8ec598729d86038ab?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2da66f2c974c55f8ec598729d86038ab?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ran Xu</span>
	                <span class="date">July 2, 2019 at 4:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-491268" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason, just got one question related to prediction. Since in your example, you own did prediction one test data,(known), where you have the row data to inverse the difference.  What about the prediction for future unknown data, how can  we do the difference inversion ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-491342" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-491342" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 3, 2019 at 8:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-491342" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, inverting the difference for a prediction only requires the last known observation.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397020" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-397020" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 20, 2017 at 2:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397020" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason,</p>
<p>I&#8217;m new to Python (mainly coding other languages) and just beginning to understand the code- thanks to your outstanding detailed descriptions. </p>
<p>In the last weeks I tried out two other tutorials and failed exactly at this point (making a first own test-appliance with a result).  </p>
<p>A) Could you please suggest a location/row number in the code in one of the examples for that line?</p>
<p>B) Is there a magic trick available to avoid the date conversion and work with real dates in own data sets?<br />
In the moment I would have to transform my data to that date format of the used raw data.</p>
<p>I&#8217;m afraid to break the code logic. </p>
<p>But I also try to research every crucial part of the code separately for example here:<br />
<a href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html" rel="nofollow ugc">https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html</a></p>
<p>My current Python skills are on the level of this tutorial<br />
<a href="https://www.youtube.com/watch?v=N4mEzFDjqtA" rel="nofollow ugc">https://www.youtube.com/watch?v=N4mEzFDjqtA</a> .</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397020' data-commentid="397020" data-postid="3882" data-belowelement="comment-397020" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397088" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397088" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 21, 2017 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397088" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Hans,</p>
<p>What do you mean by &#8220;first own test-appliance with a result&#8221;. I don&#8217;t follow.</p>
<p>Do you mean make a prediction? If so you can make a prediction by fitting the model no all of your data and calling model.predict(X).</p>
<p>Pandas is really flexible when it comes to loading date data. A good approach for you might be to specify your own date parsing function to use when loading your data. See this post for an example that does this:<br />
<a href="https://machinelearningmastery.com/stateful-stateless-lstm-time-series-forecasting-python/" rel="nofollow ugc">http://machinelearningmastery.com/stateful-stateless-lstm-time-series-forecasting-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397088' data-commentid="397088" data-postid="3882" data-belowelement="comment-397088" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397022" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-397022" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 20, 2017 at 3:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Worth to mention (latest Windows-Info 4.2017):</p>
<p>There is an issue with Keras/Anaconda on Windows.<br />
To run the last example above on Win, we have to manually reinstall Keras.<br />
Further informations can be found here:<br />
<a href="https://github.com/llSourcell/How-to-Predict-Stock-Prices-Easily-Demo/issues/3#issuecomment-288981625" rel="nofollow ugc">https://github.com/llSourcell/How-to-Predict-Stock-Prices-Easily-Demo/issues/3#issuecomment-288981625</a><br />
&#8230;otherwise it throws compiling errors.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397022' data-commentid="397022" data-postid="3882" data-belowelement="comment-397022" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397089" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397089" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 21, 2017 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397089" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Does this tutorial work for you?<br />
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow ugc">http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397089' data-commentid="397089" data-postid="3882" data-belowelement="comment-397089" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397113" class="comment odd alt depth-3">

	      	<div id="li-comment-397113" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 21, 2017 at 11:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397113" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I already saw this tutorial written by you. </p>
<p>On Windows (not a Mac) it&#8217;s a slightly different story to build such an environment, even with Anaconda.</p>
<p>It begins with the fact that there is no Tensorflow with a version &lt;= 3 for Windows and ends with the Keras-hint.</p>
<p>We needed several days to discuss it on Github and find the right setup in the context of another RNN-script (see the link).</p>
<p>I use virtual conda-environments and your scripts are running on windows if the keras-hint is implemented.<br />
Before I had the same issue with some of your scripts then with the discussed one on Github (compile error).</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397113' data-commentid="397113" data-postid="3882" data-belowelement="comment-397113" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397027" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-397027" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 20, 2017 at 5:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397027" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Update, what I mean:</p>
<p>I guess one could trigger &#8220;forecast_lstm(model, batch_size, X)&#8221; or &#8220;yhat = model.predict(X)&#8221; from the end of the last two example scripts. </p>
<p>But how to do that in regard to the trained model?</p>
<p>&#8220;Month=13, Predicted=???&#8221;</p>
<p>Do I have to define a new &#8220;fictional&#8221; X? And if so how?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397027' data-commentid="397027" data-postid="3882" data-belowelement="comment-397027" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397090" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397090" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 21, 2017 at 8:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397090" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must load the new input data for which a prediction is required as X and use your already fit model to make the prediction by calling the predict() function.</p>
<p>I&#8217;m eager to help, but perhaps I don&#8217;t understand the difficulty exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397090' data-commentid="397090" data-postid="3882" data-belowelement="comment-397090" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441070" class="comment even depth-3">

	      	<div id="li-comment-441070" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4caaee987beebf8535d2489e6e90df79?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4caaee987beebf8535d2489e6e90df79?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.codefen.com' rel='external nofollow ugc' class='url'>Christian C. Russo</a></span>
	                <span class="date">June 17, 2018 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-441070" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi again Jason! brilliant tutorial once again,</p>
<p>I believe many people is asking about the model.predict() because it&#8217;s not really working as expected.</p>
<p>First problem is that doing:</p>
<p>yhat = model.predict(X) </p>
<p>with the code example previously given, returns:</p>
<p>NameError: name &#8216;model&#8217; is not defined</p>
<p>As I understand, this is because the model is created under the name &#8220;lstm_model&#8221; instead of model, so using:</p>
<p>yhat = lstm_model.predict(X)</p>
<p>works, but returns:</p>
<p>ValueError: Error when checking : expected lstm_1_input to have 3 dimensions, but got array with shape (1, 1)</p>
<p>So, personally, what I have done, is using the &#8220;forecast_lstm&#8221; function, this way:</p>
<p>yhat = forecast_lstm(lstm_model, 1, X)</p>
<p>print(yhat)</p>
<p>0.28453988</p>
<p>Which actually returns a value.</p>
<p>Now the next problem is that the X, is nothing else than the last X of the example, as I never redefine it.</p>
<p>I found that the amount of functions and filters applied to the training data is quite big, hence I need to replicate them to make the shape match.</p>
<p>This is my original training data.</p>
<p>series = read_sql_query(seleccion, conn, parse_dates=[&#8216;creacion&#8217;], index_col=[&#8216;creacion&#8217;])</p>
<p>print(series)<br />
sys.exit()</p>
<p>                     menores<br />
creacion<br />
2018-06-17 03:56:11      0.0<br />
2018-06-17 03:54:03      2.0<br />
2018-06-17 03:52:11      4.0<br />
2018-06-17 03:50:05      6.0<br />
2018-06-17 03:48:17      4.0<br />
2018-06-17 03:46:04      4.0<br />
2018-06-17 03:44:01      4.0<br />
2018-06-17 03:43:05      1.0<br />
2018-06-17 03:40:12      2.0<br />
2018-06-17 03:38:12      0.0<br />
2018-06-17 03:36:21      4.0<br />
2018-06-17 03:34:32      4.0<br />
2018-06-17 03:32:05      3.0<br />
2018-06-17 03:30:01      2.0<br />
2018-06-17 03:28:23      1.0<br />
2018-06-17 03:26:17      3.0<br />
2018-06-17 03:24:04      0.0<br />
2018-06-17 03:22:34      4.0<br />
2018-06-17 03:20:04      2.0<br />
2018-06-17 03:18:18      2.0<br />
2018-06-17 03:16:00      3.0<br />
2018-06-17 03:14:06      6.0<br />
2018-06-17 03:12:06      4.0<br />
2018-06-17 03:10:04      2.0<br />
2018-06-17 03:08:02      0.0<br />
2018-06-17 03:06:02      4.0<br />
2018-06-17 03:04:02      4.0<br />
2018-06-17 03:02:10      3.0<br />
2018-06-17 03:00:22      4.0<br />
2018-06-17 02:59:13      3.0<br />
&#8230;                      &#8230;<br />
[7161 rows x 1 columns]</p>
<p>Then, this process is applied to &#8220;series&#8221;:</p>
<p># transform data to be stationary<br />
raw_values  = series.values<br />
diff_values = difference(raw_values, 1)</p>
<p># transform data to be supervised learning<br />
supervised = timeseries_to_supervised(diff_values, 1)<br />
supervised_values = supervised.values</p>
<p>if you print &#8220;supervised_values&#8221; at that point, the original data has been transformed to:</p>
<p>[[0 array([4.])]<br />
 [array([4.]) array([-3.])]<br />
 [array([-3.]) array([1.])]<br />
 &#8230;<br />
 [array([2.]) array([4.])]<br />
 [array([4.]) array([-3.])]<br />
 [array([-3.]) array([-1.])]]</p>
<p>which is clearly less and more condensed information&#8230;</p>
<p>Therefore, if I try to apply </p>
<p>yhat = forecast_lstm(lstm_model, 1, X)</p>
<p>after the new data has been loaded:</p>
<p> predecir = read_sql_query(seleccion, conn, parse_dates=[&#8216;creacion&#8217;], index_col=[&#8216;creacion&#8217;])</p>
<p>    #limpiamos la cache<br />
    conn.commit()    </p>
<p>    print(predecir)<br />
    print(X)    </p>
<p>    yhat = forecast_lstm(lstm_model, 1, X)<br />
    #ynew = ynew[0]</p>
<p>    print(yhat)</p>
<p>I get the following error:</p>
<p>AttributeError: &#8216;DataFrame&#8217; object has no attribute &#8216;reshape&#8217;</p>
<p>&#8212;&#8212;&#8212;&#8212;</p>
<p>So kinda lost in how to actually apply the same structure to the new data before being able to make the new prediction!</p>
<p>I&#8217;ll paste the source my code in case someone needs it:<br />
<a href="https://codepen.io/anon/pen/xzPVxE" rel="nofollow ugc">https://codepen.io/anon/pen/xzPVxE</a></p>
<p>You&#8217;ll see that I&#8217;m loading the data directly from MySQL, and also, splitting the training and test data with a different approach from a previous example given in the blog!</p>
<p>I&#8217;m not sure either about how to make the next prediction!</p>
<p>Thanks a lot for this blog once again&#8230; I wouldn&#8217;t be even trying this if it wasn&#8217;t for your help and explanations!!!</p>
<p>My best wishes,<br />
Chris</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-441070' data-commentid="441070" data-postid="3882" data-belowelement="comment-441070" data-respondelement="respond" data-replyto="Reply to Christian C. Russo" aria-label='Reply to Christian C. Russo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441114" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-441114" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 18, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-441114" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-441114' data-commentid="441114" data-postid="3882" data-belowelement="comment-441114" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-487187" class="comment even depth-4">

	      	<div id="li-comment-487187" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7b53d7a37a3159769c89bb00b46ba2bc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7b53d7a37a3159769c89bb00b46ba2bc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Guglielmo Iozzia</span>
	                <span class="date">May 31, 2019 at 2:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have solved this the same way as suggested in this Stack Overflow post: <a href="https://stackoverflow.com/questions/42240376/dataframe-object-has-no-attribute-reshape" rel="nofollow ugc">https://stackoverflow.com/questions/42240376/dataframe-object-has-no-attribute-reshape</a><br />
I am no more directly invoking the reshape method in the pandas training and test DataFrames, but indirectly through their values:<br />
train = train.values.reshape(train.shape[0], train.shape[1])<br />
test = test.values.reshape(test.shape[0], test.shape[1])</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487187' data-commentid="487187" data-postid="3882" data-belowelement="comment-487187" data-respondelement="respond" data-replyto="Reply to Guglielmo Iozzia" aria-label='Reply to Guglielmo Iozzia'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487281" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-487281" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 31, 2019 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m happy to hear that.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397109" class="comment even thread-even depth-1">

	      	<div id="li-comment-397109" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 21, 2017 at 10:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397109" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I knew I shouldn&#8217;t mention the date conversion part :-). Meanwhile I managed it with &#8220;return datetime.strptime(x, &#8216;%Y-%m-%d&#8217;)&#8221;<br />
I have all of your example script parts in separate python file version. So I can test out modifications for specific requirements.<br />
<code><br />
python basic_data_loading.py<br />
python persistence_forecast_model.py<br />
python transform_time_series_to_supervised.py<br />
python transform_time_series_to_statonary_remove_trends.py<br />
python transform_scales.py<br />
python complete_example.py<br />
</code></p>
<p>Own data loading is solved. That was a relatively easy task.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397109' data-commentid="397109" data-postid="3882" data-belowelement="comment-397109" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397112" class="comment odd alt depth-2">

	      	<div id="li-comment-397112" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 21, 2017 at 10:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397112" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Since the transforming and performance measurement parts are running (I guess they will do even with integer data)<br />
I now have to build a part lets call it:</p>
<p>&#8220;python predict_one_value.py&#8221;</p>
<p>Of course I have to load my own data that&#8217;s clear. </p>
<p>The question is where to trigger the function<br />
<code><br />
yhat = model.predict(X)<br />
</code><br />
in the context of one of your example-scripts and finally say:<br />
print(yhat). That&#8217;s all. </p>
<p>I guess a short example snippet could solve the problem.<br />
Could you provide an example- It would help a lot?</p>
<p>Currently I also don&#8217;t understand the role of X completely.<br />
In the context of &#8220;datetime.strptime&#8221; it seems to be a date only, If I print it out.<br />
So if I would have training data of:<br />
&#8211; 01.12.1977<br />
&#8211; 02.12.1977<br />
&#8211; 03.12.1977<br />
I would guess I could say something like &#8220;yhat = model.predict(&#8220;1977-12-04&#8243;)&#8221;.<br />
The question is where and when in which code context.</p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397112' data-commentid="397112" data-postid="3882" data-belowelement="comment-397112" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397116" class="comment even depth-3">

	      	<div id="li-comment-397116" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 21, 2017 at 12:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Update:</p>
<p>Currently I use the the code from &#8220;complete example&#8221; (&#8220;without robust result&#8221;).<br />
If I comment out from line 106 to line 127 and then at the end of the script say:</p>
<p><code><br />
# report one value in the future<br />
test = datetime.strptime('2017-04-15', '%Y-%m-%d')<br />
yhat = model.predict(test)<br />
print(yhat)<br />
</code></p>
<p>I get the error message &#8216;model is not defined&#8217;. So trying&#8230;</p>
<p><code><br />
# report one value in the future<br />
test = datetime.strptime('2017-04-15', '%Y-%m-%d')<br />
yhat = lstm_model.predict(test)<br />
print(yhat)<br />
</code></p>
<p>&#8230;throws the error &#8220;Data should be a Numby array&#8221;.</p>
<p>I guess maybe I could also append a new date to the raw data (without a y),<br />
but I&#8217;m not sure If this would be right.</p>
<p>The best way to get this running would be an example snipped in context.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397116' data-commentid="397116" data-postid="3882" data-belowelement="comment-397116" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397187" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-397187" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 22, 2017 at 9:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will give you a clearer idea of how to use neural nets in Keras including making predictions:<br />
<a href="https://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/" rel="nofollow ugc">http://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/</a></p>
<p>Yes, input data to making a prediction must be a 2D numpy array. It will not be date data, it will be past obs in the case of time series forecasting.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397187' data-commentid="397187" data-postid="3882" data-belowelement="comment-397187" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397218" class="comment even depth-5">

	      	<div id="li-comment-397218" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 22, 2017 at 11:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397218" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you,</p>
<p>I will read it ;-).</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397229" class="comment odd alt depth-5">

	      	<div id="li-comment-397229" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 22, 2017 at 12:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397229" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have read the tutorial and tried out the pima indians diabetes example.<br />
I guess I got it and understand the 5 steps (mostly).</p>
<p>Unfortunately this does not answer my question. Or do I miss something?<br />
In my problem I have only one input like in the tutorial on this site.</p>
<p>When you say:</p>
<p>&#8220;yhat = model.predict(X)&#8221;</p>
<p>would give a forecast for a next step.<br />
What about a step which is not in the training data nor in the test data?</p>
<p>I have a SVM model which proves and predicts based on my raw data (realized in another environment).<br />
Lets say I have 100 items training data, 10 items test data.<br />
It will printout 10 predictions and additionally corresponding performance data.<br />
The last printed prediction is for a future step which lies in the future.</p>
<p>How would this be archived in your example?<br />
Do I have to shift something?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397291" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-397291" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 23, 2017 at 5:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>To make predictions beyond your dataset, you must feed in the last few observations from your dataset as input (X) to predict what happens next (y).</p>
<p>This post might clear up your thinking on X and y:<br />
<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow ugc">http://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397314" class="comment odd alt depth-5">

	      	<div id="li-comment-397314" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 23, 2017 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397314" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>&gt;To make predictions beyond your dataset, you must feed in the last few observations from your dataset as input (X) to &gt;predict what happens next (y).</p>
<p>Is there an example available where this is done?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397381" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-397381" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 24, 2017 at 5:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the &#8220;LSTM Forecast&#8221; section of this very post.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397433" class="comment odd alt depth-5">

	      	<div id="li-comment-397433" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 24, 2017 at 1:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397433" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Assuming that &#8220;X = row[0:-1]&#8221; is an observation,<br />
how do we sample/collect the last few observations, to make a forecast.?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397520" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-397520" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 25, 2017 at 7:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397520" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on your model, if your model expects the last one observation as input, then reframe that value as a 2d array and provide it as X to model.predict(X). </p>
<p>If your model requires the last two lag obs as inputs, retrieve them, define them as a one row, two column matrix and provide them to model.predict(). </p>
<p>And so on. I hope that helps.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405735" class="comment odd alt depth-5">

	      	<div id="li-comment-405735" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://www.linkedin.com/in/arunpmenon1990/' rel='external nofollow ugc' class='url'>Arun</a></span>
	                <span class="date">July 13, 2017 at 10:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405735" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI Jason,</p>
<p>Even i started with machine learning and have similar kind of doubt so in one step forecasting we can only get one time step future observation correct ? and to get the prediction i have provided last input observation and then the value obtained from model.predict(X) has to be again scaled and inversed correct ?</p>
<p>PFB the code:<br />
X = test_scaled[3,-1:] (my last observation)<br />
yhat = forecast_lstm(lstm_model, 1, X)<br />
yhat = invert_scale(scaler, X, yhat)<br />
yhat = inverse_difference(raw_values, yhat, 1)<br />
print(yhat)</p>
<p>Can you please guide me if i am going in a right way ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405757" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-405757" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 13, 2017 at 4:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405757" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, one step forecasting involves predicting the next time step. </p>
<p>You can make multi-step forecasts, learn more in this post:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>Yes, to make use of the prediction you will need to invert any data transforms performed such as scaling and differencing.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405787" class="comment odd alt depth-5">

	      	<div id="li-comment-405787" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arun Menon</span>
	                <span class="date">July 13, 2017 at 11:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405787" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason ..</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405789" class="comment even depth-5">

	      	<div id="li-comment-405789" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arun Menon</span>
	                <span class="date">July 13, 2017 at 11:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Being said that, i have another clarification , so when i forecast the next time step using this model , using the below code:<br />
X = test_scaled[3,-1:] (my last observation)<br />
yhat = forecast_lstm(lstm_model, 1, X)<br />
yhat = invert_scale(scaler, X, yhat)<br />
yhat = inverse_difference(raw_values, yhat, 1)<br />
print(yhat)</p>
<p>in the above code, let yhat be the prediction of future time step, can i use the result of yhat and use the same model to predict one more step ahead in the future ? is this what we call as the recursive multistep forecast ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405845" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-405845" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 14, 2017 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405845" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. This is recursive.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405803" class="comment even depth-5">

	      	<div id="li-comment-405803" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arun Menon</span>
	                <span class="date">July 14, 2017 at 1:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can i use the below code and use the recursive multistep forecast<br />
for eg :<br />
yhat value can be used as an input to the same model again to get the next future step and so on ?</p>
<p>X = test_scaled[3,-1:] (my last observation)<br />
yhat = forecast_lstm(lstm_model, 1, X)<br />
yhat = invert_scale(scaler, X, yhat)<br />
yhat = inverse_difference(raw_values, yhat, 1)<br />
print(yhat)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405872" class="comment odd alt depth-5">

	      	<div id="li-comment-405872" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arun Menon</span>
	                <span class="date">July 14, 2017 at 11:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405872" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>In predictive analytics using this ML technique, how many future steps should we able to predict , is there any ideal forecasting range in future for eg if i have a data for the last 10 days or so , and i want to forecast the future , the less the future time steps are set, the better the result as the error will be minimum right. Can i use the same code for predicting time series data in production for network traffic for future 3 days ? requirement given for me was to predict the network bandwidth  for the next entire week given the data for past 1 year.</p>
<p>Your comments and suggestions always welcome 🙂</p>
<p>Regards,<br />
Arun</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405992" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-405992" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 15, 2017 at 9:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405992" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on the problem and the model. </p>
<p>Generally, the further in the future you want to predict, the worse the performance of the model.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397140" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-397140" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 21, 2017 at 6:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397140" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>can we normalize the RMSE-value(s)?<br />
And if so how?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397140' data-commentid="397140" data-postid="3882" data-belowelement="comment-397140" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397190" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397190" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 22, 2017 at 9:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397190" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Normalize the skill score?</p>
<p>Yes, but you will need to know the largest possible error.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397190' data-commentid="397190" data-postid="3882" data-belowelement="comment-397190" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397230" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-397230" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">April 22, 2017 at 12:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397230" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m feeding your example with values ranged from 1 to 70.</p>
<p>There is no increasing trend in my raw data.</p>
<p>When it comes to predictions the script predicts values above 70.<br />
Regarding to the other tutorial (5 Step Life-Cycle) I think it has to do with the compile part (model.compile).<br />
But I&#8217;m not sure. Could you provide a comprehensible hint in regard of the example script on this site?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397230' data-commentid="397230" data-postid="3882" data-belowelement="comment-397230" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-397307" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-397307" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9dc8ca3092f4d85328f34e0713834785?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9dc8ca3092f4d85328f34e0713834785?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fabian</span>
	                <span class="date">April 23, 2017 at 10:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397307" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
assuming you had multiple features (you can add one feature to the shampoo dataset) and wanted to use multiple timesteps, what would the dataset look like that I put into the model? Is it a 3 dimensional array, where the features are lists of values and each observation is a list of these features and the label(s) (which is also a list of values)?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397307' data-commentid="397307" data-postid="3882" data-belowelement="comment-397307" data-respondelement="respond" data-replyto="Reply to Fabian" aria-label='Reply to Fabian'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397380" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397380" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 24, 2017 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397380" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, it would be a 3D array with the dimensions [samples, timesteps, features].</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397380' data-commentid="397380" data-postid="3882" data-belowelement="comment-397380" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397618" class="comment even thread-even depth-1">

	      	<div id="li-comment-397618" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f7542e2ce2c97b0a2353581b09f8403c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f7542e2ce2c97b0a2353581b09f8403c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rahul</span>
	                <span class="date">April 26, 2017 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397618" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Right now the model gives only one step forecast. What if I wanted to create a model which gives forecast for next 60 months.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397618' data-commentid="397618" data-postid="3882" data-belowelement="comment-397618" data-respondelement="respond" data-replyto="Reply to Rahul" aria-label='Reply to Rahul'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397631" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397631" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 26, 2017 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397631" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I will have a post on this see, until then see this post:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397631' data-commentid="397631" data-postid="3882" data-belowelement="comment-397631" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397702" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-397702" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2c2fc2d581e40949e709d4c0be2a206f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2c2fc2d581e40949e709d4c0be2a206f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kunpeng Zhang</span>
	                <span class="date">April 27, 2017 at 1:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397702" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I have a question.<br />
raw_values = series.values<br />
diff_values = difference(raw_values, 1)<br />
print(len(raw_values))        36<br />
print(len(diff_values))         35</p>
<p>So, after difference we lose the first value?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397702' data-commentid="397702" data-postid="3882" data-belowelement="comment-397702" data-respondelement="respond" data-replyto="Reply to Kunpeng Zhang" aria-label='Reply to Kunpeng Zhang'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397741" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397741" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 27, 2017 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397741' data-commentid="397741" data-postid="3882" data-belowelement="comment-397741" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397706" class="comment even thread-even depth-1">

	      	<div id="li-comment-397706" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/81fc844d62d6a167083283acc56e3ca1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/81fc844d62d6a167083283acc56e3ca1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://None' rel='external nofollow ugc' class='url'>Guido van Steen</a></span>
	                <span class="date">April 27, 2017 at 2:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397706" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason, </p>
<p>Thank you very much for this extremely useful and interesting post. </p>
<p>I may be missing something, but I think there is one omission: By differencing you loose the trend including its start and end level. Later on you try restore the trend again, but in your code it seems you fail to restore the end level. IMO the end level of the current observations should be added to all the predictions.  </p>
<p>Thanks again!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397706' data-commentid="397706" data-postid="3882" data-belowelement="comment-397706" data-respondelement="respond" data-replyto="Reply to Guido van Steen" aria-label='Reply to Guido van Steen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397743" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397743" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 27, 2017 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean by the end level? Sorry I don&#8217;t follow, perhaps you could restate your comment?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397743' data-commentid="397743" data-postid="3882" data-belowelement="comment-397743" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397709" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-397709" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ae4a59d807ca5b17d16554946460696c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ae4a59d807ca5b17d16554946460696c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raul</span>
	                <span class="date">April 27, 2017 at 3:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397709" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tutorial!<br />
Quick question: On the scaling section of the tutorial you say that </p>
<p>&#8220;To make the experiment fair, the scaling coefficients (min and max) values must be calculated on the training dataset and applied to scale the test dataset and any forecasts. This is to avoid contaminating the experiment with knowledge from the test dataset, which might give the model a small edge.&#8221;</p>
<p>However, if the max of your sample is on the test dataset the scaling with parameters from the training set will yield a number outside the [-1,1] range. How can one deal with that?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397709' data-commentid="397709" data-postid="3882" data-belowelement="comment-397709" data-respondelement="respond" data-replyto="Reply to Raul" aria-label='Reply to Raul'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397744" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397744" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 27, 2017 at 8:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397744" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct.</p>
<p>One good approach is to estimate the expected min and max values that are possible for the domain and use these to scale.</p>
<p>If even then you see values out of range, you can clamp them to the bounds 0/1.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397744' data-commentid="397744" data-postid="3882" data-belowelement="comment-397744" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397720" class="comment even thread-even depth-1">

	      	<div id="li-comment-397720" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/367b5df5382b0a3feb7fd17bac0ea003?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/367b5df5382b0a3feb7fd17bac0ea003?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://None' rel='external nofollow ugc' class='url'>Guido van Steen</a></span>
	                <span class="date">April 27, 2017 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397720" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason, </p>
<p>To be more precise: you should add the difference between the start level and the end level of the train set. This is because the current code effectively replicates the train set. By this I means that it starts at the same level as the train set. However, it should start at the end level of the train set. </p>
<p>Kind regards, </p>
<p>Guido</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397720' data-commentid="397720" data-postid="3882" data-belowelement="comment-397720" data-respondelement="respond" data-replyto="Reply to Guido van Steen" aria-label='Reply to Guido van Steen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397770" class="comment odd alt depth-2">

	      	<div id="li-comment-397770" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/367b5df5382b0a3feb7fd17bac0ea003?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/367b5df5382b0a3feb7fd17bac0ea003?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://None' rel='external nofollow ugc' class='url'>Guido van Steen</a></span>
	                <span class="date">April 27, 2017 at 3:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397770" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I will try to restate my comment: </p>
<p>Currently the predictions (of your test set) start at the same level as the observations (in your train set). Therefore, there is a shift between the last observed value (in your train set) and the first predicted value (of your test set). The size of this shift is equal to: start level of the observations minus end level of the observations (in your train set). You should correct for this shift by adding it to the predicted values.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397770' data-commentid="397770" data-postid="3882" data-belowelement="comment-397770" data-respondelement="respond" data-replyto="Reply to Guido van Steen" aria-label='Reply to Guido van Steen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397841" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-397841" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 28, 2017 at 7:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397841" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Isn&#8217;t this made moot by making the data stationary?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397841' data-commentid="397841" data-postid="3882" data-belowelement="comment-397841" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397820" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-397820" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bd02905e54b28969ac80042731a87ca6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bd02905e54b28969ac80042731a87ca6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Deeps</span>
	                <span class="date">April 28, 2017 at 4:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>1. can you please explain me the below 2 lines in detail. </p>
<p>model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True))<br />
model.add(Dense(1))</p>
<p>2. I want to know the layer architecture. What are the number of neurons in hidden layer?<br />
3. If I want to add one more hidden layer, how the syntax looks like?<br />
4. What could be the reason for test rmse is less than train rmse?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397820' data-commentid="397820" data-postid="3882" data-belowelement="comment-397820" data-respondelement="respond" data-replyto="Reply to Deeps" aria-label='Reply to Deeps'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397860" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-397860" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 28, 2017 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-397860" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The line defines the input layer and the first LSTM hidden layer with &#8220;neurons&#8221; number of memory units.</p>
<p>You can stack LSTMs, the first hidden layer must return sequences (return_sequence=True) and you can add a second LSTM layer. I have an example here:<br />
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow ugc">http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a></p>
<p>Better performance on the test data than the training data may be a sign of an unstable/underfit model.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-397860' data-commentid="397860" data-postid="3882" data-belowelement="comment-397860" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398304" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-398304" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6a1c54a7ba87f7c6072dc7ae19c2c0ca?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6a1c54a7ba87f7c6072dc7ae19c2c0ca?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fabio</span>
	                <span class="date">May 2, 2017 at 9:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398304" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hallo Jason, thank you for this post! I bought the first version of your book and I have seen you have in the meantime deeper analysed this topic. Very good! 🙂 Something have I yet not clear.</p>
<p>&#8220;Samples: These are independent observations from the domain, typically rows of data.<br />
Time steps: These are separate time steps of a given variable for a given observation.&#8221;</p>
<p>I could understand the case where  the time step parameter is 1 as in your book and in this example but I can&#8217;t figure out why and how it could be grater than 1&#8230;</p>
<p>My hypothesys, sure wrong 🙂</p>
<p>Perhaps when a timestep is made of n observations one could give the value n to it&#8230;but then I would expect when one in the model writes (pag. 192):</p>
<p>&#8220;model.add(LSTM(4, input_shape=(1, look_back)))&#8221;</p>
<p>the LSTM would use (look_back * timesteps) rows for every step to predict the next row&#8230;</p>
<p>I cannot also understand why you say &#8216;of a given variable&#8217;&#8230;a row is normally built by the values of many variables, isn&#8217;t it?</p>
<p>Could you give me an example with timesteps &gt; 1? Thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398304' data-commentid="398304" data-postid="3882" data-belowelement="comment-398304" data-respondelement="respond" data-replyto="Reply to Fabio" aria-label='Reply to Fabio'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398359" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398359" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 3, 2017 at 7:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Fabio,</p>
<p>The structure of the input to the LSTM is [samples, timesteps, features]</p>
<p>If you have multiple observations at one time step, then these are represented as features.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398359' data-commentid="398359" data-postid="3882" data-belowelement="comment-398359" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398933" class="comment odd alt depth-3">

	      	<div id="li-comment-398933" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6a1c54a7ba87f7c6072dc7ae19c2c0ca?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6a1c54a7ba87f7c6072dc7ae19c2c0ca?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fabio</span>
	                <span class="date">May 7, 2017 at 10:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398933" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>unfortunately If don&#8217;t have a concrete example I cannot fully understand&#8230;The examples in your posts and your book are clear to me but they are always on timesteps=1&#8230;if I&#8217;m not wrong. For example how could be adapted the szenario described in this post in order to manage a timesteps&gt;1?</p>
<p>Thank you very much!</p>
<p>PS. In the meantime I bought also your book on time series 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398933' data-commentid="398933" data-postid="3882" data-belowelement="comment-398933" data-respondelement="respond" data-replyto="Reply to Fabio" aria-label='Reply to Fabio'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398963" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-398963" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 8, 2017 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398963" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post on multi-step forecasting:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398963' data-commentid="398963" data-postid="3882" data-belowelement="comment-398963" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398586" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-398586" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e3556750226c9743e5cefa9aa3bf2504?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e3556750226c9743e5cefa9aa3bf2504?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nitin</span>
	                <span class="date">May 5, 2017 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for the wonderful tutorial!<br />
I am using your tutorial to apply LSTM network on some syslog/network log data.</p>
<p>I have syslog data(a specific event) for each day for last 1 year and so I am using LSTM network for time series analysis.</p>
<p>As I understand from your tutorial.<br />
	1. A batch of data is a fixed-sized number of rows from the training dataset that defines how many patterns to process before updating the weights of the network. Based on the batch_size the Model takes random samples from the data for the analysis. For time series this is not desirable, hence the batch_size should always be 1.<br />
	2. By default, the samples within an epoch are shuffled prior to being exposed to the network. This is undesirable for the LSTM because we want the network to build up state as it learns across the sequence of observations. We can disable the shuffling of samples by setting “shuffle” to “False“.</p>
<p>Scenario1 &#8211;<br />
Using above two rules/guidelines &#8211; I ran several trials with different number of neurons, epoch size and different layers and got better results from the baseline model(persistence model).</p>
<p>Scenario2-<br />
Without using above guidelines/rules &#8211; I ran several trials with different number of neurons, epoch size and different layers and got even better results than Scenario 1.</p>
<p>Query &#8211; Setting shuffle to True and Batch_size values to 1 for time series. Is this a rule or a guideline?</p>
<p>It seems logical reading your tutorial that the data for time series should not be shuffled as we do not want to change the sequence of data, but for my data the results are better if I let the data be shuffled.<br />
At the end what I think, what matters is how I get better predictions with my runs.<br />
I think I should try and put away &#8220;theory&#8221; over concrete evidence, such as metrics, elbows, RMSEs,etc. </p>
<p>Kindly enlighten.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398586' data-commentid="398586" data-postid="3882" data-belowelement="comment-398586" data-respondelement="respond" data-replyto="Reply to Nitin" aria-label='Reply to Nitin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398605" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398605" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 5, 2017 at 11:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398605" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Random samples are not taken, LSTMs require sequence data to be ordered &#8211; they learn order dependence.</p>
<p>The &#8220;shuffle&#8221; argument must be set to &#8220;False&#8221; on sequence prediction problems if sequence data is spread across samples.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398605' data-commentid="398605" data-postid="3882" data-belowelement="comment-398605" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398840" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-398840" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Masum</span>
	                <span class="date">May 7, 2017 at 12:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>I have two hours time series data which consists of 120 observations, using LSTM RNN how can I predict next 30 observation while putting all my data to training section. </p>
<p>We normally split the original data set in two data set ( test dataset and validation dataset) for checking our model performance. I would like to see that my model is only taking help from training dataset to produce an output that does match with validation data set. What I understand from several of your blogs that we are forecasting single value and using that single forecasting along with the help of validation dataset we are forecasting rest of values. I believe I getting lost there? How it is going to work when have only past and current data ( suppose no validation data) and we want to predict the next half an hour.</p>
<p>For example, suppose I have data of a product price from 12 to 1:30pm which consists of 90 observations and using these past 90 observations can we forecast the price of that product during 1:31 to 2:00pm(otherwise next 30 observations) .</p>
<p>Would you please help me to solve the confusion that I have? By the way I am going through your books time series forecasting with Python and deep learning with Python.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398840' data-commentid="398840" data-postid="3882" data-belowelement="comment-398840" data-respondelement="respond" data-replyto="Reply to Masum" aria-label='Reply to Masum'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398871" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398871" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 7, 2017 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can make a multi-step model with an LSTM by using it directly (predict n timesteps in a one shot manner) or recursively (use the same model again and again and use predictions as inputs for subsequent predictions).</p>
<p>More on multi-step forecasting here:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398871' data-commentid="398871" data-postid="3882" data-belowelement="comment-398871" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398874" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-398874" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">masum</span>
	                <span class="date">May 7, 2017 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398874" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for quick replay </p>
<p>Looks like you sleep very less as you have provided feedback on early morning from your site.</p>
<p>Thanks for being so kind to your students. May god bless you.</p>
<p>By the way do you have any blog or example for second option that you have provided me(use the same model again and again and use predictions as inputs for subsequent predictions). Obviously I would like to see that I am not using any data from validation dataset or not getting any feedback from validation data. Model should only from past and current data along with current predictions. I hope you got this confused student.</p>
<p>Thanking you</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398874' data-commentid="398874" data-postid="3882" data-belowelement="comment-398874" data-respondelement="respond" data-replyto="Reply to masum" aria-label='Reply to masum'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398957" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398957" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 8, 2017 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-398957" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don&#8217;t have an example of using the model recursively. I believe you could adapt the above example.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-398957' data-commentid="398957" data-postid="3882" data-belowelement="comment-398957" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399099" class="comment odd alt depth-3">

	      	<div id="li-comment-399099" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f0788916a9fa130b449673180dc9fa6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">masum</span>
	                <span class="date">May 9, 2017 at 9:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-399099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>would you please give me some hint where I have to change the code to make the model recursive as I am not very good at coding.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-399099' data-commentid="399099" data-postid="3882" data-belowelement="comment-399099" data-respondelement="respond" data-replyto="Reply to masum" aria-label='Reply to masum'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399244" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-399244" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 10, 2017 at 8:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-399244" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Predictions would be used as history (input) to make predictions on the subsequent time steps.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-399244' data-commentid="399244" data-postid="3882" data-belowelement="comment-399244" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399110" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-399110" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0ae8f55c5fc584f60ca9ad7fce0890ed?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0ae8f55c5fc584f60ca9ad7fce0890ed?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Max</span>
	                <span class="date">May 9, 2017 at 11:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-399110" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for the wonderful tutorial!<br />
A little problem here:</p>
<p><code></code><code><br />
def invert_scale(scaler, X, value):<br />
	new_row = [x for x in X] + [yhat]<br />
        ...<br />
</code><code></code></p>
<p>Does it should be </p>
<p><code></code><code><br />
def invert_scale(scaler, X, value):<br />
	new_row = [x for x in X] + [value]<br />
        ...<br />
</code><code></code></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-399110' data-commentid="399110" data-postid="3882" data-belowelement="comment-399110" data-respondelement="respond" data-replyto="Reply to Max" aria-label='Reply to Max'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399247" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399247" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 10, 2017 at 8:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-399247" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Max.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-399247' data-commentid="399247" data-postid="3882" data-belowelement="comment-399247" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399838" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-399838" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e62f690a21715117e1c6eef9da5932c2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e62f690a21715117e1c6eef9da5932c2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Charlie</span>
	                <span class="date">May 17, 2017 at 4:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-399838" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m getting the following error when running the first block of code you provide.</p>
<p>TypeError: strptime() argument 1 must be str, not numpy.ndarray</p>
<p>It seems like this a problem with how Python 3.6 handles byte strings.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-399838' data-commentid="399838" data-postid="3882" data-belowelement="comment-399838" data-respondelement="respond" data-replyto="Reply to Charlie" aria-label='Reply to Charlie'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399862" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399862" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 17, 2017 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-399862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have only tested the code on Python 2.7 and Python 3.5, perhaps try one of those?</p>
<p>Otherwise, you may need to adapt the example for your specific platform, if an API change is indeed the cause of your issue.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-399862' data-commentid="399862" data-postid="3882" data-belowelement="comment-399862" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-419313" class="comment odd alt depth-2">

	      	<div id="li-comment-419313" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/de683b611016bc221494aa857a6276c8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/de683b611016bc221494aa857a6276c8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sabih</span>
	                <span class="date">November 8, 2017 at 6:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419313" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The issue was with the text in footer &#8216;Sales of shampoo over a three year period&#8217;.</p>
<p>Either delete the footer OR </p>
<p>Change the line:</p>
<p>series = read_csv(&#8216;shampoo-sales.csv&#8217;, header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)</p>
<p>to:</p>
<p>series = read_csv(&#8216;shampoo-sales.csv&#8217;, header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser, skipfooter=2)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419313' data-commentid="419313" data-postid="3882" data-belowelement="comment-419313" data-respondelement="respond" data-replyto="Reply to Sabih" aria-label='Reply to Sabih'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-420895" class="comment even depth-2">

	      	<div id="li-comment-420895" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.etherpros.com' rel='external nofollow ugc' class='url'>John Strong</a></span>
	                <span class="date">November 23, 2017 at 2:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420895" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think that error is caused by the line of descriptive text at the bottom of the shampoo sales data file. If you see this comment at the bottom of the data file, remove it:</p>
<p>Sales of shampoo over a three year period</p>
<p>The data file also has the dates enclosed in double quotes. A couple of times that bit me too. The date_parser callback is a little fickle.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420895' data-commentid="420895" data-postid="3882" data-belowelement="comment-420895" data-respondelement="respond" data-replyto="Reply to John Strong" aria-label='Reply to John Strong'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399941" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-399941" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a925a54fb54e27f347277bd66836ce66?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a925a54fb54e27f347277bd66836ce66?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Logan</span>
	                <span class="date">May 18, 2017 at 10:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-399941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, Your examples are great, thanks. </p>
<p>I have a question:</p>
<p>1- What do we do with the array of predicted values when we use lstm_model.predict() with train data in the example? It seems like they are not being used. Is it important for the net?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-399941' data-commentid="399941" data-postid="3882" data-belowelement="comment-399941" data-respondelement="respond" data-replyto="Reply to Logan" aria-label='Reply to Logan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400003" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-400003" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 19, 2017 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-400003" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Logan.</p>
<p>What do you mean exactly? Is there a specific section and line of code you are referring to in the tutorial?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-400003' data-commentid="400003" data-postid="3882" data-belowelement="comment-400003" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400606" class="comment odd alt depth-3">

	      	<div id="li-comment-400606" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a925a54fb54e27f347277bd66836ce66?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a925a54fb54e27f347277bd66836ce66?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Logan</span>
	                <span class="date">May 27, 2017 at 2:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-400606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, line 101 lstm_model.predict(train_reshaped, batch_size=1) on section Complete LSTM Example.</p>
<p>By the way, I have another question: When the differentiation is applied to the entire dataset, isn&#8217;t it giving information about the test dataset to the model? </p>
<p>Thanks. You&#8217;ve been helping me a lot.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-400606' data-commentid="400606" data-postid="3882" data-belowelement="comment-400606" data-respondelement="respond" data-replyto="Reply to Logan" aria-label='Reply to Logan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401147" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-401147" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 11:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In this case yes, but in practice, we can apply the same method to the test data using data from training step-wise without cheating.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401147' data-commentid="401147" data-postid="3882" data-belowelement="comment-401147" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440728" class="comment odd alt depth-5">

	      	<div id="li-comment-440728" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/42ec142ac0c170ef8bf5ee5f89d0bdc1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/42ec142ac0c170ef8bf5ee5f89d0bdc1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Long</span>
	                <span class="date">June 13, 2018 at 10:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I&#8217;m also having the same question as Logan mentioned above. Line 101<br />
lstm_model.predict(train_reshaped, batch_size=1)<br />
do we need this line.<br />
I comment this line, and I see no difference. Could you explain a bit more why we need this line ?<br />
Thank you for the great tutor.<br />
Best, Long</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-440774" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-440774" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 14, 2018 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440774" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is supposed to seed the state on the training data.</p>
<p>If it does not add value, remove it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400029" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-400029" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3ffdb7d9cf7b2b04b706ea2d4da936e1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3ffdb7d9cf7b2b04b706ea2d4da936e1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brandon</span>
	                <span class="date">May 19, 2017 at 12:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-400029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks so much for this helpful tutorial. Could you clarify which of all the parameters need to be updated to change the lag value? I haven&#8217;t been able to get it to work.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-400029' data-commentid="400029" data-postid="3882" data-belowelement="comment-400029" data-respondelement="respond" data-replyto="Reply to Brandon" aria-label='Reply to Brandon'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400081" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-400081" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 20, 2017 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-400081" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>Change the parameters to the timeseries_to_supervised() function</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-400081' data-commentid="400081" data-postid="3882" data-belowelement="comment-400081" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428974" class="comment odd alt depth-3">

	      	<div id="li-comment-428974" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.etherpros.com' rel='external nofollow ugc' class='url'>John Strong</a></span>
	                <span class="date">February 10, 2018 at 9:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-428974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I had to change the limits of the range() function to get the loop to work for lag values &gt; 1.</p>
<p>def timeseries_to_supervised(data, lag=1):<br />
    df = DataFrame(data)<br />
    columns = [df.shift(i) for i in range(lag, 0, -1)]<br />
    columns.append(df)<br />
    df = concat(columns, axis=1)<br />
    df.fillna(0, inplace=True)<br />
    return df</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-428974' data-commentid="428974" data-postid="3882" data-belowelement="comment-428974" data-respondelement="respond" data-replyto="Reply to John Strong" aria-label='Reply to John Strong'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429042" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-429042" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 11, 2018 at 7:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429042" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429042' data-commentid="429042" data-postid="3882" data-belowelement="comment-429042" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400760" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-400760" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/469421fd2b802081532dd81d56c38da2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/469421fd2b802081532dd81d56c38da2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nirikshith</span>
	                <span class="date">May 29, 2017 at 8:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-400760" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have been following you for quite sometime now. Another great example for time series. I remember trying out sliding window approach in one of the earlier blogs. I am still waiting for you to write up a blog on involving external features(it can be as simple as (is_weekday =0/1 is_weekend=0/1) and see how its implemented.</p>
<p>can you point out where we can add the above external variables in the above example and the format please for these features please. I will try it out. being new to python its very confusing with these reshapes and pre -format required for LSTM s</p>
<p>#aspring data scientist, student</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-400760' data-commentid="400760" data-postid="3882" data-belowelement="comment-400760" data-respondelement="respond" data-replyto="Reply to Nirikshith" aria-label='Reply to Nirikshith'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401184" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401184" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can add them as separate features.</p>
<p>I am working on an example at the moment. I hope to post it when it gives good results.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401184' data-commentid="401184" data-postid="3882" data-belowelement="comment-401184" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-401056" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-401056" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d57ffba71bc818b2102fa81b36980ab6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d57ffba71bc818b2102fa81b36980ab6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Donato</span>
	                <span class="date">June 1, 2017 at 10:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401056" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, nice example! I have your similar problem, but I don&#8217;t know how resolve. I have a two different class to predict, in different files. I have to training my neural network with this different files. The problem is that each file has different number of samples, and I have to use the same LSTM for each file.How I can generalize the number of input for each LSTM??<br />
This is my problem:<br />
<a href="https://drive.google.com/file/d/0B5hOtU0Xa45RUDJJWHVyeHVNQWM/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/0B5hOtU0Xa45RUDJJWHVyeHVNQWM/view?usp=sharing</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401056' data-commentid="401056" data-postid="3882" data-belowelement="comment-401056" data-respondelement="respond" data-replyto="Reply to Donato" aria-label='Reply to Donato'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401235" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401235" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401235" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Maybe this post will help you better understand your prediction problem and frame it as supervised learning:<br />
<a href="https://machinelearningmastery.com/how-to-define-your-machine-learning-problem/" rel="nofollow ugc">http://machinelearningmastery.com/how-to-define-your-machine-learning-problem/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401235' data-commentid="401235" data-postid="3882" data-belowelement="comment-401235" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401575" class="comment odd alt depth-3">

	      	<div id="li-comment-401575" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d57ffba71bc818b2102fa81b36980ab6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d57ffba71bc818b2102fa81b36980ab6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Donato</span>
	                <span class="date">June 5, 2017 at 8:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401575" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the answere, I have understand which is my problem. It depends from the training, because I have a lot of file for training, and when I insert a new file and remake the fit, the previusly information are forgotten. Do you have some examples for train the LSTM with more file? And where each one has the supervisioned learning, apply to time-series and predict information? Thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401575' data-commentid="401575" data-postid="3882" data-belowelement="comment-401575" data-respondelement="respond" data-replyto="Reply to Donato" aria-label='Reply to Donato'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401629" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-401629" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 6, 2017 at 9:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401629" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this example shows how to update an existing model with more data:<br />
<a href="https://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401629' data-commentid="401629" data-postid="3882" data-belowelement="comment-401629" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-401896" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-401896" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1ca0e6d93252317c22bb1686f29a3734?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1ca0e6d93252317c22bb1686f29a3734?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pengyuan Shao</span>
	                <span class="date">June 8, 2017 at 10:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason:<br />
You did a great job!!<br />
Thank you for sharing the great post with us.<br />
I&#8217;m a beginner to machine learning, these days i am busy on doing a project to predict the movement of ship on the sea.<br />
I found this post is very usefull and easy to understand.<br />
I have one question that:<br />
if the number of neurons is the past steps used to predict next step?<br />
Thank you for answer in advance.</p>
<p>Best wishes</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401896' data-commentid="401896" data-postid="3882" data-belowelement="comment-401896" data-respondelement="respond" data-replyto="Reply to Pengyuan Shao" aria-label='Reply to Pengyuan Shao'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401941" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401941" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 9, 2017 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-401941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m not sure what you mean.</p>
<p>The number of neurons defines the size/complexity of the model. The model is used to make predictions.</p>
<p>Perhaps you could reframe your question?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-401941' data-commentid="401941" data-postid="3882" data-belowelement="comment-401941" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402127" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-402127" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/368bff0a67d60ed7ff24404f17d822b8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/368bff0a67d60ed7ff24404f17d822b8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Macarena</span>
	                <span class="date">June 10, 2017 at 7:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402127" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br />
Congrats for the blog, and thanks! It helped me a lot.<br />
I have one question related to the data transformation. I understand the step to make that one input is the last output, so the LSTM can learn and save that info. But I have a different case (classification) and I don&#8217;t know how could I apply this.<br />
In my case my inputs are images (frames from a video) what have a temporal dependency, and my outputs are numbers (0,1 or 2). First I want to pass the images through a CNN network and then take the features and those would be my LSTM input. In that case, it is necessary to process the data as you have done here? I thought the LSTM would save that info by itself, but now I&#8217;m not so sure.</p>
<p>Thank you in advance.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402127' data-commentid="402127" data-postid="3882" data-belowelement="comment-402127" data-respondelement="respond" data-replyto="Reply to Macarena" aria-label='Reply to Macarena'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402176" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-402176" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 11, 2017 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t have an example of working with video data.</p>
<p>Generally, the principles would be the same. As a classification problem, you would need to change the output layer to use one of the log loss activation functions. The input would be from a CNN or similar, e.g. [cnn]->[lstm]->[dense].</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402176' data-commentid="402176" data-postid="3882" data-belowelement="comment-402176" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402559" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-402559" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim Miller</span>
	                <span class="date">June 15, 2017 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402559" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In your ARIMA tutorial you also use the shampoo data set, but measure accuracy by MSE.  Making the change to RMSE:<br />
<code></code><code><br />
rmse = sqrt(mean_squared_error(test, predictions))<br />
print('Test RMSE: %.3f' % rmse)<br />
</code><code></code><br />
I get:<br />
<code></code><code><br />
&gt; Test RMSE: 83.417<br />
</code><code></code><br />
Can we conclude that ARIMA is far better than an LSTM for this problem so far in our research?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402559' data-commentid="402559" data-postid="3882" data-belowelement="comment-402559" data-respondelement="respond" data-replyto="Reply to Kim Miller" aria-label='Reply to Kim Miller'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402588" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-402588" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 15, 2017 at 8:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402588" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, these are demonstrations. Both algorithms would require tuning to present the best version of themselves (&#8220;steel man&#8221; vs &#8220;straw man&#8221;) for model selection.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402588' data-commentid="402588" data-postid="3882" data-belowelement="comment-402588" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402602" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-402602" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim Miller</span>
	                <span class="date">June 15, 2017 at 12:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402602" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are writing the timeseries_to_supervised function to accept a lag:<br />
<code></code><code><br />
def timeseries_to_supervised(data, lag=1):<br />
</code><code></code><br />
Is this feature to essentially the Window Method + reshaping described in your July 21, 2016 tutorial?  </p>
<p>But we don&#8217;t seem to use that parameter, always &#8220;timeseries_to_supervised(diff_values, 1)&#8221;</p>
<p>Using lag values up to around 50 (on the airline data) and changing predict() like so:<br />
<code></code><code><br />
# forecast the entire training dataset to build up state for forecasting<br />
train_reshaped = train_scaled[:, 0:look_back].reshape(len(train_scaled), 1, look_back)<br />
# train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
lstm_model.predict(train_reshaped, batch_size=1)<br />
</code><code></code><br />
seems to make good predictions with very low RMSE on test.  </p>
<p>Am I possibly breaking the model now so it&#8217;s cheating somehow?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402602' data-commentid="402602" data-postid="3882" data-belowelement="comment-402602" data-respondelement="respond" data-replyto="Reply to Kim Miller" aria-label='Reply to Kim Miller'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402679" class="comment even depth-2">

	      	<div id="li-comment-402679" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim Miller</span>
	                <span class="date">June 16, 2017 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402679" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p><code></code><code><br />
look_back = 60<br />
epochs = 15</p>
<p>Month=1, Predicted=321.813110, Expected=315.000000<br />
Month=2, Predicted=310.719757, Expected=301.000000<br />
Month=3, Predicted=363.746643, Expected=356.000000<br />
...<br />
Month=46, Predicted=458.424683, Expected=461.000000<br />
Month=47, Predicted=418.427124, Expected=390.000000<br />
Month=48, Predicted=412.831085, Expected=432.000000<br />
Test RMSE: 18.078<br />
</code><code></code><br />
for test harness<br />
<code></code><code><br />
yhat = y<br />
Test RMSE: 0.000<br />
</code><code></code></p>
<p>It seems there is contamination of training data in the test forecast in the sense that forecast_lstm(model, batch_size, X) is being given X observations, each with 60 historical past observations that overlap into training data.  But so what, right?  That&#8217;s history that training saw, and as it moves into the test data it adds history only seen in the test set.  But that&#8217;s how real life observations work it seems: You always have all of the past to look at.</p>
<p>Finally, you say, &#8220;In this tutorial, we will go with the fixed approach for its simplicity, although, we would expect the dynamic approach to result in better model skill.&#8221;  For a small dataset like we have, a large lag seems as if it gives us a semi-dynamic approach in some ways?</p>
<p>Solid model with a seemingly good RMSE?<br />
Full code: <a href="https://tinyurl.com/y74ypvde" rel="nofollow ugc">http://tinyurl.com/y74ypvde</a><br />
Prediction v. Actual Plot: <a href="https://tinyurl.com/y9ouajdm" rel="nofollow ugc">http://tinyurl.com/y9ouajdm</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402679' data-commentid="402679" data-postid="3882" data-belowelement="comment-402679" data-respondelement="respond" data-replyto="Reply to Kim Miller" aria-label='Reply to Kim Miller'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402684" class="comment odd alt depth-3">

	      	<div id="li-comment-402684" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim Miller</span>
	                <span class="date">June 16, 2017 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402684" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>On the Shampoo dataset:<br />
look_back = 18  (lag)<br />
epochs = 30<br />
Test RMSE: 110.594<br />
Prediction v. Actual Plot: <a href="https://tinyurl.com/ycoy6aes" rel="nofollow ugc">http://tinyurl.com/ycoy6aes</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402684' data-commentid="402684" data-postid="3882" data-belowelement="comment-402684" data-respondelement="respond" data-replyto="Reply to Kim Miller" aria-label='Reply to Kim Miller'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402710" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-402710" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 16, 2017 at 8:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very sharp!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402710' data-commentid="402710" data-postid="3882" data-belowelement="comment-402710" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402708" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-402708" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 16, 2017 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice.</p>
<p>Hmmm, I believe by dynamic I was referring to updating the model with new data.</p>
<p>If you have the resources, I would recommend exploring whether updating the model as new obs come in effects model skill. I expect it will. I have an example here:<br />
<a href="https://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402708' data-commentid="402708" data-postid="3882" data-belowelement="comment-402708" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402618" class="comment even thread-even depth-1">

	      	<div id="li-comment-402618" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3ec68041892c0b3090eb9dd9e68a5cdb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3ec68041892c0b3090eb9dd9e68a5cdb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pedro</span>
	                <span class="date">June 15, 2017 at 5:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402618" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>You&#8217;re doing a great job helping people to learn how to apply machine learning. One week ago, I didn&#8217;t know anything about time series, but now I&#8217;m able to play a little bit with it. Thanks you!</p>
<p>Regarding this post, I&#8217;ve a doubt. When we say</p>
<p>&#8216;To make the experiment fair, the scaling coefficients (min and max) values must be calculated on the training dataset and applied to scale the test dataset and any forecasts. This is to avoid contaminating the experiment with knowledge from the test dataset, which might give the model a small edge.&#8217;</p>
<p>shouldn&#8217;t we do </p>
<p>scaler = scaler.fit(X[:-12])</p>
<p>instead of</p>
<p>scaler = scaler.fit(X) ?</p>
<p>If we use X we are using data from the test set, no?</p>
<p>Thanks for your attention and keep up with the good work!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402618' data-commentid="402618" data-postid="3882" data-belowelement="comment-402618" data-respondelement="respond" data-replyto="Reply to Pedro" aria-label='Reply to Pedro'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402690" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-402690" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 16, 2017 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-402690" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct. Ideally, we would use domain knowledge to estimate the expected min/max of values that could ever be observed.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-402690' data-commentid="402690" data-postid="3882" data-belowelement="comment-402690" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-403194" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-403194" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">June 20, 2017 at 6:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-403194" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>After using the robust code (last one) I got theses results</p>
<p>1) Test RMSE: 180.438<br />
2) Test RMSE: 110.352<br />
3) Test RMSE: 119.655<br />
4) Test RMSE: 170.720<br />
5) Test RMSE: 211.877<br />
6) Test RMSE: 101.453<br />
7) Test RMSE: 105.532<br />
8) Test RMSE: 149.351<br />
9) Test RMSE: 88.118<br />
10) Test RMSE: 138.013<br />
11) Test RMSE: 265.045<br />
12) Test RMSE: 135.861<br />
13) Test RMSE: 167.766  &#8230; (rest is omitted, it was taking too long).<br />
Being a beginner in machine learning and using your tutorial to learn about it could you tell me if theses results are normal (being so different from what you have) while everything before was ok. If theses are not, could you tell my what could be the reason of such difference?</p>
<p>Thank you for your attention and please do continue making tutorial like that, it&#8217;s really helpful!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-403194' data-commentid="403194" data-postid="3882" data-belowelement="comment-403194" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403261" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-403261" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 21, 2017 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-403261" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Eric, see this post to better understand the stochastic nature of neural network algorithms:<br />
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow ugc">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<p>See this post for more details on how to develop a robust estimate of model skill:<br />
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow ugc">http://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>See this post on how to fix the random number seed:<br />
<a href="https://machinelearningmastery.com/reproducible-results-neural-networks-keras/" rel="nofollow ugc">http://machinelearningmastery.com/reproducible-results-neural-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-403261' data-commentid="403261" data-postid="3882" data-belowelement="comment-403261" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403291" class="comment even depth-3">

	      	<div id="li-comment-403291" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">June 21, 2017 at 1:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-403291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see, thank you very much for the links and solutions!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-403291' data-commentid="403291" data-postid="3882" data-belowelement="comment-403291" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403363" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-403363" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 22, 2017 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-403363" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-403363' data-commentid="403363" data-postid="3882" data-belowelement="comment-403363" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403566" class="comment even depth-5">

	      	<div id="li-comment-403566" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">June 23, 2017 at 5:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-403566" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>After reading the links what I understood was:<br />
&#8211; It&#8217;s pretty hard (impossible) to always get the same result due to a lot of randomness that can come from a lot of thing.<br />
&#8211; Only by repeating the operation a lot (like you did on last example, with 30 example (but doing it like 100 would give a better idea?)) can help you to determine how much result can be different and find a range of &#8220;acceptable one&#8221;?<br />
&#8211; Seeding the random number generator can help.</p>
<p>So to continue my project I thought about seed the random number generator like you explained. Like here, repeat the process 30 time (since I have a server I can let it do it overnight and go for 100) and determine the average and decide of a range.</p>
<p>Does it seem ok to begin with?<br />
Am I lacking something?</p>
<p>Thank you for your attention and for the help you provide to everyone.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-403638" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-403638" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 24, 2017 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-403638" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post on how to estimate the number of repeats:<br />
<a href="https://machinelearningmastery.com/estimate-number-experiment-repeats-stochastic-machine-learning-algorithms/" rel="nofollow ugc">http://machinelearningmastery.com/estimate-number-experiment-repeats-stochastic-machine-learning-algorithms/</a></p>
<p>I would not recommend fixing the random number seed for experimental work. Your results will misleading.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404355" class="comment even thread-even depth-1">

	      	<div id="li-comment-404355" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b334674fc91705160eb6d88be41ae562?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b334674fc91705160eb6d88be41ae562?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhineshkumar</span>
	                <span class="date">June 30, 2017 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-404355" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thank you so much for the tutorial.</p>
<p>I have few doubts though.</p>
<p>1. I am working on a problem where the autocorrelation plot of the detrended data show me that the value at time t is significantly correlated to around past 100 values in the series. Is it ideal to take the batch size of 100 to model the series?</p>
<p>2. You mentioned that less than 5 memory units is sufficient for this example. Can you please give me some idea on how to choose the number of memory units for a particular problem like the above? On what other factors does this number depend on? </p>
<p>Kindly clarify.<br />
Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-404355' data-commentid="404355" data-postid="3882" data-belowelement="comment-404355" data-respondelement="respond" data-replyto="Reply to Dhineshkumar" aria-label='Reply to Dhineshkumar'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404414" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-404414" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 1, 2017 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-404414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try passing in 100-200 time steps and see how you go.</p>
<p>Systematically test a suite of different memory units to see what works best.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-404414' data-commentid="404414" data-postid="3882" data-belowelement="comment-404414" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404441" class="comment even depth-3">

	      	<div id="li-comment-404441" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b334674fc91705160eb6d88be41ae562?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b334674fc91705160eb6d88be41ae562?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhineshkumar</span>
	                <span class="date">July 1, 2017 at 2:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-404441" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-404441' data-commentid="404441" data-postid="3882" data-belowelement="comment-404441" data-respondelement="respond" data-replyto="Reply to Dhineshkumar" aria-label='Reply to Dhineshkumar'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404501" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-404501" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 2, 2017 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-404501" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-404501' data-commentid="404501" data-postid="3882" data-belowelement="comment-404501" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404692" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-404692" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/45ce7b01a138309f339de67a480ca4ce?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/45ce7b01a138309f339de67a480ca4ce?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sophie</span>
	                <span class="date">July 4, 2017 at 3:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-404692" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason! Thanks a lot for this tutorial, it really helped.</p>
<p>I used this tutorial as is for predicting the cost of an item which is of the the range of a dollar and few cents. </p>
<p>My dataset has 262 rows, i.e 0 to 261.</p>
<p>When I run the model, the graph captures even the most intricate trends beautifully, BUT there seems to be a lag of 1 time step in the predicted data. </p>
<p>The predicted values of this month almost exactly matches the expected value of the previous month. And this trend is followed throughout.</p>
<p>The indexing is the only thing I&#8217;ve changed,<br />
to</p>
<p>train, test = supervised_values[0:200], supervised_values[200:]<br />
rmse = sqrt(mean_squared_error(raw_values[200:], predictions))<br />
pyplot.plot(raw_values[200:])</p>
<p>are the only lines of code I&#8217;ve really changed</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-404692' data-commentid="404692" data-postid="3882" data-belowelement="comment-404692" data-respondelement="respond" data-replyto="Reply to Sophie" aria-label='Reply to Sophie'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404879" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-404879" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 6, 2017 at 10:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-404879" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider starting with a simpler linear model:<br />
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow ugc">http://machinelearningmastery.com/start-here/#timeseries</a></p>
<p>I do not believe LSTMs are the best or first choice for autoregression models:<br />
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-404879' data-commentid="404879" data-postid="3882" data-belowelement="comment-404879" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-422423" class="comment even depth-2">

	      	<div id="li-comment-422423" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/749e7051b2117c5d61e19b10687a3c9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/749e7051b2117c5d61e19b10687a3c9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">vijay</span>
	                <span class="date">December 7, 2017 at 8:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-422423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think I&#8217;m facing the same issue. Were you able to solve the issue?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-422423' data-commentid="422423" data-postid="3882" data-belowelement="comment-422423" data-respondelement="respond" data-replyto="Reply to vijay" aria-label='Reply to vijay'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405168" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-405168" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/61f9f7daef721495bd9665f5fdc4cc7c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/61f9f7daef721495bd9665f5fdc4cc7c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Viorel Emilian Teodorescu</span>
	                <span class="date">July 9, 2017 at 2:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405168" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason </p>
<p>Doesn&#8217;t LSTM have a squashing gate at input? With outputs in between (-1, 1)? Then why do we need to prepare the input data to be between (-1, 1) if the first input gate will do this for us? </p>
<p>Am I missing something?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405168' data-commentid="405168" data-postid="3882" data-belowelement="comment-405168" data-respondelement="respond" data-replyto="Reply to Viorel Emilian Teodorescu" aria-label='Reply to Viorel Emilian Teodorescu'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405269" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-405269" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 9, 2017 at 10:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405269" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can rescale input to [0,1]</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405269' data-commentid="405269" data-postid="3882" data-belowelement="comment-405269" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405177" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-405177" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hans</span>
	                <span class="date">July 9, 2017 at 2:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Considering  </p>
<p>unseenPredict = lstm_model.predict(X)</p>
<p>&#8230;how do we structure X to get a one step forward prediction of unseen data?</p>
<p>Or can we change some offsets in script &#8220;Complete LSTM Example&#8221; to get the same effect, and if so how?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405177' data-commentid="405177" data-postid="3882" data-belowelement="comment-405177" data-respondelement="respond" data-replyto="Reply to Hans" aria-label='Reply to Hans'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405406" class="comment even thread-even depth-1">

	      	<div id="li-comment-405406" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/07fff31ec995bbf4b7178a31e5bc45a4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/07fff31ec995bbf4b7178a31e5bc45a4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Paba</span>
	                <span class="date">July 10, 2017 at 8:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405406" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks for the excellent tutorial. I tried to modify the above code to include multiple timesteps and multiple lags in the model. I run give these parameters as input and paralleling run the script for different configurations to select the most accurate model. What do you think of the modifications I have done to the following functions? I am especially concerned about the time_steps included in the model, is that correct? </p>
<p>def timeseries_to_supervised(data, lag=1, time_steps=0):<br />
	df = DataFrame(data)<br />
	columns = [df.shift(i) for i in range(1, lag+1)]<br />
	#considers the number of time_steps, t, involved and<br />
	#add next t x columns next to each x columnn<br />
	#question?? if time_steps = 3, does that mean y should start from y_4 and<br />
	#we trim the last 3 values from the dataset?<br />
	if time_steps &gt; 0 :<br />
		columns_df = concat(columns,axis=1)<br />
		#note that I have multipled i by -1 to perform left shift rather than right shift<br />
		timestep_columns = [columns_df.shift(i*-1) for i in range(1, time_steps+1)]<br />
		timestep_columns_df =concat(timestep_columns, axis=1)<br />
		columns.append(timestep_columns_df)<br />
	columns.append(df)<br />
	df = concat(columns, axis=1)<br />
	df.fillna(0, inplace=True)<br />
	return df</p>
<p>def fit_lstm(train, batch_size, nb_epoch, neurons, lag, time_steps):<br />
	X, y = train[:, 0:-1], train[:, -1]<br />
	X = X.reshape(X.shape[0], time_steps+1, lag)<br />
	model = Sequential()<br />
	model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1] , X.shape[2]), stateful=True, return_sequences=True))<br />
	model.add(LSTM(neurons, stateful=True))<br />
	model.add(Dense(1))<br />
	model.compile(loss=&#8217;mean_squared_error&#8217; optimizer=&#8217;adam&#8217;)<br />
	model.summary()<br />
	for i in range(nb_epoch):<br />
		model.fit(X, y, epochs=1, batch_size=batch_size, verbose=1, shuffle=False)<br />
		model.reset_states()<br />
	return model</p>
<p>def forecast_lstm(model, batch_size, X, lag,time_steps):</p>
<p>	X = X.reshape(1,time_steps+1,lag)<br />
	pad = np.zeros(shape=(batch_size-1, time_steps+1, lag))<br />
	padded = np.vstack((X, pad))<br />
	yhat = model.predict(padded, batch_size=batch_size)<br />
	return yhat[0,0]</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405406' data-commentid="405406" data-postid="3882" data-belowelement="comment-405406" data-respondelement="respond" data-replyto="Reply to Paba" aria-label='Reply to Paba'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405481" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-405481" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 11, 2017 at 10:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great work!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405481' data-commentid="405481" data-postid="3882" data-belowelement="comment-405481" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405708" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-405708" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim Miller</span>
	                <span class="date">July 13, 2017 at 9:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to extend this idea to several features x the lag values for each x time observations.  Does it seem reasonable to give MinMaxScaler that 3D object?  How does the y truth fit in what I give MinMaxScaler, since it&#8217;s only 2D?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405708' data-commentid="405708" data-postid="3882" data-belowelement="comment-405708" data-respondelement="respond" data-replyto="Reply to Kim Miller" aria-label='Reply to Kim Miller'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405732" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-405732" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 13, 2017 at 10:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405732" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, I would recommend scaling each series separately.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405732' data-commentid="405732" data-postid="3882" data-belowelement="comment-405732" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405740" class="comment even depth-3">

	      	<div id="li-comment-405740" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim Miller</span>
	                <span class="date">July 13, 2017 at 11:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405740" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Above you seem to scale y along with X. But with multiple features, the rest of which are not just a time-shifted copy of y, I assume we could fit y_train by itself before transforming y_train and y_val?  Then that&#8217;s actually the only scaler object we need to save for later inversion?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405740' data-commentid="405740" data-postid="3882" data-belowelement="comment-405740" data-respondelement="respond" data-replyto="Reply to Kim Miller" aria-label='Reply to Kim Miller'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405761" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-405761" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 13, 2017 at 4:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405761" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend scaling each series before any shifting of the series to make it a supervised learning problem.</p>
<p>I hope that answers your question, please shout if I misunderstood.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405761' data-commentid="405761" data-postid="3882" data-belowelement="comment-405761" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405806" class="comment even depth-5">

	      	<div id="li-comment-405806" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3423a20950bd9efcc25a2e7657ff990c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kim Miller</span>
	                <span class="date">July 14, 2017 at 2:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405806" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think the words &#8220;each series separately&#8221; threw me.  I assume we can still scale all incoming values (all X&#8217;s and the time series that will later become y and shifted, one of the X&#8217;s) using a single scaler object. Then we create the lag values from scaled values.  Finally, that single scaler object is used to invert y predictions.  I have that right?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405849" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-405849" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 14, 2017 at 8:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Each series being a different &#8220;feature&#8221; or &#8220;column&#8221; or &#8220;time series&#8221; or whatever we call it.</p>
<p>The coefficients (min/max or mean/stdev) used in the scaling of each series will need to be kept to reverse the operation on predictions and apply the operation to input data later. You can save the coefficients or the objects that wrap them.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405755" class="comment even thread-even depth-1">

	      	<div id="li-comment-405755" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a9d36ab805de54553e45a8dc909708d5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a9d36ab805de54553e45a8dc909708d5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sasha</span>
	                <span class="date">July 13, 2017 at 4:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405755" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, great tutorial, thank you!</p>
<p>A question: why do you loop through epochs instead of just setting an appropriate number of epochs within fit() function? Would&#8217;t it give the same result and be neater?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405755' data-commentid="405755" data-postid="3882" data-belowelement="comment-405755" data-respondelement="respond" data-replyto="Reply to Sasha" aria-label='Reply to Sasha'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405764" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-405764" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 13, 2017 at 5:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405764" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So that I can manually manage the resetting of the internal state of the network.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405764' data-commentid="405764" data-postid="3882" data-belowelement="comment-405764" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405767" class="comment even depth-3">

	      	<div id="li-comment-405767" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a9d36ab805de54553e45a8dc909708d5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a9d36ab805de54553e45a8dc909708d5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sasha</span>
	                <span class="date">July 13, 2017 at 5:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405767" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ah, I see, it has to do with &#8220;stateful&#8221; definition being different in keras, it&#8217;s well explained here: <a href="https://philipperemy.github.io/keras-stateful-lstm/" rel="nofollow ugc">http://philipperemy.github.io/keras-stateful-lstm/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405767' data-commentid="405767" data-postid="3882" data-belowelement="comment-405767" data-respondelement="respond" data-replyto="Reply to Sasha" aria-label='Reply to Sasha'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405773" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-405773" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a33cc4eda404a85e75841e76c8348302?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a33cc4eda404a85e75841e76c8348302?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">kotb</span>
	                <span class="date">July 13, 2017 at 6:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405773" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, DR jason</p>
<p>thank you very much for this tutorial.</p>
<p>I want to have multiple time steps , but i don&#8217;t know how to modify function &#8220;timeseries_to_supervised()&#8221;.<br />
I found another post of you talking about this , but you use function &#8220;create_dataset()&#8221;<br />
i modify this function as follow:</p>
<p>def create_dataset(dataset, look_back=1):<br />
	dataset = np.insert(dataset,[0]*look_back,0)<br />
	dataX, dataY = [], []<br />
	for i in range(len(dataset)-look_back):<br />
		a = dataset[i:(i+look_back)]<br />
		dataX.append(a)<br />
		dataY.append(dataset[i + look_back])<br />
	dataY=numpy.array(dataY)<br />
	dataY = np.reshape(dataY,(dataY.shape[0],1))<br />
	dataset = np.concatenate((dataX,dataY),axis=1)<br />
	return dataset</p>
<p>please, check my modification , is it right OR what?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405773' data-commentid="405773" data-postid="3882" data-belowelement="comment-405773" data-respondelement="respond" data-replyto="Reply to kotb" aria-label='Reply to kotb'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405842" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-405842" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 14, 2017 at 8:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-405842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br />
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow ugc">http://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-405842' data-commentid="405842" data-postid="3882" data-belowelement="comment-405842" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406596" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-406596" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">July 20, 2017 at 2:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-406596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Sorry if it seem stupid but there is a part that I don&#8217;t understand.</p>
<p>To predict you use: &#8220;yhat = model.predict(X, batch_size=batch_size)&#8221;<br />
But as we see X is :<br />
train, test = supervised_values[0:-12], supervised_values[-12:]<br />
scaler, train_scaled, test_scaled = scale(train, test)<br />
yhat = forecast_lstm(lstm_model, 1, X)</p>
<p>So X is the 12 value (after being passed in the scale function) that we want to predict. Why are we using them since in normal case we wouldn&#8217;t know theirs values.</p>
<p>Once again really thank you for your tutorial, really helped me in my training on machine learning.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-406596' data-commentid="406596" data-postid="3882" data-belowelement="comment-406596" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406707" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-406707" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 21, 2017 at 9:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-406707" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the general case, you can pass in whatever you like in order to make a prediction.</p>
<p>For example, if your model was defined by taking 6 days of values and predicting the next day and you want to predict tomorrow, pass in the  values for today and 5 days prior. </p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-406707' data-commentid="406707" data-postid="3882" data-belowelement="comment-406707" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406723" class="comment odd alt depth-3">

	      	<div id="li-comment-406723" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">July 21, 2017 at 10:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-406723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think it does help me. In my case I have values for each minute and I have to predict the next week (so more or less 10K of prediction).<br />
I have data from the last year so there isn&#8217;t any problem with my training, just wondered what I should do at the prediction part (so I can just instead of feeding it test_scaled send him my training set again?)<br />
Thank you for your help and quick reply!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-406723' data-commentid="406723" data-postid="3882" data-belowelement="comment-406723" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406821" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-406821" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 22, 2017 at 8:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-406821" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, if your model is setup to predict given some fixed set of lags, you must provide those lags to predict beyond the end of the dataset. These may be part of your training dataset.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-406821' data-commentid="406821" data-postid="3882" data-belowelement="comment-406821" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407145" class="comment odd alt depth-5">

	      	<div id="li-comment-407145" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">July 24, 2017 at 5:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407145" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t think it&#8217;s in my training dataset, for this part I&#8217;m pretty much doing it like you (the lag appearing when turning a sequence to a supervised learning problem). I&#8217;m pretty much feeding my model like you do. The problem for me being to know what to feed it when calling the predict command. Sending it &#8220;train_scaled&#8221; was a bad idea (got poor result, predicting huge value when it should predict low and predicting low instead of predicting high). I&#8217;m working on it but every hint is accepted. Once again thank you and sorry for being a bit slow at learning/understanding.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407221" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-407221" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 25, 2017 at 9:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407221" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The argument to the predict() function is the same as the argument to the fit() function. </p>
<p>The data must be scaled the same and have the same shape, although the number of samples may vary, e.g. you may have just one sample.</p>
<p>Obviously, you don&#8217;t need to make predictions for the training data, so the data passed to predict will be the input required to make the prediction you require. This really depends on the framing of your problem/model.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407240" class="comment odd alt depth-5">

	      	<div id="li-comment-407240" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">July 25, 2017 at 12:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407240" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank your for your quick reply! I think I&#8217;m understanding it better but I have some part I have trouble to understand.</p>
<p>The input is X right?<br />
If I follow your tutorial on input/output (<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow ugc">http://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a>) and I take my case as an example (the database register the value each 3 minute and we want to predict the next value (so to begin for example it would be 12:24:00)):<br />
Date,congestion<br />
2016-07-08 12:12:00,92<br />
2016-07-08 12:15:00,80<br />
2016-07-08 12:18:00,92<br />
2016-07-08 12:21:00,86</p>
<p>This is (part of) my training data, when turning it into supervised training data (and shifting) I get:<br />
X, y<br />
?, 92<br />
92, 80<br />
80, 92<br />
92, 86<br />
86, ?</p>
<p>The problem is that I don&#8217;t know X for predicting, I only know the X I use for my training (train_scaled) and the one used to compare my results (test_scaled).</p>
<p>What is the input I should feed it? I can&#8217;t feed it my test_scaled since in real situation I would have no idea of what it would be.</p>
<p>Sorry if my question seem stupid and thank you for taking time to explain it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407312" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-407312" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 26, 2017 at 7:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407312" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends how you have framed your model.</p>
<p>If the input (X) is the observation at t-1 to predict t, then you input the last observation to predict the next time step.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407362" class="comment odd alt depth-5">

	      	<div id="li-comment-407362" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">July 26, 2017 at 11:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407362" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is, each of my input X is the observation at t-1 (pretty similar to the shampoo case used in the tutorial).</p>
<p>Thank you for your answer, you answered my question, I shouldn&#8217;t have any problem now!</p>
<p>Thanks for the tutorial too, they really helped me!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407388" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-407388" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 26, 2017 at 4:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407388" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear that.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407411" class="comment odd alt depth-5">

	      	<div id="li-comment-407411" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">July 26, 2017 at 6:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407411" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just to be sure that I didn&#8217;t made any mistake in my reasoning, if I take my example from before:<br />
X, y<br />
?, 92        / T-3<br />
92, 80      / T-2<br />
80, 92      / T-1<br />
92, 86      / T<br />
86, ?        / T+1</p>
<p>to predict the next step (T+1) I have to use &#8220;yhat = model.predict(X, , batch_size=batch_size)&#8221; where X is 86 (after scaling/reshaping). Right?<br />
Then I&#8217;ll get the value predicted for T+1 (that I have to send to invert_scale and difference to get a readable value).<br />
If I want to predict farther then I continue (sending the scaled/reshaped value predicted at T+1 to get T+2 and then until I predict as far as wanted).</p>
<p>Thanks for your time and answers!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-407479" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-407479" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 27, 2017 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407479" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-408491" class="comment odd alt depth-5">

	      	<div id="li-comment-408491" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 4, 2017 at 12:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408491" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason with your help I managed to predict value of each minute of the next week. I had 2 question though:<br />
First: I removed the code for testing sets (since I wouldn&#8217;t have it in reality), the only thing I have are the testing set in the excel file (the last 10000 lines)<br />
When using this code (to train):<br />
            # transform data to be stationary<br />
            raw_values = data.values<br />
            diff_values = difference(raw_values, 1)</p>
<p>            # transform data to be supervised learning<br />
            supervised = timeseries_to_supervised(diff_values, 1)<br />
            supervised_values = supervised.values</p>
<p>            # split data into train and test-sets<br />
            train = supervised_values[:-10000]</p>
<p>            # transform the scale of the data<br />
            scaler, train_scaled = scale(train)</p>
<p>and this one (to predict):<br />
            # forecast the entire training dataset to build up state for forecasting<br />
            train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
            lstm_model.predict(train_reshaped)</p>
<p>            # walk-forward validation on the test data<br />
            predictions = list()<br />
            predictionFeeder = list() #Used to feed the model with the value of T-1<br />
            X, y = train_scaled[0, 0:-1], train_scaled[0, -1]<br />
            predictionFeeder.append(X) #Give the last value of training</p>
<p>            for i in range(0, 10000):<br />
                # make one-step forecast<br />
                yhat = forecast_lstm2(lstm_model, predictionFeeder[i])<br />
                predictionFeeder.append(yhat)<br />
                # invert scaling<br />
                yhat2 = invert_scale(scaler, testa[i + 1], yhat)<br />
                yhat3 = inverse_difference(raw_values, yhat2, 10000 + 1 &#8211; i)<br />
                predictions.append(yhat3)<br />
and train a model (25 epoch) then predict the results I get result that are way too good (RMSE of 2 or less and prediction that have less than 5% of error).<br />
Being used of thing going wrong for no reasons I decide to remove the testing data from the excel (even though it shouldn&#8217;t change anything since I&#8217;m not using them (I&#8217;ve even set the variable to None at first)). Then when I do that the prediction is way less good and have some lag (though, if you remove the lag you still have a good results, just way less better than before).<br />
Why is that?<br />
My 2nd question is about lag, we can see on the prediction that while the shape of both chart (prediction and reality) look alike the prediction is raising/lowering before the reality, do you have any idea to fix it? Do you think changing the lag or timestep would help?</p>
<p>Once again thank you for your help, I don&#8217;t think I would have achieved this much without your tutorials.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-408507" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-408507" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 4, 2017 at 3:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408507" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot debug your code for you.</p>
<p>Perhaps you are accidentally fitting the model on the training and test data then evaluating it on the test (e.g. on data it has seen before).</p>
<p>I would encourage you to evaluate different lag values to see what works best for your problem.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-408514" class="comment odd alt depth-5">

	      	<div id="li-comment-408514" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 4, 2017 at 4:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408514" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Don&#8217;t worry, I wouldn&#8217;t ask you to debug.</p>
<p>Maybe, I don&#8217;t know, I did remove the variable to be sure to never have affected the testing set and using it but since I&#8217;m human I may have made errors.</p>
<p>So changing lag would help me for theses gap between reality and prediction raise. Thank you I&#8217;ll do that.</p>
<p>Thanks for your answer!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406759" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-406759" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4fcb6fed918ad33ff8ddda1c6165874e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4fcb6fed918ad33ff8ddda1c6165874e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Josep</span>
	                <span class="date">July 21, 2017 at 8:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-406759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I buy your books physically(not Ebook)?Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-406759' data-commentid="406759" data-postid="3882" data-belowelement="comment-406759" data-respondelement="respond" data-replyto="Reply to Josep" aria-label='Reply to Josep'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406760" class="comment odd alt depth-2">

	      	<div id="li-comment-406760" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4fcb6fed918ad33ff8ddda1c6165874e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4fcb6fed918ad33ff8ddda1c6165874e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Josep</span>
	                <span class="date">July 21, 2017 at 8:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-406760" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, now I have read that is not possible. Thanks anyway. Your explanations and tutorials are amazing. Congratulations!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-406760' data-commentid="406760" data-postid="3882" data-belowelement="comment-406760" data-respondelement="respond" data-replyto="Reply to Josep" aria-label='Reply to Josep'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406829" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-406829" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 22, 2017 at 8:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-406829" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Josep.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-406829' data-commentid="406829" data-postid="3882" data-belowelement="comment-406829" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-407417" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-407417" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/aee8173c104ff45c32d8536373d36caa?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/aee8173c104ff45c32d8536373d36caa?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pawel</span>
	                <span class="date">July 26, 2017 at 7:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407417" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br />
Thanks for very good tutorial. I have one question/doubt. </p>
<p>in the following part of the code:</p>
<p># invert differencing<br />
	yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)</p>
<p>should not we relay on predicted value instead of already known raw_values? In your example for validation we always refer to the test value(known) while calling inverse difference. But in reality we will have only the predicted values(used as X), and of course known starting point(t=0). Or I missed something?</p>
<p>my proposal:<br />
# invert differencing &#8211; (starting from 2nd loop cycle (1st woul be the starting point (raw_values[-1]) )</p>
<p>yhat = inverse_difference(predictions, yhat, 1)</p>
<p>Thanks in advance<br />
Pawel</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407417' data-commentid="407417" data-postid="3882" data-belowelement="comment-407417" data-respondelement="respond" data-replyto="Reply to Pawel" aria-label='Reply to Pawel'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407481" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-407481" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 27, 2017 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We could, but in this case the known observations are available and not in the future and it is reasonable to use them for the rescaling (inverting).</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407481' data-commentid="407481" data-postid="3882" data-belowelement="comment-407481" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407532" class="comment odd alt depth-3">

	      	<div id="li-comment-407532" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/aee8173c104ff45c32d8536373d36caa?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/aee8173c104ff45c32d8536373d36caa?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pawel</span>
	                <span class="date">July 27, 2017 at 5:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Thanks for explanation, got it now. Cause I train the model used e.g. MAY data (15 seconds samples) and then used that model to predict whole JUNE data. Afterwards I compared predicted data VS data that I got from JUNE, and I have to say that model does not work, after few prediction there is huge &#8220;off sync&#8221;, </p>
<p>In the validation phase as described in your case I got RMSE 0.11 so not bad, but in reality when you use predicted value(t-1) to predict next (t) value there is a problem.</p>
<p>Do you know how to improve the model? should I use multiple step forecats, or lag features, input time steps?</p>
<p>Thanks a lot.<br />
Pawel</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407532' data-commentid="407532" data-postid="3882" data-belowelement="comment-407532" data-respondelement="respond" data-replyto="Reply to Pawel" aria-label='Reply to Pawel'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407614" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-407614" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 28, 2017 at 8:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend braining storming, then try everything you can think of.</p>
<p>I have a good list here:<br />
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>Also, compare results to well-tuned MLPs with a window.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407614' data-commentid="407614" data-postid="3882" data-belowelement="comment-407614" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-407542" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-407542" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8bf688ba7ac4371539003fc279f383db?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8bf688ba7ac4371539003fc279f383db?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Surya</span>
	                <span class="date">July 27, 2017 at 6:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407542" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, I am not following one point in your post. You wanted to train a state-full LSTM but reset_states() is executed after every epoch. That means, the states from previous batch are not used in the current batch. How does it make the network state-full?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407542' data-commentid="407542" data-postid="3882" data-belowelement="comment-407542" data-respondelement="respond" data-replyto="Reply to Surya" aria-label='Reply to Surya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407617" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-407617" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 28, 2017 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-407617" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>State is maintained between the samples within one epoch.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-407617' data-commentid="407617" data-postid="3882" data-belowelement="comment-407617" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408168" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-408168" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6509b79ca243d502a1b47fd70be8739f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6509b79ca243d502a1b47fd70be8739f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Niklas</span>
	                <span class="date">August 2, 2017 at 12:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408168" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>thanks for the great tutorial. I have one question. Wouldn&#8217;t it be better to use a callback for resetting the states? This would enable you to also use for example an EarlyStopping Monitor while training, here is what I changed:<br />
class resetStates(Callback):<br />
    def on_epoch_end(self, epoch, logs=None):<br />
        self.model.reset_states()</p>
<p>model.fit(X, y, epochs=nb_epoch, batch_size=batch_size, verbose=1, shuffle=False, callbacks=[resetStates(),EarlyStopping(monitor=&#8217;loss&#8217;, patience=5, verbose=1, mode=&#8217;min&#8217;)])</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408168' data-commentid="408168" data-postid="3882" data-belowelement="comment-408168" data-respondelement="respond" data-replyto="Reply to Niklas" aria-label='Reply to Niklas'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408224" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-408224" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 2, 2017 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408224" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, that is a cleaner implementation for those problems that need to reset state at the end of each epoch.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408224' data-commentid="408224" data-postid="3882" data-belowelement="comment-408224" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408668" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-408668" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d5f54ea67c5cceb9c8666ec3dffe5dc4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5f54ea67c5cceb9c8666ec3dffe5dc4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bharath</span>
	                <span class="date">August 6, 2017 at 2:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408668" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, can we extend this for anomaly detection techniques ?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408668' data-commentid="408668" data-postid="3882" data-belowelement="comment-408668" data-respondelement="respond" data-replyto="Reply to Bharath" aria-label='Reply to Bharath'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408695" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-408695" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 6, 2017 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408695" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps, I have not used LSTMs for anomaly detection, I cannot give you good advice.</p>
<p>Perhaps you would frame it as sequence classification?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408695' data-commentid="408695" data-postid="3882" data-belowelement="comment-408695" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408822" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-408822" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c464355f823136dce154ef525478a0a1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c464355f823136dce154ef525478a0a1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Daniel Ruiz</span>
	                <span class="date">August 7, 2017 at 1:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408822" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>In the persistence model plot there is a one time interval lag.  When making single step predictions, is it possible to overcome this issue?  What is causing this to happen?  It seems like the model places a huge weight on time interval x[t-1].<br />
Here is an example of the dataset I am analyzing:</p>
<p>iteration:  969<br />
Month=970, Predicted=-7.344685, Expected=280.000000<br />
iteration:  970<br />
Month=971, Predicted=73.259611, Expected=212.000000<br />
iteration:  971<br />
Month=972, Predicted=137.053028, Expected=0.000000</p>
<p>Expected should be 280 and 212 (high magnitudes), and the model captures this more or less with 73 and 137, but this is one time interval behind.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408822' data-commentid="408822" data-postid="3882" data-belowelement="comment-408822" data-respondelement="respond" data-replyto="Reply to Daniel Ruiz" aria-label='Reply to Daniel Ruiz'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408894" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-408894" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 8, 2017 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>LSTMs are not great at autoregression problems and often converge to a persistence type model.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408894' data-commentid="408894" data-postid="3882" data-belowelement="comment-408894" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408921" class="comment odd alt depth-3">

	      	<div id="li-comment-408921" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c464355f823136dce154ef525478a0a1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c464355f823136dce154ef525478a0a1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Daniel Ruiz</span>
	                <span class="date">August 8, 2017 at 8:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408921" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok thanks.  What model would be a good alternative to capture this issue?  I ran into the same problem with ARIMA.  It could just be a difficult dataset to predict.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408921' data-commentid="408921" data-postid="3882" data-belowelement="comment-408921" data-respondelement="respond" data-replyto="Reply to Daniel Ruiz" aria-label='Reply to Daniel Ruiz'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408952" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-408952" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 8, 2017 at 5:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-408952" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend starting with a well-tuned MLP + Window and see if anything can do better.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-408952' data-commentid="408952" data-postid="3882" data-belowelement="comment-408952" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409066" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-409066" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 9, 2017 at 11:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409066" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks to you I managed to get a working LSTM network who seem to have a good accuracy (and so a low RMSE)</p>
<p>But I&#8217;ve got a problem, do you know what could be the cause of extreme delay between reality values and predictions (my predictions have the same shape as the reality but increase/decrease way before reality)? </p>
<p>Best regards and please continue what you are doing, it&#8217;s really useful.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409066' data-commentid="409066" data-postid="3882" data-belowelement="comment-409066" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409140" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409140" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 10, 2017 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409140" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Eric, it might be a bug in the way you are evaluating the model.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409140' data-commentid="409140" data-postid="3882" data-belowelement="comment-409140" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409173" class="comment odd alt depth-3">

	      	<div id="li-comment-409173" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 10, 2017 at 10:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409173" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It might be the case, I had to make some changes to the prediction system to use the last predicted value, I may have missed something at this moment. (Also I have to use Tflearn instead of Tensorflow but it shouldn&#8217;t be a problem since Tflearn is a more transparent way to use tensorflow).</p>
<p>Thank you for your answer!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409173' data-commentid="409173" data-postid="3882" data-belowelement="comment-409173" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409212" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-409212" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 10, 2017 at 4:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409212" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hang in there Eric!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409212' data-commentid="409212" data-postid="3882" data-belowelement="comment-409212" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409219" class="comment odd alt depth-5">

	      	<div id="li-comment-409219" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 10, 2017 at 5:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409219" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>
<p>Well.. I have a gap of 151 (reference to pokemon?).</p>
<p>Just to try I removed theses 151 values from my training set, I now have no gap of values (and frankly, the accuracy seem good for a 15 epoch training). I know that this is no way a fix but make me wonder where did I fail..</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-409232" class="comment even depth-5">

	      	<div id="li-comment-409232" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 10, 2017 at 7:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409232" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could it be that while my training set is on 400K of value my prediction start 151 value before the end (so predicting the value for 399849) of the training set (which is strange since the information from training tell me that I&#8217;m training on the 400K of data).<br />
It would mean that my machine is trying to predict some point of time used for training.<br />
Or it would mean that the 151 last data weren&#8217;t used at all for training (I tried to reduce the number of data but it&#8217;s the same problem).</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-409271" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-409271" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 11, 2017 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The algorithm is trained sample by sample, batch by batch, epoch by epoch. The last sample is what is key.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-409290" class="comment even depth-5">

	      	<div id="li-comment-409290" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 11, 2017 at 12:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409290" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply.<br />
When I think about it my prediction is in advance compared to the reality.<br />
So my model start his prediction not where I finished my training but after (which is strange since my training end where my testing begin and that each input are a value (and each line correspond to a minute like the the line of shampoo data sets correspond to month)).<br />
I must have made a mistake somewhere.<br />
Thanks for you answer I think I&#8217;m on something!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-409359" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-409359" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 12, 2017 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hang in there!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409070" class="comment even thread-even depth-1">

	      	<div id="li-comment-409070" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a05550103b834eca1e15b9365f36b136?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a05550103b834eca1e15b9365f36b136?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stone</span>
	                <span class="date">August 9, 2017 at 12:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409070" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One thing I don&#8217;t understand in these models is, how can I predict future. </p>
<p>Say, I have trained my model and let&#8217;s say we&#8217;re living August 8, 2017. Now model.predict() seems to require some test samples to predict anything, in this case values from test_scaled. So what do I give it when I want to get a prediction for August 9, 2017, which we don&#8217;t know yet? So I want to know yhat(t+1). Can I ask the model to give me forecasts for the next 5 days?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409070' data-commentid="409070" data-postid="3882" data-belowelement="comment-409070" data-respondelement="respond" data-replyto="Reply to Stone" aria-label='Reply to Stone'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409078" class="comment odd alt depth-2">

	      	<div id="li-comment-409078" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">August 9, 2017 at 2:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I may be wrong but in my case I trained my model on the data I had (let&#8217;s say one year, until August 8, 2017) and to predict the value T you send the value T-1 (so in this case the value of August 8 2017), you&#8217;ll get the value of August 9.<br />
Then if you want August 10 (T+1) you send the value of August 9 (T). But this code here show a one step forecast implementation. Maybe if you want to predict more you should look for multi step forecasting? I&#8217;m think there is some example of it on this website.</p>
<p>Jason would give you a better answer I think.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409078' data-commentid="409078" data-postid="3882" data-belowelement="comment-409078" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409147" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-409147" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 10, 2017 at 6:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice one Eric!</p>
<p>Yes, I&#8217;ll add, if the model was trained to predict one day from the prior day as input, then when finalized, the model will need the observation from the prior day in order to predict the next day. </p>
<p>It all comes down to how you frame the prediction problem that determines what the inputs you need.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409147' data-commentid="409147" data-postid="3882" data-belowelement="comment-409147" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409143" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-409143" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 10, 2017 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409143" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you would like to predict one day, the model needs to be trained to predict one day. </p>
<p>You have to decide what the model will take as input in order to make that prediction, e.g. the last month or year of data. This is how the model is trained.</p>
<p>Then, when it&#8217;s trained, you can use it to predict future values using perhaps the last few values from the training data. You can use a model trained to predict one day to predict may days in a recursive manner where predictions become inputs for subsequent predictions. More about that here:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>You can also make multi-step forecasts directly, here is an example:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow ugc">http://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>
<p>Does that make things clearer?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409143' data-commentid="409143" data-postid="3882" data-belowelement="comment-409143" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409175" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-409175" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a05550103b834eca1e15b9365f36b136?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a05550103b834eca1e15b9365f36b136?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stone</span>
	                <span class="date">August 10, 2017 at 11:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409175" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Eric and Jason. That&#8217;s exactly how I&#8217;ve done it, but it seems to me, that the prediction that I get is not one timestep forward (T+1), but it&#8217;s a prediction of T, which doesn&#8217;t make sense. I&#8217;m using close price of a stock as my data. I&#8217;ll have to check again, if it&#8217;s really is making a prediction for the future, as you insist. and I will check the Jason&#8217;s links. </p>
<p>Anyways, thanks Jason for the excellent tutorials! 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409175' data-commentid="409175" data-postid="3882" data-belowelement="comment-409175" data-respondelement="respond" data-replyto="Reply to Stone" aria-label='Reply to Stone'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409180" class="comment odd alt depth-2">

	      	<div id="li-comment-409180" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a05550103b834eca1e15b9365f36b136?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a05550103b834eca1e15b9365f36b136?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stone</span>
	                <span class="date">August 10, 2017 at 12:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409180" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here&#8217;s a sample of the close prices:<br />
2017-05-30    5.660<br />
2017-05-31    5.645<br />
2017-06-01    5.795<br />
2017-06-02    5.830</p>
<p>As a matter of fact, it seems to me that the predicted values lags one time step behind from expected ones.</p>
<p>Day=1, Predicted=5.705567, Expected=5.660000<br />
Day=1, Predicted=5.671651, Expected=5.645000<br />
Day=1, Predicted=5.657278, Expected=5.795000<br />
Day=1, Predicted=5.805318, Expected=5.830000</p>
<p>Here I&#8217;m going forwarding one day at a time and as you see the predicted ones are closer to what was expected one day before than. And anyway, </p>
<p>Let&#8217;s examine the second line:<br />
Day=1, Predicted=5.671651, Expected=5.645000</p>
<p>The expected price (which is the actual price on 2017-05-31) is what I give the model on 2017-05-31 after the trading day is closed. What I expect the model to predict is closer to 5.79 than 5.67 (which is closer to the actual price the day before!). See the problem? Have I missed something? I haven&#8217;t changed anything in the framework except the data.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409180' data-commentid="409180" data-postid="3882" data-belowelement="comment-409180" data-respondelement="respond" data-replyto="Reply to Stone" aria-label='Reply to Stone'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-409213" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409213" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 10, 2017 at 4:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409213" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is a persistence model and the algorithm will converge to that (e.g. predict the input as the output) if it cannot do better. </p>
<p>Perhaps explore tuning the algorithm.</p>
<p>Also, I believe security prices are a random walk and persistence is the best we can do anyway:<br />
<a href="https://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/" rel="nofollow ugc">http://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409213' data-commentid="409213" data-postid="3882" data-belowelement="comment-409213" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409395" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-409395" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fcb26192097a40faf441ffb05c0470cc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fcb26192097a40faf441ffb05c0470cc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://amfirnas.me' rel='external nofollow ugc' class='url'>Firnas</a></span>
	                <span class="date">August 12, 2017 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Please do some tutorials RNN, NN with more categorical values in the dataset? please, I could not find many resources using the categorical values. </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409395' data-commentid="409395" data-postid="3882" data-belowelement="comment-409395" data-respondelement="respond" data-replyto="Reply to Firnas" aria-label='Reply to Firnas'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409462" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409462" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 13, 2017 at 9:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409462" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a few tutorials on the blog &#8211; for example, text data input or output are categorical variables.</p>
<p>What are you looking for exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409462' data-commentid="409462" data-postid="3882" data-belowelement="comment-409462" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409823" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-409823" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">nandini</span>
	                <span class="date">August 16, 2017 at 5:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409823" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>is it possible to write the code RNN Regression ,what is the activation function i need to give for regression RNN,how it is difference  from classification to regression?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409823' data-commentid="409823" data-postid="3882" data-belowelement="comment-409823" data-respondelement="respond" data-replyto="Reply to nandini" aria-label='Reply to nandini'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409891" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409891" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409891" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. The output would be &#8216;linear&#8217; for regression.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409891' data-commentid="409891" data-postid="3882" data-belowelement="comment-409891" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409866" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-409866" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/65980e0bdf6e107621b009342524aa3b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65980e0bdf6e107621b009342524aa3b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maria Jimenez</span>
	                <span class="date">August 17, 2017 at 1:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409866" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Brownlee, </p>
<p>I am trying to understand this code. I am a beginner working with time-series and LSTM.</p>
<p>My questions about your code:</p>
<p>1. What does &#8220;transform data to be stationary&#8221; mean?<br />
2. Why do you create diff? What does it mean?<br />
3. If the raw_values are 36 data, why diff has only 35?</p>
<p>I appreciate your response in advance,</p>
<p>Maria</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409866' data-commentid="409866" data-postid="3882" data-belowelement="comment-409866" data-respondelement="respond" data-replyto="Reply to Maria Jimenez" aria-label='Reply to Maria Jimenez'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409867" class="comment even depth-2">

	      	<div id="li-comment-409867" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/65980e0bdf6e107621b009342524aa3b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65980e0bdf6e107621b009342524aa3b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maria Jimenez</span>
	                <span class="date">August 17, 2017 at 1:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409867" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Never mind, I already understand. 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409867' data-commentid="409867" data-postid="3882" data-belowelement="comment-409867" data-respondelement="respond" data-replyto="Reply to Maria Jimenez" aria-label='Reply to Maria Jimenez'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409905" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-409905" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409905" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409905' data-commentid="409905" data-postid="3882" data-belowelement="comment-409905" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409904" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409904" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-409904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider using the blog search.</p>
<p>More about stationary data here:<br />
<a href="https://machinelearningmastery.com/time-series-data-stationary-python/" rel="nofollow ugc">http://machinelearningmastery.com/time-series-data-stationary-python/</a></p>
<p>More about differencing here:<br />
<a href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="nofollow ugc">http://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/</a></p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-409904' data-commentid="409904" data-postid="3882" data-belowelement="comment-409904" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410002" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-410002" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b7df87dec547d19d8f4ab52986d0bc47?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b7df87dec547d19d8f4ab52986d0bc47?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sourabh</span>
	                <span class="date">August 18, 2017 at 4:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410002" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, for the awesome blogs,<br />
But, I have a doubt, for time series forecasting, classical methods like autoregression and ARIMA, or this machine learning approach using LSTM RNN model, which is the better approach?  Both are good on their own, So, what should be our first choice while forecasting any dataset? How should we choose between them?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410002' data-commentid="410002" data-postid="3882" data-belowelement="comment-410002" data-respondelement="respond" data-replyto="Reply to Sourabh" aria-label='Reply to Sourabh'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410025" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-410025" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410025" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on your problem. Try a few methods and see what works best.</p>
<p>I recommend starting with linear methods like ARIMA, then try some ML methods like trees and such, then an MLP, then perhaps an RNN.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410025' data-commentid="410025" data-postid="3882" data-belowelement="comment-410025" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410271" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-410271" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/56e69bc71757f9ac4ee06c54838f3880?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/56e69bc71757f9ac4ee06c54838f3880?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bilal</span>
	                <span class="date">August 19, 2017 at 10:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When I changed train/test ration to 0.8/0.2 in LSTM code, it took half an hour to predict, and with another data that contains around 4000 records, it&#8217;s taking hours(i still couldn&#8217;t get result, i don&#8217;t know how long it&#8217;ll take). Can you please suggest me how I change settings for very long sequences. Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410271' data-commentid="410271" data-postid="3882" data-belowelement="comment-410271" data-respondelement="respond" data-replyto="Reply to Bilal" aria-label='Reply to Bilal'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410302" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-410302" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 20, 2017 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410302" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some ideas here:<br />
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow ugc">http://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410302' data-commentid="410302" data-postid="3882" data-belowelement="comment-410302" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410473" class="comment odd alt depth-3">

	      	<div id="li-comment-410473" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4af96cf6b557ceb736fc0d0e06ef01a1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4af96cf6b557ceb736fc0d0e06ef01a1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arun</span>
	                <span class="date">August 22, 2017 at 1:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410473" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, for long sequence like 4000 records, can you please help me to understand the changes from code point of view as per your current example, the above link is for classification and i am looking for sequence prediction problem.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410473' data-commentid="410473" data-postid="3882" data-belowelement="comment-410473" data-respondelement="respond" data-replyto="Reply to Arun" aria-label='Reply to Arun'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410512" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-410512" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 22, 2017 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410512" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must split your sequence into subsequences, for example, see this post for ideas:<br />
<a href="https://machinelearningmastery.com/truncated-backpropagation-through-time-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/truncated-backpropagation-through-time-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410512' data-commentid="410512" data-postid="3882" data-belowelement="comment-410512" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410614" class="comment odd alt depth-5">

	      	<div id="li-comment-410614" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e40179433103201c642bdd7daabbe1f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arun Menon</span>
	                <span class="date">August 23, 2017 at 12:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason, can you please help us to understand with a complete code example ? The above link just have an idea but not a code implementation, I want to understand from code point of view.</p>
<p>Regards,<br />
Arun</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410416" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-410416" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">hirohi</span>
	                <span class="date">August 21, 2017 at 12:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410416" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is the evaluation method in this post really &#8220;walk-forward&#8221;? I&#8217;ve read your post about time-series backtest. Walk-forward corresponds to cross validation for not time series data. In both, we make many models to learn, so these methods are not suitable for deep learning, including LSTM, the theme of this post.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410416' data-commentid="410416" data-postid="3882" data-belowelement="comment-410416" data-respondelement="respond" data-replyto="Reply to hirohi" aria-label='Reply to hirohi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410428" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410428" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 21, 2017 at 4:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, we are using walk-forward validation here.</p>
<p>Walk-forward validation is required for sequence prediction like time series forecasting.</p>
<p>See this post for more about the method and when to use it:<br />
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410428' data-commentid="410428" data-postid="3882" data-belowelement="comment-410428" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410537" class="comment even thread-even depth-1">

	      	<div id="li-comment-410537" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">hirohi</span>
	                <span class="date">August 22, 2017 at 11:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410537" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your reply. Sorry, that&#8217;s not what I mean it. I&#8217;ve read the post you pasted above, in which you split data into train/test 2820 times and build 2820 models. But, in this LSTM post, you split data and build a LSTM network only once, so I suggest the test in this article is not walk forward. ordered(not shuffle) hold-out test?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410537' data-commentid="410537" data-postid="3882" data-belowelement="comment-410537" data-respondelement="respond" data-replyto="Reply to hirohi" aria-label='Reply to hirohi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410540" class="comment odd alt depth-2">

	      	<div id="li-comment-410540" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">hirohi</span>
	                <span class="date">August 22, 2017 at 11:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry, please delete this comment</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410540' data-commentid="410540" data-postid="3882" data-belowelement="comment-410540" data-respondelement="respond" data-replyto="Reply to hirohi" aria-label='Reply to hirohi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-410639" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-410639" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 23, 2017 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Above, the model is evaluated 30 times.</p>
<p>Within the evaluation of one model, we use walk forward validation and samples are not shuffled.</p>
<p>I recommend re-reading the tutorial and code above.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410639' data-commentid="410639" data-postid="3882" data-belowelement="comment-410639" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410692" class="comment odd alt depth-3">

	      	<div id="li-comment-410692" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/06823b5a053f14474b3b0635dfd8ac32?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">hirohi</span>
	                <span class="date">August 23, 2017 at 12:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410692" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your reply! Oh, repeat=30! Sorry, I misunderstood. But I think in the back-test article, the size of train data changes, while in this LSTM article, the size of train data is fixed, right? Sorry for so many questions.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410692' data-commentid="410692" data-postid="3882" data-belowelement="comment-410692" data-respondelement="respond" data-replyto="Reply to hirohi" aria-label='Reply to hirohi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410752" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-410752" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1c3f40a82f1add08590fc17b283d66aa?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1c3f40a82f1add08590fc17b283d66aa?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gauthier</span>
	                <span class="date">August 23, 2017 at 10:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410752" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your work, it is seriously awesome.</p>
<p>I wanted to see the chart comparing training loss vs validation loss per epoch, see the chart here: <a href="https://ibb.co/kqcnBk" rel="nofollow ugc">https://ibb.co/kqcnBk</a>. As you mentioned in your other post:</p>
<p>&#8220;From the plot of loss, we can see that the model has comparable performance on both train and validation datasets (labeled test). If these parallel plots start to depart consistently, it might be a sign to stop training at an earlier epoch.&#8221;</p>
<p>However, in this case, the test loss never really gets lower and both lines are not parallel at all. for this problem, and in general, does that mean that no meaningful test-set pattern is learned from the training, as seems to be corroborated by the RMSE being close on average to the persistent/dummy method?</p>
<p>Is this the end of the road? Have NN&#8217;s failed in their tasks? If not, where to go next? </p>
<p>The main thing I changed in the code was the end of the fit_lstm function:<br />
for i in range(nb_epoch):<br />
        e=model.fit(X, y, epochs=10, batch_size=batch_size, verbose=0,validation_split=0.33,                    shuffle=False)<br />
        model.reset_states()<br />
    return model, e</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410752' data-commentid="410752" data-postid="3882" data-belowelement="comment-410752" data-respondelement="respond" data-replyto="Reply to Gauthier" aria-label='Reply to Gauthier'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410812" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410812" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 24, 2017 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410812" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Gauthier.</p>
<p>It may mean that the model under provisioned for the problem.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410812' data-commentid="410812" data-postid="3882" data-belowelement="comment-410812" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410904" class="comment even depth-3">

	      	<div id="li-comment-410904" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1c3f40a82f1add08590fc17b283d66aa?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1c3f40a82f1add08590fc17b283d66aa?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gauthier</span>
	                <span class="date">August 24, 2017 at 6:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>OK&#8230; So in this case would you suggest to include more neurons for example, or try another ML algorithm?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410904' data-commentid="410904" data-postid="3882" data-belowelement="comment-410904" data-respondelement="respond" data-replyto="Reply to Gauthier" aria-label='Reply to Gauthier'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410987" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-410987" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 25, 2017 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-410987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Both would be a safe bet.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-410987' data-commentid="410987" data-postid="3882" data-belowelement="comment-410987" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-509614" class="comment even depth-2">

	      	<div id="li-comment-509614" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/284fa2994e9c618d8d65122cb2a60889?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/284fa2994e9c618d8d65122cb2a60889?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">malcolm</span>
	                <span class="date">November 10, 2019 at 4:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-509614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, @Gauthier, may i know how you editted ur code to get the loss function?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-509614' data-commentid="509614" data-postid="3882" data-belowelement="comment-509614" data-respondelement="respond" data-replyto="Reply to malcolm" aria-label='Reply to malcolm'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411463" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-411463" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d4fe1b628d85732247260ec94b8e0c21?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d4fe1b628d85732247260ec94b8e0c21?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muni</span>
	                <span class="date">August 28, 2017 at 12:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-411463" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Json,</p>
<p>Thanks for your blogs and tutorials. Being a research scholar, when I was in dilemma how to learn ML, your tutorials gave me an excellent start to carry out my work in Machine Learning and Deep Learning. </p>
<p>I tried to work with the example in this page, But, I couldnt download the shampoo_sales dataset from datamarket.com. Could you please put the link to the datasets in the blog? If any procedure to download, please let me know.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-411463' data-commentid="411463" data-postid="3882" data-belowelement="comment-411463" data-respondelement="respond" data-replyto="Reply to Muni" aria-label='Reply to Muni'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411604" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-411604" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 29, 2017 at 5:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-411604" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I&#8217;m glad to hear that.</p>
<p>Here is the full dataset:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6092adfec5861339481553" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"Month","Sales"
"1-01",266.0
"1-02",145.9
"1-03",183.1
"1-04",119.3
"1-05",180.3
"1-06",168.5
"1-07",231.8
"1-08",224.5
"1-09",192.8
"1-10",122.9
"1-11",336.5
"1-12",185.9
"2-01",194.3
"2-02",149.5
"2-03",210.1
"2-04",273.3
"2-05",191.4
"2-06",287.0
"2-07",226.0
"2-08",303.6
"2-09",289.9
"2-10",421.6
"2-11",264.5
"2-12",342.3
"3-01",339.7
"3-02",440.4
"3-03",315.9
"3-04",439.3
"3-05",401.3
"3-06",437.4
"3-07",575.5
"3-08",407.6
"3-09",682.0
"3-10",475.3
"3-11",581.3
"3-12",646.9</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfec5861339481553-37">37</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-1"><span class="crayon-s">"Month"</span><span class="crayon-sy">,</span><span class="crayon-s">"Sales"</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-2"><span class="crayon-s">"1-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">266.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-3"><span class="crayon-s">"1-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">145.9</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-4"><span class="crayon-s">"1-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">183.1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-5"><span class="crayon-s">"1-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">119.3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-6"><span class="crayon-s">"1-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">180.3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-7"><span class="crayon-s">"1-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">168.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-8"><span class="crayon-s">"1-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">231.8</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-9"><span class="crayon-s">"1-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">224.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-10"><span class="crayon-s">"1-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">192.8</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-11"><span class="crayon-s">"1-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">122.9</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-12"><span class="crayon-s">"1-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">336.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-13"><span class="crayon-s">"1-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">185.9</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-14"><span class="crayon-s">"2-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">194.3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-15"><span class="crayon-s">"2-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">149.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-16"><span class="crayon-s">"2-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">210.1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-17"><span class="crayon-s">"2-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">273.3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-18"><span class="crayon-s">"2-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">191.4</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-19"><span class="crayon-s">"2-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">287.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-20"><span class="crayon-s">"2-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">226.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-21"><span class="crayon-s">"2-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">303.6</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-22"><span class="crayon-s">"2-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">289.9</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-23"><span class="crayon-s">"2-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">421.6</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-24"><span class="crayon-s">"2-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">264.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-25"><span class="crayon-s">"2-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">342.3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-26"><span class="crayon-s">"3-01"</span><span class="crayon-sy">,</span><span class="crayon-cn">339.7</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-27"><span class="crayon-s">"3-02"</span><span class="crayon-sy">,</span><span class="crayon-cn">440.4</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-28"><span class="crayon-s">"3-03"</span><span class="crayon-sy">,</span><span class="crayon-cn">315.9</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-29"><span class="crayon-s">"3-04"</span><span class="crayon-sy">,</span><span class="crayon-cn">439.3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-30"><span class="crayon-s">"3-05"</span><span class="crayon-sy">,</span><span class="crayon-cn">401.3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-31"><span class="crayon-s">"3-06"</span><span class="crayon-sy">,</span><span class="crayon-cn">437.4</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-32"><span class="crayon-s">"3-07"</span><span class="crayon-sy">,</span><span class="crayon-cn">575.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-33"><span class="crayon-s">"3-08"</span><span class="crayon-sy">,</span><span class="crayon-cn">407.6</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-34"><span class="crayon-s">"3-09"</span><span class="crayon-sy">,</span><span class="crayon-cn">682.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-35"><span class="crayon-s">"3-10"</span><span class="crayon-sy">,</span><span class="crayon-cn">475.3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-36"><span class="crayon-s">"3-11"</span><span class="crayon-sy">,</span><span class="crayon-cn">581.3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfec5861339481553-37"><span class="crayon-s">"3-12"</span><span class="crayon-sy">,</span><span class="crayon-cn">646.9</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-411604' data-commentid="411604" data-postid="3882" data-belowelement="comment-411604" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-412391" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-412391" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9c65f1afa9cc40f4a08f769bd5bb5f85?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9c65f1afa9cc40f4a08f769bd5bb5f85?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">mikiwate</span>
	                <span class="date">September 3, 2017 at 3:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-412391" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I am getting NAN on the 12 month:::</p>
<p>Month=1, Predicted=440.400000, Expected=440.400000<br />
Month=2, Predicted=315.900000, Expected=315.900000<br />
Month=3, Predicted=439.300000, Expected=439.300000<br />
Month=4, Predicted=401.300000, Expected=401.300000<br />
Month=5, Predicted=437.400000, Expected=437.400000<br />
Month=6, Predicted=575.500000, Expected=575.500000<br />
Month=7, Predicted=407.600000, Expected=407.600000<br />
Month=8, Predicted=682.000000, Expected=682.000000<br />
Month=9, Predicted=475.300000, Expected=475.300000<br />
Month=10, Predicted=581.300000, Expected=581.300000<br />
Month=11, Predicted=646.900000, Expected=646.900000<br />
Month=12, Predicted=646.900000, Expected=nan</p>
<p>from the code below:</p>
<p>predictions = list()<br />
for i in range(len(test_scaled)):<br />
	# make one-step forecast<br />
	X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br />
	#yhat = forecast_lstm(lstm_model, 1, X)<br />
	yhat=y<br />
    # invert scaling<br />
	yhat = invert_scale(scaler, X, yhat)<br />
	# invert differencing<br />
	yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)<br />
	# store forecast<br />
	predictions.append(yhat)<br />
	expected = raw_values[len(train) + i + 1]<br />
	print(&#8216;Month=%d, Predicted=%f, Expected=%f&#8217; % (i+1, yhat, expected))</p>
<p>I do not understand as to why this is happening.</p>
<p>thanks for the feedback.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-412391' data-commentid="412391" data-postid="3882" data-belowelement="comment-412391" data-respondelement="respond" data-replyto="Reply to mikiwate" aria-label='Reply to mikiwate'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412397" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-412397" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 3, 2017 at 3:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-412397" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting.</p>
<p>Does this happen every time? </p>
<p>I wonder if it is platform specific. Are you on a 32-bit machine? What version of Python?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-412397' data-commentid="412397" data-postid="3882" data-belowelement="comment-412397" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427654" class="comment odd alt depth-3">

	      	<div id="li-comment-427654" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/29c2298b986c00bddfe5c145ad7db98d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/29c2298b986c00bddfe5c145ad7db98d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">sms</span>
	                <span class="date">January 26, 2018 at 10:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427654" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Happened to me too, because after downloading from <a href="https://datamarket.com/data/set/22r0/sales-of-shampoo-over-a-three-year-period#!ds=22r0&#038;display=line" rel="nofollow ugc">https://datamarket.com/data/set/22r0/sales-of-shampoo-over-a-three-year-period#!ds=22r0&#038;display=line</a> the end of the csv &#8212;<br />
&#8220;3-10&#8221;,475.3<br />
&#8220;3-11&#8221;,581.3<br />
&#8220;3-12&#8243;,646.9</p>
<p>contained<br />
&#8221;</p>
<p>Sales of shampoo over a three year period</p>
<p>&#8221;</p>
<p>It worked when removed</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427654' data-commentid="427654" data-postid="3882" data-belowelement="comment-427654" data-respondelement="respond" data-replyto="Reply to sms" aria-label='Reply to sms'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427703" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-427703" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 27, 2018 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427703" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427703' data-commentid="427703" data-postid="3882" data-belowelement="comment-427703" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-412415" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-412415" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">September 3, 2017 at 6:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-412415" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>I had a question, what are we supposed to send as first parameter of inverse_difference if we go with the idea that we don&#8217;t know the future?</p>
<p>Regardless what I do, if I give it the testing set then it have perfect accuracy and values. If I send the training set it will look like the last len(test_scaled) training values.</p>
<p>Best regards</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-412415' data-commentid="412415" data-postid="3882" data-belowelement="comment-412415" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412463" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-412463" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 4, 2017 at 4:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-412463" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You would pass a list of past observations so that you can reverse the difference operation.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-412463' data-commentid="412463" data-postid="3882" data-belowelement="comment-412463" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412490" class="comment odd alt depth-3">

	      	<div id="li-comment-412490" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">September 4, 2017 at 9:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-412490" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Mr Jason,</p>
<p>Sorry, I have trouble understanding, what do you mean by &#8220;list of past observations&#8221;? Would that be what we predict (the predictions list)?<br />
It would then follow what &#8220;Pawel&#8221; asked and said previously?<br />
&#8220;my proposal:<br />
# invert differencing – (starting from 2nd loop cycle (1st would be the starting point (raw_values[-1]) )</p>
<p>yhat = inverse_difference(predictions, yhat, 1)&#8221;</p>
<p>Best regards,<br />
Eric</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-412490' data-commentid="412490" data-postid="3882" data-belowelement="comment-412490" data-respondelement="respond" data-replyto="Reply to Eric" aria-label='Reply to Eric'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412927" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-412927" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 7, 2017 at 12:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-412927" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I mean it is the true or real values observed in the domain at prior time steps. E.g. not predictions.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-412927' data-commentid="412927" data-postid="3882" data-belowelement="comment-412927" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413007" class="comment odd alt depth-5">

	      	<div id="li-comment-413007" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">September 7, 2017 at 5:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-413007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Mr Jason,</p>
<p>Thank you, so let&#8217;s imagine a 500 000 entry file.<br />
My training would be the 490 000 first line. I want to predict the last 10 000 lines.</p>
<p>For predicting I send the last line of the training set (then for the next prediction I send my first prediction without having unscaled or reversed the difference).<br />
To get the true value I send as argument of &#8220;Invert_difference&#8221; my training set, or more specially, my last 10 000 thousands line?</p>
<p>Best regards,<br />
Eric Godard.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-413199" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-413199" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 9, 2017 at 11:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-413199" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would not recommend prediction 10K time steps. I expect skill would be very poor.</p>
<p>Nevertheless, observation 490000 would be used to invert observation 490001, then the 490001 transformed prediction would be used to decode 490002 and so on.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-413072" class="comment odd alt depth-5">

	      	<div id="li-comment-413072" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2652cc5d8b7c695c33eec56a8206774b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">September 8, 2017 at 10:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-413072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I may have badly worded myself here.</p>
<p>My dataset have one entry per minute, one day is 1440 entry, I have years worth of data in my data set. I want to predict the next day, should I send the last day of the training set (trained_scaled[-1440:]) as argument of inverse_difference?</p>
<p>Best regards,</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-413216" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-413216" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 9, 2017 at 11:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-413216" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will help you better understand the different transform:<br />
<a href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="nofollow ugc">https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414041" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-414041" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/cc4369ac93ed04e05ee4ca8a42b72e41?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cc4369ac93ed04e05ee4ca8a42b72e41?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brian</span>
	                <span class="date">September 16, 2017 at 8:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414041" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I keep getting inconsistent result of RMSE every time I rerun the code, so I added</p>
<p>np.random.seed(1) # for consistent results</p>
<p>to the very top of my code so now every run produces consistent RMSE.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414041' data-commentid="414041" data-postid="3882" data-belowelement="comment-414041" data-respondelement="respond" data-replyto="Reply to Brian" aria-label='Reply to Brian'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414071" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414071" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 17, 2017 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414071" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is hard to get reproducible results, see this post for more information Brian:<br />
<a href="https://machinelearningmastery.com/reproducible-results-neural-networks-keras/" rel="nofollow ugc">https://machinelearningmastery.com/reproducible-results-neural-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414071' data-commentid="414071" data-postid="3882" data-belowelement="comment-414071" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414200" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-414200" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/33c125b7b4675a267d43ee131f8be1e7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/33c125b7b4675a267d43ee131f8be1e7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Irene</span>
	                <span class="date">September 18, 2017 at 8:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414200" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When I try to load the data after executing the following code line with Python 3.6 I get the following error: </p>
<p>series = read_csv(&#8216;shampoo-sales.csv&#8217;, header=0, parse_dates=[0], index_col=0,<br />
                  squeeze=True, date_parser=parser)</p>
<p>TypeError: ufunc &#8216;add&#8217; did not contain a loop with signature matching types dtype(&#8216;&lt;U32&#039;) dtype(&#039;&lt;U32&#039;) dtype(&#039;&lt;U32&#039;).</p>
<p>Can you help me, please?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414200' data-commentid="414200" data-postid="3882" data-belowelement="comment-414200" data-respondelement="respond" data-replyto="Reply to Irene" aria-label='Reply to Irene'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414238" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414238" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 19, 2017 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414238" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ouch, I have not seen that error before.</p>
<p>Perhaps confirm that the data is CSV and that you have removed the footer.</p>
<p>Perhaps ensure that your environment was installed correctly:<br />
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow ugc">http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>
<p>If that does not help, perhaps try posting to stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414238' data-commentid="414238" data-postid="3882" data-belowelement="comment-414238" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414203" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-414203" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c34ae77d2ec3e4a6302708ac6c953111?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c34ae77d2ec3e4a6302708ac6c953111?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Priyank</span>
	                <span class="date">September 18, 2017 at 10:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414203" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>Thanks for sharing this post, very helpful as currently I am working on a time series project. I have one query.. How can we save a model with best RSME and use it to further prediction. </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414203' data-commentid="414203" data-postid="3882" data-belowelement="comment-414203" data-respondelement="respond" data-replyto="Reply to Priyank" aria-label='Reply to Priyank'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414242" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414242" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 19, 2017 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414242" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post shows you how to save your model and use it to make predictions:<br />
<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow ugc">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414242' data-commentid="414242" data-postid="3882" data-belowelement="comment-414242" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414429" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-414429" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8dcca9a5d59391a86f19aaf43aa1c4b6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8dcca9a5d59391a86f19aaf43aa1c4b6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">September 21, 2017 at 10:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414429" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for the great tutorial!</p>
<p>Can you please clarify this statement for me: &#8220;The batch_size must be set to 1. This is because it must be a factor of the size of the training and test datasets&#8221;</p>
<p>I don&#8217;t understand how 1 in this case is a factor of the training and test datasets?</p>
<p>Further, for time series data, can we have a batch size greater than 1? If not, what was the relevance of the above statement?</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414429' data-commentid="414429" data-postid="3882" data-belowelement="comment-414429" data-respondelement="respond" data-replyto="Reply to Alex" aria-label='Reply to Alex'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414441" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414441" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 21, 2017 at 4:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414441" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it is a constraint for the chosen framing of the problem so that we can make one-step forecasts with a stateful LSTM.</p>
<p>It is not a constraint generally.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414441' data-commentid="414441" data-postid="3882" data-belowelement="comment-414441" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414512" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-414512" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/272a4a0b4145a12ffcc81590d5fd2b15?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/272a4a0b4145a12ffcc81590d5fd2b15?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nidhi</span>
	                <span class="date">September 22, 2017 at 9:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414512" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great post Jason, very granularly explained LSTM example. Thanks a lot. I am trying to train a model to predict scientific notation data like &#8220;9.543301358961403E-9&#8221;, could you suggest a good way to rescale this data that fits LSTM the best?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414512' data-commentid="414512" data-postid="3882" data-belowelement="comment-414512" data-respondelement="respond" data-replyto="Reply to Nidhi" aria-label='Reply to Nidhi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414591" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414591" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 23, 2017 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-414591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For input data, rescale values to the range 0-1.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-414591' data-commentid="414591" data-postid="3882" data-belowelement="comment-414591" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415338" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-415338" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d15e3230eb18d9b183650f75dd273914?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d15e3230eb18d9b183650f75dd273914?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">vardhan</span>
	                <span class="date">October 2, 2017 at 4:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-415338" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I have gone through many of your posts and still confusing when BPTT is applied?? Does BPTT is applied in this example? or just applied when we take more than one previous inputs to predict the current output??</p>
<p>And in this example, the parameters are updated at each epoch (batch gradient descent) completely contrast to stochastic gradient descent (online-learning), is this right??</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-415338' data-commentid="415338" data-postid="3882" data-belowelement="comment-415338" data-respondelement="respond" data-replyto="Reply to vardhan" aria-label='Reply to vardhan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415369" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415369" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 3, 2017 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-415369" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post provides an intro to BPTT:<br />
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow ugc">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<p>BPTT is applied when you have more than one time step in your input sequence data.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-415369' data-commentid="415369" data-postid="3882" data-belowelement="comment-415369" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415480" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-415480" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e50b35b89f473a72338e98f1676bc0e5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e50b35b89f473a72338e98f1676bc0e5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aljo Jose</span>
	                <span class="date">October 3, 2017 at 11:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-415480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thank you for great tutorial. Please let me know the difference between below two &#8211; </p>
<p>1)  model.fit(trainX, trainY, epochs=3000, batch_size=1, verbose=0)</p>
<p>2) for i in range(3000):<br />
	model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)<br />
	model.reset_states()</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-415480' data-commentid="415480" data-postid="3882" data-belowelement="comment-415480" data-respondelement="respond" data-replyto="Reply to Aljo Jose" aria-label='Reply to Aljo Jose'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415517" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415517" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 4, 2017 at 5:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-415517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not much.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-415517' data-commentid="415517" data-postid="3882" data-belowelement="comment-415517" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416803" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-416803" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/272a4a0b4145a12ffcc81590d5fd2b15?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/272a4a0b4145a12ffcc81590d5fd2b15?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nidhi</span>
	                <span class="date">October 16, 2017 at 1:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
You have reshaped value of X and then predicted the value of yhat, after that invert scaling of yhat is done and then this value is added to the raw value of the previous month. My question is what if I add the reshaped value of yhat and reshaped value of previous month and then call invert scale_function and not call inverse_difference function at all. Will both give the same result?<br />
Best Regards</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416803' data-commentid="416803" data-postid="3882" data-belowelement="comment-416803" data-respondelement="respond" data-replyto="Reply to Nidhi" aria-label='Reply to Nidhi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416837" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-416837" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 16, 2017 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe so, we need to group yhat with anything, even 0 values to ensure that we meet the shape requirements when inverting the transform.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416837' data-commentid="416837" data-postid="3882" data-belowelement="comment-416837" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416807" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-416807" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/272a4a0b4145a12ffcc81590d5fd2b15?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/272a4a0b4145a12ffcc81590d5fd2b15?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nidhi</span>
	                <span class="date">October 16, 2017 at 1:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416807" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I ran your code multiple times with different parameters. There is one more question, when we are plotting both &#8220;pyplot.plot(raw_values[-12:]) and pyplot.plot(predictions)&#8221;, I expected both the lines to coincide at certain points(like in your example graph values for months 1 &amp; 3 are almost close) OR at least show a similar trend, but why in most of the results the orange line for time (t) always seem to be more closely associated with the blue line for time (t-1)??  Initially, I thought it because we must be plotting raw values of month 24-36 and predictions from month 25-37, but that&#8217;s not the case, we are plotting both prediction values(predicted from month 23-35) and the raw values(from 24-36). Could be please clarify, why is that the case?. I am definitely missing out something, but not able to figure out! Thanks again.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416807' data-commentid="416807" data-postid="3882" data-belowelement="comment-416807" data-respondelement="respond" data-replyto="Reply to Nidhi" aria-label='Reply to Nidhi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416838" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-416838" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 16, 2017 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416838" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This suggests a persistence model (e.g. no skill).</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416838' data-commentid="416838" data-postid="3882" data-belowelement="comment-416838" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416826" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-416826" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/419e7a01e0ff3eeabfc72a51ce11e857?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/419e7a01e0ff3eeabfc72a51ce11e857?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rubens</span>
	                <span class="date">October 16, 2017 at 4:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m using lag&gt;1</p>
<p>Shouldn&#8217;t the function &#8220;timeseries_to_supervised&#8221; revert the range range(1, lag+1) ?</p>
<p>    columns = [df.shift(i) for i in reversed(range(1, lag+1))]</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416826' data-commentid="416826" data-postid="3882" data-belowelement="comment-416826" data-respondelement="respond" data-replyto="Reply to Rubens" aria-label='Reply to Rubens'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-416827" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-416827" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/905913a0c56327ddf56fbd07c8076dd4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/905913a0c56327ddf56fbd07c8076dd4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thong Bui</span>
	                <span class="date">October 16, 2017 at 5:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416827" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks so much for the in-depth tutorial. I have a question about this block of code in fit_lstm(): </p>
<p>    for i in range(nb_epoch):<br />
        model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)<br />
        model.reset_states()</p>
<p>Can it simply be done by this line?<br />
    model.fit(X, y, epochs=nb_epoch, batch_size=batch_size, verbose=0, shuffle=False)</p>
<p>Thanks for your clarification</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416827' data-commentid="416827" data-postid="3882" data-belowelement="comment-416827" data-respondelement="respond" data-replyto="Reply to Thong Bui" aria-label='Reply to Thong Bui'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416840" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-416840" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 16, 2017 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but I wanted to explicitly reset states at the end of each epoch rather than the end of each batch.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416840' data-commentid="416840" data-postid="3882" data-belowelement="comment-416840" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416849" class="comment even depth-3">

	      	<div id="li-comment-416849" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/905913a0c56327ddf56fbd07c8076dd4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/905913a0c56327ddf56fbd07c8076dd4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thong Bui</span>
	                <span class="date">October 16, 2017 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>what&#8217;s the difference between the 2 approaches?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416849' data-commentid="416849" data-postid="3882" data-belowelement="comment-416849" data-respondelement="respond" data-replyto="Reply to Thong Bui" aria-label='Reply to Thong Bui'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416884" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-416884" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 16, 2017 at 3:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-416884" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about LSTM internal states here:<br />
<a href="https://machinelearningmastery.com/understanding-stateful-lstm-recurrent-neural-networks-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/understanding-stateful-lstm-recurrent-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-416884' data-commentid="416884" data-postid="3882" data-belowelement="comment-416884" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417179" class="comment even thread-even depth-1">

	      	<div id="li-comment-417179" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1a01efb1c9b77da2f215406c82d4958f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1a01efb1c9b77da2f215406c82d4958f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Danier</span>
	                <span class="date">October 19, 2017 at 7:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
I am a college student. I am particularly interested in machine learning and are working hard on it. But my English is not very good, so my problems may be a little rough.<br />
1. The rmse in this article is somewhat large, and you have some other articles that describe how to adjust the parameters to reduce the rmse? What are the reasons for regulation?<br />
2. Would you have a better article about using LSTM to predict time series problems? Ps: in Uni-variate time series. Because I did the experiment myself, if I use the model of this article, my experiment accuracy is 85% to 90%. I want to improve it.<br />
3. Is there any article to solve the multivariate time series forecasting problem? If so, where is the latest?<br />
4. I have been running the model several times with my own macbookpro, which is too slow. If I want to be more efficient, can I buy some GPU cloud services? Like amazon? But it seems that these cloud services are especially expensive. Do you have any good solutions?<br />
Thank you so much! I want to say that you are my machine learning primer teacher.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417179' data-commentid="417179" data-postid="3882" data-belowelement="comment-417179" data-respondelement="respond" data-replyto="Reply to Danier" aria-label='Reply to Danier'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417212" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-417212" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 20, 2017 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417212" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post has a list of things to try to lift model skill:<br />
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>Generally, I would not recommend LSTMs for autoregression problems, see this post:<br />
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>
<p>Here is a multivariate time series example:<br />
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow ugc">https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/</a></p>
<p>In practice, AWS is very cheap:<br />
<a href="https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/" rel="nofollow ugc">https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417212' data-commentid="417212" data-postid="3882" data-belowelement="comment-417212" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417729" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-417729" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3c6d6d407d2cf8dde005be5495e88903?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3c6d6d407d2cf8dde005be5495e88903?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Danier</span>
	                <span class="date">October 24, 2017 at 3:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417729" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, Jason<br />
          Thank you for your last reply. I have improved the accuracy of 4% by various methods. I used bias_regularizer =L1L2 (0.01, 0.01) to reduce the value of rmse. (based on my own dataset). But I would like to ask about Tutorial Extensions.<br />
          I want to know how to complete multi-step Forecast. For example, my training set is 201601 to  201712, 24 sets of data, I would like to predict the six sets of data from 20171-201706. And these six sets of data have no expected value and are empty. I tried 10 or more methods but failed, maybe my python was too bad? Or is my understanding of LSTM not enough?I really can&#8217;t figure out a solution.and I was very depressed&#8230;&#8230;&#8230;..<br />
         I hope you can give me some Suggestions. Thank you. Or do you know of any article that can be used as my reference?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417729' data-commentid="417729" data-postid="3882" data-belowelement="comment-417729" data-respondelement="respond" data-replyto="Reply to Danier" aria-label='Reply to Danier'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417743" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-417743" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 24, 2017 at 4:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow ugc">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417743' data-commentid="417743" data-postid="3882" data-belowelement="comment-417743" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417793" class="comment even thread-even depth-1">

	      	<div id="li-comment-417793" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fcaff9045b5be7d7efb6bf1713c66128?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fcaff9045b5be7d7efb6bf1713c66128?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">argyn</span>
	                <span class="date">October 25, 2017 at 1:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417793" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello</p>
<p>I have an issue with your terminology regarding the dynamic forecasting, which you defined as follows:<br />
&#8220;re-fit the model or update the model each time step of the test data as new observations from the test data are made available (we’ll call this the dynamic approach).&#8221;</p>
<p>That&#8217;s not what&#8217;s called dynamic forecasting in time series and econometric analysis. The dynamic forecasting involves using the previous forecast value as input into the next forecast. In your case, you are using the lagged value of the dependent variable as a regressor in the estimation of the model: X(t) = Y(t-1). For instance, see this paper <a href="https://files.stlouisfed.org/files/htdocs/publications/review/80/06/Forecasting_Jun_Jul1980.pdf" rel="nofollow ugc">https://files.stlouisfed.org/files/htdocs/publications/review/80/06/Forecasting_Jun_Jul1980.pdf</a></p>
<p>So, the dynamic multi-step forecast would involve something like this: Yhat(t) = function(Yhat(t-1)). It doesn&#8217;t need to re-estimate the model at each step to be dynamic. All it needs is to use the previous forecast value to come up with the next.</p>
<p>Particularly this step would change to use yhat as X:</p>
<p>		X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br />
		yhat = forecast_lstm(lstm_model, 1, X)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417793' data-commentid="417793" data-postid="3882" data-belowelement="comment-417793" data-respondelement="respond" data-replyto="Reply to argyn" aria-label='Reply to argyn'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417832" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-417832" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 25, 2017 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the clarification.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417832' data-commentid="417832" data-postid="3882" data-belowelement="comment-417832" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417902" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-417902" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d7149ea32c0a1338676f626ce4880710?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d7149ea32c0a1338676f626ce4880710?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sulgi</span>
	                <span class="date">October 25, 2017 at 7:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417902" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi I like to input time difference between timesteps into LSTM to model a decay. I saw someone manually put this term into the weight, so weight now has the form, W(t). I wonder if we can include the time difference in input, X. Do you have any advice on this?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417902' data-commentid="417902" data-postid="3882" data-belowelement="comment-417902" data-respondelement="respond" data-replyto="Reply to Sulgi" aria-label='Reply to Sulgi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417961" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-417961" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 26, 2017 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417961" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not done this, perhaps talk to the person that raised this idea with you?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417961' data-commentid="417961" data-postid="3882" data-belowelement="comment-417961" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417989" class="comment even thread-even depth-1">

	      	<div id="li-comment-417989" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/075bb9ae37f0660dd0333ed59503db11?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/075bb9ae37f0660dd0333ed59503db11?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eren</span>
	                <span class="date">October 26, 2017 at 10:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-417989" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My observation is the model tries to predict the previous value so that it is able to pick a moderate precision. (I used another dataset)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417989' data-commentid="417989" data-postid="3882" data-belowelement="comment-417989" data-respondelement="respond" data-replyto="Reply to Eren" aria-label='Reply to Eren'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-418016" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-418016" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ea25739bc7616fd37563dc4d37a44279?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ea25739bc7616fd37563dc4d37a44279?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">tony</span>
	                <span class="date">October 26, 2017 at 5:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-418016" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason:<br />
    Use the shampoo sales data and my own test data, the results are good.But when the time series with        seasonal trends, LSTM result is very bad.So I want to ask is there any way to solve include seasonal time series forecasting problem?<br />
   thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418016' data-commentid="418016" data-postid="3882" data-belowelement="comment-418016" data-respondelement="respond" data-replyto="Reply to tony" aria-label='Reply to tony'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418047" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-418047" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 27, 2017 at 5:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-418047" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can seasonally adjust your data:<br />
<a href="https://machinelearningmastery.com/time-series-seasonality-with-python/" rel="nofollow ugc">https://machinelearningmastery.com/time-series-seasonality-with-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418047' data-commentid="418047" data-postid="3882" data-belowelement="comment-418047" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419215" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-419215" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/23de17adb64b39e24634d2a295f77726?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/23de17adb64b39e24634d2a295f77726?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Frank</span>
	                <span class="date">November 7, 2017 at 11:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419215" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>While the visuals and numbers in this tutorial are compelling, there are several things seriously wrong that aren&#8217;t apparent until you go over it with a very fine-toothed comb. Among all the arrays, lists, and indices flying all over the place, there are errors that make the results non-reproducible for one.</p>
<p>At the detail level you&#8217;ve got this prediction output:</p>
<p>    Month=1, Predicted=339.700000, Expected=339.700000<br />
    Month=2, Predicted=440.400000, Expected=440.400000<br />
    Month=3, Predicted=315.900000, Expected=315.900000<br />
    &#8230;.</p>
<p>However running the code block that is supposed to produce that results in an IndexError because &#8220;Expected&#8221; is supposed to come from:</p>
<p>    expected = raw_values[len(train) + i + 1]</p>
<p>Index i starts out at 0 because you are looping through len(train), so raw_values[len(train) + i + 1] will first be raw_values[len(train) + 0 + 1] which is raw_values[25], which is 440.40 (Month 2), not 339.7 (Month 1). </p>
<p>This kind of thing seems minor, but it&#8217;s actually very frustrating to readers who are trying to get some reproducible output, but instead they end up having to track down a bug in the code from the start.</p>
<p>At a more general level, the purpose of building a machine learning model is not to produce some metrics on test data and leave it at that. Instead, it is to build a model that performs well on out-of-sample data that you haven&#8217;t encountered yet. From the beginning, you apply a difference function to the data that is supposed to remove the trend, then you forecast the residuals, and then add the trend back in with an inverse difference function. Right there is a major violation as you are literally imputing known information into what is supposed to be the forecast. The inverse difference function takes raw_values as a parameter, however in a real out-of-sample scenario, you wouldn&#8217;t have access to those raw_values, so you couldn&#8217;t simply adjust the forecasted residuals to reflect the trend in that manner. How did no one catch this?</p>
<p>I&#8217;m doing a research project on LSTMS for time-series data and trying to extract something useful from this tutorial that I can apply to this problem, but I feel there are too many land-mines hidden throughout.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419215' data-commentid="419215" data-postid="3882" data-belowelement="comment-419215" data-respondelement="respond" data-replyto="Reply to Frank" aria-label='Reply to Frank'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-419263" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-419263" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4f596df7f0d92b7403a1f027dc2cae54?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4f596df7f0d92b7403a1f027dc2cae54?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luciano</span>
	                <span class="date">November 7, 2017 at 10:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419263" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!</p>
<p>I have a dataset of 200 thousand time-series. Each with 150 timestamps. </p>
<p>Let&#8217;s say they are sales of the same product but for different stores. </p>
<p>What is the best way to design the problem?</p>
<p>I can&#8217;t figure out what would be the ideal way to structure it. Just feed each sequence of 149 values to predict the 150th; Or should I do a rolling-window? If I give the whole sequence, I&#8217;m giving it a lot of context to work on, but I&#8217;m afraid the series it to big and training will be hard. </p>
<p>Any thoughts?<br />
There is a lack of literature on how to design time-series problems with LSTMs. You are the only one that is talking about it. Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419263' data-commentid="419263" data-postid="3882" data-belowelement="comment-419263" data-respondelement="respond" data-replyto="Reply to Luciano" aria-label='Reply to Luciano'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419339" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-419339" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 8, 2017 at 9:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419339" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend exploring many different framings of the problem and see what works best.</p>
<p>200K series is a lot. Perhaps you can group series and use sub-models and combine results in an ensemble of some sort.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419339' data-commentid="419339" data-postid="3882" data-belowelement="comment-419339" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419470" class="comment even thread-even depth-1">

	      	<div id="li-comment-419470" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d59d4da7b6a5ab0a7e69647ffdda587d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d59d4da7b6a5ab0a7e69647ffdda587d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashima</span>
	                <span class="date">November 9, 2017 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Would like to request your help in updating the above code to a dynamic model which updates itself after every observation and accordingly predicts the future points. Could you suggest how to modify this code to suit that purpose.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419470' data-commentid="419470" data-postid="3882" data-belowelement="comment-419470" data-respondelement="respond" data-replyto="Reply to Ashima" aria-label='Reply to Ashima'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419500" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-419500" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 9, 2017 at 10:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419500" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br />
<a href="https://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419500' data-commentid="419500" data-postid="3882" data-belowelement="comment-419500" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419533" class="comment even depth-3">

	      	<div id="li-comment-419533" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d59d4da7b6a5ab0a7e69647ffdda587d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d59d4da7b6a5ab0a7e69647ffdda587d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashima</span>
	                <span class="date">November 9, 2017 at 6:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Also if I need to create a lookback of a number other than 1, say 7 what all do I need to update in this code above to get it running for a look back of 7.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419533' data-commentid="419533" data-postid="3882" data-belowelement="comment-419533" data-respondelement="respond" data-replyto="Reply to Ashima" aria-label='Reply to Ashima'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419968" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-419968" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3b63a65798542a760e09654f93c8b81c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3b63a65798542a760e09654f93c8b81c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bahar</span>
	                <span class="date">November 14, 2017 at 4:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-419968" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the useful tutorial.<br />
I have a question about 		X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br />
		                                yhat = forecast_lstm(lstm_model, 1, X)</p>
<p>(line110):</p>
<p>I didn&#8217;t understand how the prediction will use timestamps to predict on test data set.<br />
As far as I know, eventually we want to predict based on future time. So we should test based on timestamps (not values) and compare the prediction results with real test values to see the accuracy of the prediction.<br />
But in the code, it seems that you are predicting based on the values and comparing again with those values!</p>
<p>Would you please explain it to me? Maybe I misunderstood some part.</p>
<p>Best Regards,<br />
Bahar</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419968' data-commentid="419968" data-postid="3882" data-belowelement="comment-419968" data-respondelement="respond" data-replyto="Reply to Bahar" aria-label='Reply to Bahar'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420038" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-420038" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 15, 2017 at 9:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420038" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are predicting t+1.</p>
<p>Perhaps this post will help to better understand Python array slicing and ranges:<br />
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420038' data-commentid="420038" data-postid="3882" data-belowelement="comment-420038" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420566" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-420566" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/47c6468a94d44b795c461292cb8785f0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/47c6468a94d44b795c461292cb8785f0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pradeep</span>
	                <span class="date">November 19, 2017 at 5:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420566" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason awesome tutorial which helps in getting folks started out.<br />
I had 2 quick questions.<br />
1. Is there a good example of adding other &#8220;features&#8221; apart form time lags. For example whether a particular hour is rush hour or not, whether a particular day is a weekday or not .<br />
2. I have hourly data for 3 years and wish to forecast hourly for the next 3 months. So i have approximately 14600 training rows and have to forecast for approximately 2600 test rows. Multi Step seems to be the right approach. However will be able to train a model to forecast so mant steps in advance?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420566' data-commentid="420566" data-postid="3882" data-belowelement="comment-420566" data-respondelement="respond" data-replyto="Reply to Pradeep" aria-label='Reply to Pradeep'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420638" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-420638" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 20, 2017 at 10:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420638" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post shows you how to use multiple input variables:<br />
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow ugc">https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/</a></p>
<p>Multistep for that many obs may result in poor results. I&#8217;d recommend testing a suite of approaches to see which works best for your data:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420638' data-commentid="420638" data-postid="3882" data-belowelement="comment-420638" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420665" class="comment odd alt depth-3">

	      	<div id="li-comment-420665" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/47c6468a94d44b795c461292cb8785f0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/47c6468a94d44b795c461292cb8785f0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pradeep</span>
	                <span class="date">November 20, 2017 at 4:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome Thanks Jason.I will go through the links suggested.<br />
Are there any other references which you can suggest for multi step forecasting?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420665' data-commentid="420665" data-postid="3882" data-belowelement="comment-420665" data-respondelement="respond" data-replyto="Reply to Pradeep" aria-label='Reply to Pradeep'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420793" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-420793" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 22, 2017 at 10:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420793" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow ugc">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420793' data-commentid="420793" data-postid="3882" data-belowelement="comment-420793" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420605" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-420605" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ec96756a49c58e27b994a233e3c2bd11?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec96756a49c58e27b994a233e3c2bd11?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harini</span>
	                <span class="date">November 20, 2017 at 1:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420605" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I have a quarterly sales dataset(below) and tried to use the same code on this post:<br />
Month, Sales<br />
5-09,11<br />
5-12,20<br />
6-03,66<br />
6-06,50<br />
6-09,65<br />
6-12,63<br />
7-06,25<br />
7-12,34</p>
<p>I trained the model with data from all preceding quarters to predict the last quarter:<br />
last quarter: predicted=-1.329951, actual=34.000000</p>
<p>The sales number can&#8217;t be negative but the model has predicted a negative value.<br />
Is there a way to prevent the model from predicting negative values?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420605' data-commentid="420605" data-postid="3882" data-belowelement="comment-420605" data-respondelement="respond" data-replyto="Reply to Harini" aria-label='Reply to Harini'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420643" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-420643" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 20, 2017 at 10:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420643" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend starting with some simple linear models to better understand your data and how time series works:<br />
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420643' data-commentid="420643" data-postid="3882" data-belowelement="comment-420643" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421120" class="comment odd alt depth-3">

	      	<div id="li-comment-421120" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ec96756a49c58e27b994a233e3c2bd11?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec96756a49c58e27b994a233e3c2bd11?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harini</span>
	                <span class="date">November 25, 2017 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-421120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason, I tried linear regression but it din&#8217;t seem to give me expected results.</p>
<p>Then I tuned the LSTM in your code to predict positive values by<br />
* changing the scaler range from (-1,1) to (0,1)<br />
* adding the activation function &#8216;relu&#8217; to the model</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-421120' data-commentid="421120" data-postid="3882" data-belowelement="comment-421120" data-respondelement="respond" data-replyto="Reply to Harini" aria-label='Reply to Harini'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420743" class="comment even thread-even depth-1">

	      	<div id="li-comment-420743" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/36ac5a793ba0ee2debe13f67cb21979a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/36ac5a793ba0ee2debe13f67cb21979a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SRIRAM P</span>
	                <span class="date">November 21, 2017 at 5:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-420743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Need a small clarification,</p>
<p>Does the for loop started at 100th line ends at 102?</p>
<p>for r in range(repeats):<br />
	# fit the model<br />
	lstm_model = fit_lstm(train_scaled, 1, 3000, 4)<br />
	# forecast the entire training dataset to build up state for forecasting<br />
	train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
	lstm_model.predict(train_reshaped, batch_size=1)</p>
<p>here in the above, does the lines<br />
	train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
	lstm_model.predict(train_reshaped, batch_size=1)</p>
<p>also belongs to for loop?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-420743' data-commentid="420743" data-postid="3882" data-belowelement="comment-420743" data-respondelement="respond" data-replyto="Reply to SRIRAM P" aria-label='Reply to SRIRAM P'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-421402" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-421402" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d10e5cdfddb770bf6aa13475ac7b310e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d10e5cdfddb770bf6aa13475ac7b310e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">AB</span>
	                <span class="date">November 28, 2017 at 5:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-421402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hey Jason,</p>
<p>How to Predict next one month for above example?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-421402' data-commentid="421402" data-postid="3882" data-belowelement="comment-421402" data-respondelement="respond" data-replyto="Reply to AB" aria-label='Reply to AB'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421433" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421433" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 28, 2017 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-421433" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will help you make predictions:<br />
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow ugc">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-421433' data-commentid="421433" data-postid="3882" data-belowelement="comment-421433" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422303" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-422303" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/749e7051b2117c5d61e19b10687a3c9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/749e7051b2117c5d61e19b10687a3c9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vijay</span>
	                <span class="date">December 6, 2017 at 11:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-422303" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>Thanks for all your wonderful articles. I&#8217;ve trying this model to predict a spending pattern of a customer. I have mean of the weekly expenditure of a customer. Once I finished training, i&#8217;m seeing this pattern where the predicted output for current is matching the expected output in the last week. I changed yhat = y to see if all the conversions are taking place correctly. But even yhat = y is showing the same behaviour.</p>
<p>Week=1, Predicted=975.556027, Expected=989.100588<br />
Week=2, Predicted=989.100588, Expected=928.604400<br />
Week=3, Predicted=928.604400, Expected=921.209794<br />
Week=4, Predicted=921.209794, Expected=919.813532<br />
Week=5, Predicted=919.813532, Expected=904.214533<br />
Week=6, Predicted=904.214533, Expected=913.695025<br />
Week=7, Predicted=913.695025, Expected=971.727005<br />
Week=8, Predicted=971.727005, Expected=1095.774093<br />
Week=9, Predicted=1095.774093, Expected=1159.611429<br />
Week=10, Predicted=1159.611429, Expected=732.743950<br />
Week=11, Predicted=732.743950, Expected=963.615794<br />
Week=12, Predicted=963.615794, Expected=896.842055<br />
Week=13, Predicted=896.842055, Expected=960.630000<br />
Week=14, Predicted=960.630000, Expected=905.481048<br />
Week=15, Predicted=905.481048, Expected=994.167244<br />
Week=16, Predicted=994.167244, Expected=975.601111<br />
Week=17, Predicted=975.601111, Expected=1210.307037<br />
Week=18, Predicted=1210.307037, Expected=9293.130000<br />
Week=19, Predicted=9293.130000, Expected=367.780000</p>
<p>I&#8217;m not differencing the data since my data is stationary, I dont see a increasing/decreasing pattering the spending patterns. Can you help me out ?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-422303' data-commentid="422303" data-postid="3882" data-belowelement="comment-422303" data-respondelement="respond" data-replyto="Reply to Vijay" aria-label='Reply to Vijay'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422352" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422352" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 7, 2017 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-422352" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may suggest that the model is only learning a persistence model (e.g. output what was input).</p>
<p>I would recommend starting with a simple MLP and see if an LSTM can do better.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-422352' data-commentid="422352" data-postid="3882" data-belowelement="comment-422352" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423515" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-423515" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 17, 2017 at 2:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423515" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>First of all, thanks for your great work and all the posts, they are really amazing and helpful!</p>
<p>Lets look at my changed csv data:</p>
<p>&#8220;1-01&#8221;,0.1<br />
&#8220;1-02&#8221;,-0.2<br />
&#8220;1-03&#8221;,0.3<br />
&#8220;1-04&#8221;,-0.4<br />
&#8220;1-05&#8221;,0.5<br />
&#8220;1-06&#8221;,-0.6<br />
&#8220;1-07&#8221;,0.7<br />
&#8220;1-08&#8221;,-0.8<br />
&#8220;1-09&#8221;,0.9<br />
&#8220;1-10&#8221;,-1.0<br />
&#8220;1-11&#8221;,1.1<br />
&#8220;1-12&#8221;,-1.2<br />
&#8220;2-01&#8221;,1.3<br />
&#8220;2-02&#8221;,-1.4<br />
&#8220;2-03&#8221;,1.5<br />
&#8220;2-04&#8221;,-1.6<br />
&#8220;2-05&#8221;,1.7<br />
&#8220;2-06&#8221;,-1.8<br />
&#8220;2-07&#8221;,1.9<br />
&#8220;2-08&#8221;,-2.0<br />
&#8220;2-09&#8221;,2.1<br />
&#8220;2-10&#8221;,-2.2<br />
&#8220;2-11&#8221;,2.3<br />
&#8220;2-12&#8221;,-2.4<br />
&#8220;3-01&#8221;,2.5<br />
&#8220;3-02&#8221;,-2.6<br />
&#8220;3-03&#8221;,2.7<br />
&#8220;3-04&#8221;,-2.8<br />
&#8220;3-05&#8221;,2.9<br />
&#8220;3-06&#8221;,-3.0<br />
&#8220;3-07&#8221;,3.1<br />
&#8220;3-08&#8221;,-3.2<br />
&#8220;3-09&#8221;,3.3<br />
&#8220;3-10&#8221;,-3.4<br />
&#8220;3-11&#8221;,3.5<br />
&#8220;3-12&#8221;,-3.6</p>
<p>Its a very simple sequence of &#8220;resonant&#8221; points, increasing every step over y axis. I didn&#8217;t changed any changes in the program code, and here is the result: <a href="http://prntscr.com/hob1hf" rel="nofollow ugc">http://prntscr.com/hob1hf</a></p>
<p>Why LSTM can not predict so simple and logical sequence of data? What are we missing here? </p>
<p>Waiting for your reply, and once again, thanks a lot!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423515' data-commentid="423515" data-postid="3882" data-belowelement="comment-423515" data-respondelement="respond" data-replyto="Reply to Anton" aria-label='Reply to Anton'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423567" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423567" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 17, 2017 at 8:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423567" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nothing, LSTMS are poor at autoregression, here&#8217;s why:<br />
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>
<p>Use an MLP instead.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423567' data-commentid="423567" data-postid="3882" data-belowelement="comment-423567" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423516" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-423516" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 17, 2017 at 2:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One interesting thing: I made the time serie 2 years longer, but with the same increasing resonant coefficient (0.1):</p>
<p>&#8220;1-01&#8221;,0.1<br />
&#8220;1-02&#8221;,-0.2<br />
&#8220;1-03&#8221;,0.3<br />
&#8220;1-04&#8221;,-0.4<br />
&#8220;1-05&#8221;,0.5<br />
&#8220;1-06&#8221;,-0.6<br />
&#8220;1-07&#8221;,0.7<br />
&#8220;1-08&#8221;,-0.8<br />
&#8220;1-09&#8221;,0.9<br />
&#8220;1-10&#8221;,-1.0<br />
&#8220;1-11&#8221;,1.1<br />
&#8220;1-12&#8221;,-1.2<br />
&#8220;2-01&#8221;,1.3<br />
&#8220;2-02&#8221;,-1.4<br />
&#8220;2-03&#8221;,1.5<br />
&#8220;2-04&#8221;,-1.6<br />
&#8220;2-05&#8221;,1.7<br />
&#8220;2-06&#8221;,-1.8<br />
&#8220;2-07&#8221;,1.9<br />
&#8220;2-08&#8221;,-2.0<br />
&#8220;2-09&#8221;,2.1<br />
&#8220;2-10&#8221;,-2.2<br />
&#8220;2-11&#8221;,2.3<br />
&#8220;2-12&#8221;,-2.4<br />
&#8220;3-01&#8221;,2.5<br />
&#8220;3-02&#8221;,-2.6<br />
&#8220;3-03&#8221;,2.7<br />
&#8220;3-04&#8221;,-2.8<br />
&#8220;3-05&#8221;,2.9<br />
&#8220;3-06&#8221;,-3.0<br />
&#8220;3-07&#8221;,3.1<br />
&#8220;3-08&#8221;,-3.2<br />
&#8220;3-09&#8221;,3.3<br />
&#8220;3-10&#8221;,-3.4<br />
&#8220;3-11&#8221;,3.5<br />
&#8220;3-12&#8221;,-3.6<br />
&#8220;4-01&#8221;,3.7<br />
&#8220;4-02&#8221;,-3.8<br />
&#8220;4-03&#8221;,3.9<br />
&#8220;4-04&#8221;,-4.0<br />
&#8220;4-05&#8221;,4.1<br />
&#8220;4-06&#8221;,-4.2<br />
&#8220;4-07&#8221;,4.3<br />
&#8220;4-08&#8221;,-4.4<br />
&#8220;4-09&#8221;,4.5<br />
&#8220;4-10&#8221;,-4.6<br />
&#8220;4-11&#8221;,4.7<br />
&#8220;4-12&#8221;,-4.8<br />
&#8220;5-01&#8221;,4.9<br />
&#8220;5-02&#8221;,-5.0<br />
&#8220;5-03&#8221;,5.1<br />
&#8220;5-04&#8221;,-5.2<br />
&#8220;5-05&#8221;,5.3<br />
&#8220;5-06&#8221;,-5.4<br />
&#8220;5-07&#8221;,5.5<br />
&#8220;5-08&#8221;,-5.6<br />
&#8220;5-09&#8221;,5.7<br />
&#8220;5-10&#8221;,-5.8<br />
&#8220;5-11&#8221;,5.9<br />
&#8220;5-12&#8221;,-6.0</p>
<p>Now, we see that LSTM made a predictions more closely, but still don&#8217;t see the increment over Y axis (the red lines and arrows are my own paining) <a href="http://prntscr.com/hob7eo" rel="nofollow ugc">http://prntscr.com/hob7eo</a></p>
<p>Any ideas?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423516' data-commentid="423516" data-postid="3882" data-belowelement="comment-423516" data-respondelement="respond" data-replyto="Reply to Anton" aria-label='Reply to Anton'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423568" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423568" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 17, 2017 at 8:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423568" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not enough data, model needs tuning, lstms are poor at autoregression.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423568' data-commentid="423568" data-postid="3882" data-belowelement="comment-423568" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423521" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-423521" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 17, 2017 at 3:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423521" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One more question about the code:</p>
<p>Why you performs 1 prediction before the predictions cycle:</p>
<p>train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
lstm_model.predict(train_reshaped, batch_size=1)</p>
<p>what is this for?</p>
<p>And at the line<br />
	# make one-step forecast<br />
	X, y = test_scaled[i, 0:-1], test_scaled[i, -1]</p>
<p>what is &#8220;y&#8221; for?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423521' data-commentid="423521" data-postid="3882" data-belowelement="comment-423521" data-respondelement="respond" data-replyto="Reply to Anton" aria-label='Reply to Anton'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423569" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423569" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 17, 2017 at 8:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423569" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It&#8217;s unused.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423569' data-commentid="423569" data-postid="3882" data-belowelement="comment-423569" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423689" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-423689" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/526311427780f4d21de2ca4d7db638fb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/526311427780f4d21de2ca4d7db638fb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Krasimir</span>
	                <span class="date">December 18, 2017 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423689" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks for the great posts, very helpful and informative. </p>
<p>I am using some of your example for stock market values predictions. The models work well. Could you please provide more detail on why there is a one sample delay (lag) in the response of the model. It can be seen on all your plots and mine too.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423689' data-commentid="423689" data-postid="3882" data-belowelement="comment-423689" data-respondelement="respond" data-replyto="Reply to Krasimir" aria-label='Reply to Krasimir'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423717" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423717" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 3:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-423717" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Because the model is not very good, it&#8217;s a sign that it is outputting the input as an output, called persistence:<br />
<a href="https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/" rel="nofollow ugc">https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-423717' data-commentid="423717" data-postid="3882" data-belowelement="comment-423717" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424067" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-424067" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 20, 2017 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-424067" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is the model state updated after each </p>
<p>lstm_model.predict(train_reshaped, batch_size=1)</p>
<p>?</p>
<p>So can we be sure that after 100 predictions the model will have actual state for 101 prediction? Or should we use some additional model updates technique after each prediction step? It is not clear for me&#8230;</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-424067' data-commentid="424067" data-postid="3882" data-belowelement="comment-424067" data-respondelement="respond" data-replyto="Reply to Anton" aria-label='Reply to Anton'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424070" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-424070" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 20, 2017 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-424070" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>State does not see to matter that much in this example.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-424070' data-commentid="424070" data-postid="3882" data-belowelement="comment-424070" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424071" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-424071" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 20, 2017 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-424071" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Agree, but in general? Does lstm_model.predict updates the model?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-424071' data-commentid="424071" data-postid="3882" data-belowelement="comment-424071" data-respondelement="respond" data-replyto="Reply to Anton" aria-label='Reply to Anton'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424161" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-424161" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 20, 2017 at 3:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-424161" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It will update internal state variables, but not weights.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-424161' data-commentid="424161" data-postid="3882" data-belowelement="comment-424161" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424266" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-424266" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/579961fdcdf73b2a961bdcfc13cdb454?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anton</span>
	                <span class="date">December 21, 2017 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-424266" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, thank you very much</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-424266' data-commentid="424266" data-postid="3882" data-belowelement="comment-424266" data-respondelement="respond" data-replyto="Reply to Anton" aria-label='Reply to Anton'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424293" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-424293" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 21, 2017 at 3:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-424293" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-424293' data-commentid="424293" data-postid="3882" data-belowelement="comment-424293" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425791" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-425791" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f0b45852fb0b5e2dd49e436371e34835?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f0b45852fb0b5e2dd49e436371e34835?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Novin</span>
	                <span class="date">January 7, 2018 at 1:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425791" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for the tutorial.</p>
<p>What&#8217;s your suggestion for adapting this network for different stores shampoo sales? Things that I could think of are:</p>
<p>1- run this model for different stores separately (maybe we can learn something from sales of all stores together, but with this approach, we can&#8217;t benefit that)<br />
2- giving in the number of sales of each store as features</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425791' data-commentid="425791" data-postid="3882" data-belowelement="comment-425791" data-respondelement="respond" data-replyto="Reply to Novin" aria-label='Reply to Novin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425809" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-425809" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 7, 2018 at 5:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425809" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Some ideas:</p>
<p>&#8211; model each store separately<br />
&#8211; model each store separately and add data from all stores<br />
&#8211; model each store separately and add data from related stores (regionally? profile? etc.)<br />
&#8211; create a regional store model and ensemble with separate store model.<br />
&#8211; create all store model and ensemble with separate store model<br />
&#8211; so on&#8230; </p>
<p>Think up 100 ideas and try them all to see what works best for your specific data.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425809' data-commentid="425809" data-postid="3882" data-belowelement="comment-425809" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425840" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-425840" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5100fb54283cd3bf5e15df3a57a14f79?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5100fb54283cd3bf5e15df3a57a14f79?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">mostafa kotb</span>
	                <span class="date">January 8, 2018 at 12:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you Dr. Jason for this tutorial.<br />
If i want to perform a walkforward validation on training data to, it is going to be:</p>
<p>for i in range(len(train_scaled)):<br />
		# make one-step forecast<br />
		X, y = train_scaled[i, 0:-1], train_scaled[i, -1]<br />
		yhat = forecast_lstm(lstm_model, 1, X)<br />
		# invert scaling<br />
		yhat = invert_scale(scaler, X, yhat)<br />
		# invert differencing<br />
		yhat = inverse_difference(raw_values, yhat, len(raw_values)-i)<br />
		# store forecast<br />
		predictions_train.append(yhat)<br />
		expected = raw_values[ i+1 ]<br />
		print(&#8216;Month=%d, Predicted=%f, Expected=%f&#8217; % (i+1, yhat, expected))</p>
<p>	# report performance<br />
	rmse_train = sqrt(mean_squared_error(raw_values[1:len(train_scaled)+1], predictions_train))</p>
<p>please, verify if it is right or not</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425840' data-commentid="425840" data-postid="3882" data-belowelement="comment-425840" data-respondelement="respond" data-replyto="Reply to mostafa kotb" aria-label='Reply to mostafa kotb'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425853" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-425853" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 8, 2018 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot debug your code. You can learn more about walk-forward validation here:<br />
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425853' data-commentid="425853" data-postid="3882" data-belowelement="comment-425853" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425856" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-425856" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5100fb54283cd3bf5e15df3a57a14f79?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5100fb54283cd3bf5e15df3a57a14f79?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">mostafa kotb</span>
	                <span class="date">January 8, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks for your reply&#8230;</p>
<p>let me rephrase my question&#8230;.i want to know when i compute RMSE for training data, Do i skip the first point in the raw values?</p>
<p> rmse_train = sqrt(mean_squared_error(raw_values[1:len(train_scaled)+1], predictions_train))</p>
<p>if you notice in the last equation i started from the second point raw_values[1:len(train_scaled)+1]</p>
<p>because we don&#8217;t predict the first point, actually we start by first point as x and predict the second point as y.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425856' data-commentid="425856" data-postid="3882" data-belowelement="comment-425856" data-respondelement="respond" data-replyto="Reply to mostafa kotb" aria-label='Reply to mostafa kotb'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-425871" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-425871" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e613e3a9fe6ff612e73bae7a1a762322?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e613e3a9fe6ff612e73bae7a1a762322?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Swapnil</span>
	                <span class="date">January 8, 2018 at 3:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Thanks for the great article.<br />
I have some log data from my honeypot. I have encoded the actions taking place with label encoder. Is this data good enough for training the lstm?  I finally want to recover the next action. Should i go for word to vector instead?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425871' data-commentid="425871" data-postid="3882" data-belowelement="comment-425871" data-respondelement="respond" data-replyto="Reply to Swapnil" aria-label='Reply to Swapnil'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425876" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425876" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 8, 2018 at 3:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425876" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try a few representations to see what works best for your data?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425876' data-commentid="425876" data-postid="3882" data-belowelement="comment-425876" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425938" class="comment even thread-even depth-1">

	      	<div id="li-comment-425938" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/091b71d391c24d4dc789b3ebe7ad02d1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/091b71d391c24d4dc789b3ebe7ad02d1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.jacquesthibodeau.com' rel='external nofollow ugc' class='url'>Jacques</a></span>
	                <span class="date">January 9, 2018 at 11:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425938" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey, I&#8217;m trying to understand why you implemented the persistence algorithm in a different way compared to your other post (<a href="https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/" rel="nofollow ugc">https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/</a>). In your other post, you framed the problem as a supervised learning problem, but you didn&#8217;t do the same here? You also talk about t-1 and t+1 on that post, not t-1 and t. Could you clarify why you didn&#8217;t convert the problem in this post into supervised until the lstm model?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425938' data-commentid="425938" data-postid="3882" data-belowelement="comment-425938" data-respondelement="respond" data-replyto="Reply to Jacques" aria-label='Reply to Jacques'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425957" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425957" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 9, 2018 at 3:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425957" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I was trying to make the example simpler.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425957' data-commentid="425957" data-postid="3882" data-belowelement="comment-425957" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425975" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-425975" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e613e3a9fe6ff612e73bae7a1a762322?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e613e3a9fe6ff612e73bae7a1a762322?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Swapnil</span>
	                <span class="date">January 9, 2018 at 6:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-425975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi how do u judge efficacy with rmse? Less is better or more?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425975' data-commentid="425975" data-postid="3882" data-belowelement="comment-425975" data-respondelement="respond" data-replyto="Reply to Swapnil" aria-label='Reply to Swapnil'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426054" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-426054" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 10, 2018 at 5:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-426054" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Small RMSE is better.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-426054' data-commentid="426054" data-postid="3882" data-belowelement="comment-426054" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427341" class="comment even thread-even depth-1">

	      	<div id="li-comment-427341" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e0e7823022e7d4197c7c164b65d0fccd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e0e7823022e7d4197c7c164b65d0fccd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ian</span>
	                <span class="date">January 23, 2018 at 7:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427341" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, nice tutorial. I am using XBT data for 2017, but just trying daily.  when I follow this suggestion &#8220;Update: Consider trying 1500 epochs and 1 neuron, the performance may be better!&#8221; the RMSE and the graph look very similar to the persistent model. Was that your finding?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427341' data-commentid="427341" data-postid="3882" data-belowelement="comment-427341" data-respondelement="respond" data-replyto="Reply to Ian" aria-label='Reply to Ian'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427427" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-427427" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 24, 2018 at 9:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t recall sorry.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427427' data-commentid="427427" data-postid="3882" data-belowelement="comment-427427" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427369" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-427369" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e4f6bbe7df2d9d1511c100ddb1644498?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e4f6bbe7df2d9d1511c100ddb1644498?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">andr</span>
	                <span class="date">January 24, 2018 at 12:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427369" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br />
is it possible to append to training set some data and update the model recursively? is it correct to do it with the fit function and the updated training set as parmeter?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427369' data-commentid="427369" data-postid="3882" data-belowelement="comment-427369" data-respondelement="respond" data-replyto="Reply to andr" aria-label='Reply to andr'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427436" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-427436" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 24, 2018 at 9:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427436" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can. Try it and see.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427436' data-commentid="427436" data-postid="3882" data-belowelement="comment-427436" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427596" class="comment even depth-3">

	      	<div id="li-comment-427596" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e4f6bbe7df2d9d1511c100ddb1644498?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e4f6bbe7df2d9d1511c100ddb1644498?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">andr</span>
	                <span class="date">January 26, 2018 at 1:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;ve tried two experiment:<br />
1)update the training set with new data as shown in <a href="https://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/update-lstm-networks-training-time-series-forecasting/</a> and update the model with 1 epoch<br />
2) same as point one but when I append the new data at the end of training set I remove the first element in it (a sort of sliding window. Does it have sense?).</p>
<p>The rmse in the two experiment is always worse than the version with no update in the training set. Any suggestion?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427596' data-commentid="427596" data-postid="3882" data-belowelement="comment-427596" data-respondelement="respond" data-replyto="Reply to andr" aria-label='Reply to andr'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427621" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-427621" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 26, 2018 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-427621" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting, nice work.</p>
<p>If you are looking for further improvements, I would suggest brainstorming 10 different approaches and compare them.</p>
<p>After that you can then think about more general things:<br />
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-427621' data-commentid="427621" data-postid="3882" data-belowelement="comment-427621" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428071" class="comment even thread-even depth-1">

	      	<div id="li-comment-428071" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/cfe69e8ba177e1943b336c027347710e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cfe69e8ba177e1943b336c027347710e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Antonio Bautista</span>
	                <span class="date">February 1, 2018 at 4:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-428071" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, thanks for this tutorial it is great and gave me a lot of insights. I just have one question. </p>
<p>Is the historial data still needed after the training of the net ? or just the last observations are needed?</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-428071' data-commentid="428071" data-postid="3882" data-belowelement="comment-428071" data-respondelement="respond" data-replyto="Reply to Antonio Bautista" aria-label='Reply to Antonio Bautista'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428100" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-428100" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 1, 2018 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-428100" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You model requires inputs to make predictions. It depends on how you have defined your model as to what you will need to retain.</p>
<p>Generally, training data is only used to fit the model, then the model is used to make predictions from new obs.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-428100' data-commentid="428100" data-postid="3882" data-belowelement="comment-428100" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428221" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-428221" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8f0ca0f7f307411d90dd66cbf6ec629f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8f0ca0f7f307411d90dd66cbf6ec629f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://none' rel='external nofollow ugc' class='url'>Shotaro</a></span>
	                <span class="date">February 2, 2018 at 7:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-428221" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason</p>
<p>Which type LSTM method do you use in this sample code?</p>
<p>1:[Hochreiter &amp; Schmidhuber, 95;97]  Simple LSTM</p>
<p>2:[Gers &amp; Schmidhuber, 99]   LSTM with Forget Gate</p>
<p>3:[Gers &amp; Schmidhuber, 00]  LSTM with Peephole Connection</p>
<p>4:[Graves &amp; Schmidhuber, 05] LSTM Full Gradient</p>
<p>5: Other</p>
<p>I think that Simpe LSTM.  Will you show other model in the future?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-428221' data-commentid="428221" data-postid="3882" data-belowelement="comment-428221" data-respondelement="respond" data-replyto="Reply to Shotaro" aria-label='Reply to Shotaro'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-429076" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-429076" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://plus.google.com/+%E9%92%9F%E9%92%9F' rel='external nofollow ugc' class='url'>Clock ZHONG</a></span>
	                <span class="date">February 11, 2018 at 4:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429076" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>Thanks again for you this post. I&#8217;ve also followed your instructions in this post, and finished the test.<br />
But I&#8217;ve a question:<br />
Comparing with other models, training this RNN model is very slow, I checked the code and found that you set the batch_size as 1, I believe one solution to accelerate the training is increasing batch_size to a bigger number, but I fear it will cause some other errors, as you explain as following:<br />
&#8220;The batch_size must be set to 1. This is because it must be a factor of the size of the training and test datasets.&#8221;<br />
Does i mean if we set the batch_size as a common factor of both the size of training and the testing datasets, then it&#8217;ll be OK? E.g. if my testset size is 1000, and my training dataset is 100000, then I could set the  batch_size as 1000, is my understanding right?<br />
If my understanding is wrong, what&#8217;s other restrictions I need pay attention?</p>
<p>Thanks in advance.</p>
<p>Clock ZHONG</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429076' data-commentid="429076" data-postid="3882" data-belowelement="comment-429076" data-respondelement="respond" data-replyto="Reply to Clock ZHONG" aria-label='Reply to Clock ZHONG'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429078" class="comment even depth-2">

	      	<div id="li-comment-429078" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://plus.google.com/+%E9%92%9F%E9%92%9F' rel='external nofollow ugc' class='url'>Clock ZHONG</a></span>
	                <span class="date">February 11, 2018 at 5:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>I read explanation in Keras website:<br />
<a href="https://keras.io/getting-started/faq/#how-can-i-use-stateful-rnns" rel="nofollow ugc">https://keras.io/getting-started/faq/#how-can-i-use-stateful-rnns</a><br />
It seems if we could ensure the samples sequence in a training batch, then the batch size could be set as any number.<br />
And if the test dataset follows the training dataset, then we could use them to predict directly without state reset, I believe so.</p>
<p>Thanks!</p>
<p>Clock ZHONG</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429078' data-commentid="429078" data-postid="3882" data-belowelement="comment-429078" data-respondelement="respond" data-replyto="Reply to Clock ZHONG" aria-label='Reply to Clock ZHONG'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-429128" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-429128" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 12, 2018 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429128" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, try it.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429128' data-commentid="429128" data-postid="3882" data-belowelement="comment-429128" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429082" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-429082" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0dfe96f29f99c721ded651e3fefe1742?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0dfe96f29f99c721ded651e3fefe1742?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ridhima Kumar</span>
	                <span class="date">February 11, 2018 at 6:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429082" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the wonderful explanation on LSTM.</p>
<p>I have tried running the code. However, I am getting an error &#8211; Keyword Error 1 when I difference the series. </p>
<p>The error comes after running the following piece:</p>
<p># transform to be stationary<br />
differenced = difference(series, 1)</p>
<p>It would be great if you could help me out with this.</p>
<p>Thanks!<br />
Ridhima Kumar</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429082' data-commentid="429082" data-postid="3882" data-belowelement="comment-429082" data-respondelement="respond" data-replyto="Reply to Ridhima Kumar" aria-label='Reply to Ridhima Kumar'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429131" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-429131" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 12, 2018 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429131" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps double check that you have copied all of the code?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429131' data-commentid="429131" data-postid="3882" data-belowelement="comment-429131" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429784" class="comment even thread-even depth-1">

	      	<div id="li-comment-429784" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/df9953e4d78e69168e5de6880c9e22c7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df9953e4d78e69168e5de6880c9e22c7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">February 17, 2018 at 3:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429784" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for the Awesome tutorial. Sorry if I&#8217;m stupid asking this here, New to application level ML. Only have amateur knowledge in the area, trying to learn by building a web app.</p>
<p>I&#8217;m using a sample data of three years to forecast the price for next 3 years- made up my dataset exactly like the sample used here, I followed your tutorial and everything worked fine till the last steps (lol I know how to copy-paste)</p>
<p>But I&#8217;m now stuck at writing the code for forecasting the next 3 years price.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429784' data-commentid="429784" data-postid="3882" data-belowelement="comment-429784" data-respondelement="respond" data-replyto="Reply to Peter" aria-label='Reply to Peter'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429810" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-429810" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 18, 2018 at 6:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429810" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is the error for the last step?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429810' data-commentid="429810" data-postid="3882" data-belowelement="comment-429810" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429942" class="comment even depth-3">

	      	<div id="li-comment-429942" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/df9953e4d78e69168e5de6880c9e22c7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df9953e4d78e69168e5de6880c9e22c7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">February 19, 2018 at 3:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429942" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m not getting any errors, but I have no idea on writing the code for say forecast the values for the year 2030.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429942' data-commentid="429942" data-postid="3882" data-belowelement="comment-429942" data-respondelement="respond" data-replyto="Reply to Peter" aria-label='Reply to Peter'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-429944" class="comment odd alt depth-3">

	      	<div id="li-comment-429944" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/df9953e4d78e69168e5de6880c9e22c7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df9953e4d78e69168e5de6880c9e22c7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">February 19, 2018 at 3:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-429944" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Simply: I want to forecast the 4th 5th and 6th years using this model, so how do I modify my code?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-429944' data-commentid="429944" data-postid="3882" data-belowelement="comment-429944" data-respondelement="respond" data-replyto="Reply to Peter" aria-label='Reply to Peter'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430077" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-430077" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 21, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-430077" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ho Peter, this post will show you how to do a multi-step forecast:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow ugc">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430077' data-commentid="430077" data-postid="3882" data-belowelement="comment-430077" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430068" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-430068" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/dda9dcf827a9bacd8d86f850b4966d62?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dda9dcf827a9bacd8d86f850b4966d62?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Julian</span>
	                <span class="date">February 21, 2018 at 3:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-430068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>thank you for your tutorial. I have a question for you. I copied your source code and changed the parameters for the number of epochs and units (LSTM) to 10 and 1. With this configuration I achieved very good results. If I now comment out the lines that are responsible for training the neural network, I get the same results. How is that possible?</p>
<p>Is there a bug in your program or do I have problems understanding how your code works?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430068' data-commentid="430068" data-postid="3882" data-belowelement="comment-430068" data-respondelement="respond" data-replyto="Reply to Julian" aria-label='Reply to Julian'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430108" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-430108" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 21, 2018 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-430108" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you did not comment out enough?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430108' data-commentid="430108" data-postid="3882" data-belowelement="comment-430108" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430115" class="comment odd alt depth-3">

	      	<div id="li-comment-430115" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/dda9dcf827a9bacd8d86f850b4966d62?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dda9dcf827a9bacd8d86f850b4966d62?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Julian</span>
	                <span class="date">February 21, 2018 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-430115" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have commented out the following lines:</p>
<p># for i in range(nb_epoch):<br />
#	model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)<br />
#	model.reset_states()</p>
<p>and</p>
<p># train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
# lstm_model.predict(train_reshaped, batch_size=1)</p>
<p>I mean, that should be enough. Or did I forget to comment out something?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430115' data-commentid="430115" data-postid="3882" data-belowelement="comment-430115" data-respondelement="respond" data-replyto="Reply to Julian" aria-label='Reply to Julian'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430191" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-430191" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 22, 2018 at 11:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-430191" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks reasonable.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430191' data-commentid="430191" data-postid="3882" data-belowelement="comment-430191" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430176" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-430176" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/63a68e8cb1d9ba4f08aa961e02fb1fa7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/63a68e8cb1d9ba4f08aa961e02fb1fa7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Paula</span>
	                <span class="date">February 22, 2018 at 7:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-430176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I´m new in LSTM nn. I copied your example, run it and it works but I don´t understand why I get different results each time I run the code. I didn´t find any random number that could make to get all time different results.</p>
<p>Moreover, I would like to know the reason why you create and fit the model 30 times and not only one. Could I take the best result of those 30?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430176' data-commentid="430176" data-postid="3882" data-belowelement="comment-430176" data-respondelement="respond" data-replyto="Reply to Paula" aria-label='Reply to Paula'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430208" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-430208" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 22, 2018 at 11:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-430208" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, see this post:<br />
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430208' data-commentid="430208" data-postid="3882" data-belowelement="comment-430208" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431357" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-431357" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a886027e993e40cb8f3b36a9b25e3d64?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a886027e993e40cb8f3b36a9b25e3d64?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ian Zhang</span>
	                <span class="date">March 6, 2018 at 9:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431357" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>i&#8217;m trying to deal with my time prediction problem using LSTM-based architecture.There are </p>
<p>almost 30 id in my dataset. Each data of id is similar with your sample.(time related </p>
<p>data.)Here is my question:</p>
<p>    1.Can this model train multiple sets of data at the same time?(e.g. you want to deal with </p>
<p>sales of different brands of shampoo. And you want to predict each of sale at same </p>
<p>time.Maybe each set of data is relevant，but you dont care.)If i can, how to decide input </p>
<p>shape and output shape?Is there any influence in the network of each set data</p>
<p>    2.If my data is stationary ,do i need to process my data by difference?I already try to </p>
<p>train my data without difference using this architecture.But predictions of test data is linear </p>
<p>(looks like a horizontal line).I don’t know why it happens.If it&#8217;s my fault or this architecture is </p>
<p>designed for this method(difference)?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431357' data-commentid="431357" data-postid="3882" data-belowelement="comment-431357" data-respondelement="respond" data-replyto="Reply to Ian Zhang" aria-label='Reply to Ian Zhang'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431398" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431398" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 7, 2018 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431398" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, try it and see how you go. Perhaps start with an MLP instead.</p>
<p>If the data is stationary, no need to use a difference transform.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431398' data-commentid="431398" data-postid="3882" data-belowelement="comment-431398" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431705" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-431705" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/794418c474b18d609ebf9135b64a4696?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/794418c474b18d609ebf9135b64a4696?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jamie</span>
	                <span class="date">March 10, 2018 at 12:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431705" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason! I have been reading your blog as a reference for a project at my internship and your content is awesome!!</p>
<p>In my project I need to both do series forecasting and also sequence classification. So I am playing with 2 models as my first approach to the problem: one LSTM network for forecasting and a second model for which I am considering a sliding window MLP to take small patches of my time series and do sequence classification (I have labels for all time steps).</p>
<p>So the general idea is to classify forecast sequences (classification over my predictions). I hope it makes sense.</p>
<p>In case it does, I wanted to ask for advice on the sliding window MLP since I really can&#8217;t find good references on the web. What would I do in general? Would I stack the inputs from the previous time steps and give it to my network as input? So an example for simplicity: if I have 5 variables, and I want to have a 5-step sliding window, would my input for time t be [[t-4],[t-3],[t-2],[t-1], [t]] -&gt; y[t]  and let my network figure out how to learn from it? or would I have to instead take the 5 vectors and aggregate them somehow (e.g. average) and then give my network only 1 resulting vector and its label? I am sorry if my question seems dumb but I really have not been able to find useful information on this topic, if you have anything on this on any of your posts or resources please let me know.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431705' data-commentid="431705" data-postid="3882" data-belowelement="comment-431705" data-respondelement="respond" data-replyto="Reply to Jamie" aria-label='Reply to Jamie'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431745" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431745" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 10, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431745" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, in general the lag obs become a window of features as input for the MLP.</p>
<p>Also, consider LSTM for sequence classification.</p>
<p>Also, explore a multiple output model to do both predictions from one model to see if it offers a lift in skill (if I understand your data correctly).</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431745' data-commentid="431745" data-postid="3882" data-belowelement="comment-431745" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431942" class="comment odd alt depth-3">

	      	<div id="li-comment-431942" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/794418c474b18d609ebf9135b64a4696?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/794418c474b18d609ebf9135b64a4696?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jamie</span>
	                <span class="date">March 12, 2018 at 8:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431942" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason, I will definitely explore your suggestions, let me try to explain again and also put it simply to see if the third option is feasable, I am curious to try it as well. I will give an illustration that is not my real problem but I find easier to explain and I think it&#8217;s a good illustration.</p>
<p>Imagine you had weather data and you have to recommend if it is a good day to go out or not, so all that matters to you is simply saying 0 if it&#8217;s not a good idea to go out but 1 if it&#8217;s a good idea. You have historical data and multiple inputs (humidity, atmospheric pressure, air temperature, etc.), and you want to give recommendations with multiple horizons (1 hour, 2 hours, etc). At every time step, you also have the ground truth labels for each entry.</p>
<p>So all that matters would be recommending good/bad with multiple horizons, but I thought, how would I be able to do this if not with 2 individual models, one that first forecasts the values for temperature, humidity,etc and a second model that does sequence classification and can classifty the sequences I predicted with my first model?</p>
<p>Is there a way I could simply do my recommendation forecasts with only 1 model? What type of model would this be (if any)? Thank you Jason!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431942' data-commentid="431942" data-postid="3882" data-belowelement="comment-431942" data-respondelement="respond" data-replyto="Reply to Jamie" aria-label='Reply to Jamie'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431971" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-431971" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 13, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431971" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you could do a multi-step forecast. Here are some examples of the different ways you could structure this model:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431971' data-commentid="431971" data-postid="3882" data-belowelement="comment-431971" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431909" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-431909" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/576c7c845b22a17795c76327de6aaed6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/576c7c845b22a17795c76327de6aaed6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://proarch.com' rel='external nofollow ugc' class='url'>Nikhil Singh</a></span>
	                <span class="date">March 12, 2018 at 10:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431909" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the tutorial.</p>
<p>I have used your code and made some modifications like I have increased the number of layers to 4 and add neurons (6,12, 18 and1) respectively at each layer. I have also added &#8220;relu&#8221; and &#8220;tanh&#8221; activation function and regularization also but I when I plotted the graph, the output is lag by 1 to input, like persistence model. </p>
<p>When I shift down the output value and again plot it nearly sometimes almost matches the input.<br />
For example, if the input has 10 value and output also have 10 value. I got better graph when I plot input value from 2 to 10 and the output value from 1 to 9. So I ignored the 1st value of the input and last value of the output. </p>
<p>I am trying to match the graph but I feel that I am wrong here because I don’t find any reason.</p>
<p>Could you please help me why I am getting this result? Means, even after using complex model, my model behaves like persistence model.</p>
<p>Please help !!!</p>
<p>I will be eagerly waiting for your reply</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431909' data-commentid="431909" data-postid="3882" data-belowelement="comment-431909" data-respondelement="respond" data-replyto="Reply to Nikhil Singh" aria-label='Reply to Nikhil Singh'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431928" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431928" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 12, 2018 at 2:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-431928" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the model is a bad fit for the problem?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431928' data-commentid="431928" data-postid="3882" data-belowelement="comment-431928" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432429" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-432429" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/114f35567e133a8b1818e93f697c260b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/114f35567e133a8b1818e93f697c260b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Atreya Bandyopadhyay</span>
	                <span class="date">March 17, 2018 at 4:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-432429" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>&#8220;The predict() function on the model is also constrained by the batch size&#8221;. What does this mean? If i set a batch size of 4 then will I have to provide as input 4 time steps?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-432429' data-commentid="432429" data-postid="3882" data-belowelement="comment-432429" data-respondelement="respond" data-replyto="Reply to Atreya Bandyopadhyay" aria-label='Reply to Atreya Bandyopadhyay'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432483" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432483" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 18, 2018 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-432483" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-432483' data-commentid="432483" data-postid="3882" data-belowelement="comment-432483" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432623" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-432623" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8b49dbe311fbba74fd1fcaec2ab60052?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b49dbe311fbba74fd1fcaec2ab60052?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hervaldo</span>
	                <span class="date">March 20, 2018 at 1:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-432623" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. I got this error and I could not discover what is wrong</p>
<p>ValueError: time data &#8216;1901-Jan&#8217; does not match format &#8216;%Y-%m&#8217;</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-432623' data-commentid="432623" data-postid="3882" data-belowelement="comment-432623" data-respondelement="respond" data-replyto="Reply to Hervaldo" aria-label='Reply to Hervaldo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432667" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432667" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 20, 2018 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-432667" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks like there is an issue with your data.</p>
<p>Try downloading it from here:<br />
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/shampoo.csv" rel="nofollow ugc">https://raw.githubusercontent.com/jbrownlee/Datasets/master/shampoo.csv</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-432667' data-commentid="432667" data-postid="3882" data-belowelement="comment-432667" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432624" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-432624" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8b49dbe311fbba74fd1fcaec2ab60052?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b49dbe311fbba74fd1fcaec2ab60052?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hervaldo</span>
	                <span class="date">March 20, 2018 at 1:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-432624" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I also looked at the dataset and the value of the first index is 1/1/2018</p>
<p>Thanks,</p>
<p>Hervaldo</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-432624' data-commentid="432624" data-postid="3882" data-belowelement="comment-432624" data-respondelement="respond" data-replyto="Reply to Hervaldo" aria-label='Reply to Hervaldo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-433340" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-433340" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/298f81f26a07b68f24e8a8731e8af172?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/298f81f26a07b68f24e8a8731e8af172?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kevin</span>
	                <span class="date">March 27, 2018 at 9:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-433340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think I am missing something basic here, I am new at this.  How would you use the model to predict what would occur past the test data, i.e. Month 13.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-433340' data-commentid="433340" data-postid="3882" data-belowelement="comment-433340" data-respondelement="respond" data-replyto="Reply to Kevin" aria-label='Reply to Kevin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433375" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-433375" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 27, 2018 at 4:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-433375" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, yes you are missing a piece. The above post is just an example of evaluating an LSTM. See this post:<br />
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow ugc">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-433375' data-commentid="433375" data-postid="3882" data-belowelement="comment-433375" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433513" class="comment even thread-even depth-1">

	      	<div id="li-comment-433513" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5d1264cae87616be88dc6262a58232c4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5d1264cae87616be88dc6262a58232c4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Don Lilly</span>
	                <span class="date">March 29, 2018 at 5:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-433513" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for all the great articles. I have a situation with 18 input variables and 1 output variable (which can be -1, 0 or 1) and that I convert with numpy&#8217;s to_categorical function to generate 3 outputs of (1, 0, 0), (0, 1, 0), and (0, 0, 1). I trained the model and it reports high accuracy (it starts out low and gets higher and higher as the epochs go by). So far so good. </p>
<p>All 18 input variables are floating point and scaled to be between -1 and 1.</p>
<p>The problem enters when I use the predict function on my test data &#8211; my answers are all values around 0 (floating point, like (0.0001, 0.002, 0.00123). The shape of the training and test data is the same, as reported by model.summary(). It is as if the model hasn&#8217;t learned anything.</p>
<p>Are the outputs from the predict function scaled or transformed in some way? I don&#8217;t need them to be, but it could be I am misunderstanding something here (an understatement!).</p>
<p>For reference, my code is roughly (there are 5766 rows of data):<br />
    model = Sequential()<br />
    model.add(LSTM(18, batch_input_shape=(1, 5766, 18), stateful=True, return_sequences=True))<br />
    model.add(Dense(10, input_shape=(18,), kernel_initializer=initializers.random_normal(seed=51)))<br />
    model.add(Dense(3, kernel_initializer=&#8217;uniform&#8217;))<br />
    model.compile(loss=&#8217;categorical_crossentropy&#8217;, optimizer=&#8217;adam&#8217;, metrics=[&#8216;accuracy&#8217;])<br />
    X_train = np.reshape(X, (1, X.shape[0], X.shape[1]))<br />
    Y_train = np.reshape(Y_train, (1, Y_train.shape[0], Y_train.shape[1]))</p>
<p>    for i in range(25):<br />
        model.fit(X_train, Y_train, epochs=1, batch_size=1, shuffle=False, verbose=2)<br />
        model.reset_states()</p>
<p>&#8230; then reshape the x test array in similar fashion and call:<br />
    y_pred = model.predict(X_test)</p>
<p>Thanks,<br />
Don</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-433513' data-commentid="433513" data-postid="3882" data-belowelement="comment-433513" data-respondelement="respond" data-replyto="Reply to Don Lilly" aria-label='Reply to Don Lilly'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433546" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-433546" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 29, 2018 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-433546" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps there is a bug? Perhaps you need to tune the model some more?</p>
<p>I give some ideas here:<br />
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-433546' data-commentid="433546" data-postid="3882" data-belowelement="comment-433546" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433560" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-433560" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5d1264cae87616be88dc6262a58232c4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5d1264cae87616be88dc6262a58232c4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Don Lilly</span>
	                <span class="date">March 29, 2018 at 8:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-433560" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your response. I will continue to hammer on it. </p>
<p>Don</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-433560' data-commentid="433560" data-postid="3882" data-belowelement="comment-433560" data-respondelement="respond" data-replyto="Reply to Don Lilly" aria-label='Reply to Don Lilly'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-433939" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-433939" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/01ed267374c42577c6b3b81ddbd20d5c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/01ed267374c42577c6b3b81ddbd20d5c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fredrik Nilsson</span>
	                <span class="date">April 3, 2018 at 1:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-433939" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi </p>
<p>Very good writing Jason!</p>
<p>I just have one question about the prediction which is a bit unclear.</p>
<p>I tried your exempel of using yhat = lstm_model.predict(X) but it only give me the error:</p>
<p>ValueError: Error when checking : expected lstm_2_input to have 3 dimensions, but got array with shape (1, 1)</p>
<p>For exampel how can we make an prediction for the period &#8220;4-01&#8221; or even &#8220;4-02&#8221; that does not exist in the trainingdata?</p>
<p>Since so many are asking for this maybe its time to put it in the main text?</p>
<p>Thanks for great job!</p>
<p>//Fredrik Nilsson</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-433939' data-commentid="433939" data-postid="3882" data-belowelement="comment-433939" data-respondelement="respond" data-replyto="Reply to Fredrik Nilsson" aria-label='Reply to Fredrik Nilsson'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433969" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433969" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 3, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-433969" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, did you copy all of the code from the example?</p>
<p>Are you using the same dataset?</p>
<p>Is your environment (Python/Keras) up to date?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-433969' data-commentid="433969" data-postid="3882" data-belowelement="comment-433969" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434006" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-434006" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2e16d0f019a6d556a27a093bec3cf4dd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2e16d0f019a6d556a27a093bec3cf4dd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">frank gallagher</span>
	                <span class="date">April 3, 2018 at 5:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-434006" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>the examples is great. I wonder if the neutral network is too simple with only one lstm layer and a Dense.  Would it do better changing the model? Like adding more layers.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434006' data-commentid="434006" data-postid="3882" data-belowelement="comment-434006" data-respondelement="respond" data-replyto="Reply to frank gallagher" aria-label='Reply to frank gallagher'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434061" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-434061" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 4, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-434061" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try it and see.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434061' data-commentid="434061" data-postid="3882" data-belowelement="comment-434061" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434115" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-434115" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ee444ef1d9ed5cf68adf027134661da9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ee444ef1d9ed5cf68adf027134661da9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akira</span>
	                <span class="date">April 4, 2018 at 6:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-434115" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir , i got a question in the codes:</p>
<p>        # make one-step forecast<br />
        X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br />
        yhat = forecast_lstm(lstm_model, 1, X)<br />
        # invert scaling<br />
        yhat = invert_scale(scaler, X, yhat)</p>
<p>which means:<br />
yhat = yhat + raw_values [ -(len+1-i) ]</p>
<p>We use observation to add yhat each time? How could that be prediction? And what is member &#8216;y&#8217; used for?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434115' data-commentid="434115" data-postid="3882" data-belowelement="comment-434115" data-respondelement="respond" data-replyto="Reply to Akira" aria-label='Reply to Akira'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434167" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-434167" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 5, 2018 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-434167" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is called walk-forward validation, you can learn more here:<br />
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434167' data-commentid="434167" data-postid="3882" data-belowelement="comment-434167" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434750" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-434750" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/df500093977599ab455ed9350ced1272?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df500093977599ab455ed9350ced1272?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">VanDarkholme</span>
	                <span class="date">April 11, 2018 at 7:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-434750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason<br />
 Is there any difference between:</p>
<p>for i in range(nb_epoch):<br />
		model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)<br />
		model.reset_states()</p>
<p>and</p>
<p>model.fit(X, y, epochs=nb_epoch, batch_size=batch_size, verbose=0, shuffle=False) ?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434750' data-commentid="434750" data-postid="3882" data-belowelement="comment-434750" data-respondelement="respond" data-replyto="Reply to VanDarkholme" aria-label='Reply to VanDarkholme'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434797" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-434797" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 12, 2018 at 8:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-434797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, we have control over when the state is reset.</p>
<p>In the first case, it is reset at the end of each epoch. In the second case it is reset at the end of each batch.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434797' data-commentid="434797" data-postid="3882" data-belowelement="comment-434797" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435351" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-435351" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/71f8069713bf30b845e659a9d6955488?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/71f8069713bf30b845e659a9d6955488?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gustav</span>
	                <span class="date">April 18, 2018 at 10:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-435351" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How would this example work with a dataset that is stockprices.</p>
<p>I have a csv file that is basically:<br />
&#8220;DateTime&#8221;,&#8221;Price [USD]&#8221;<br />
&#8220;2015-08-07 00:00:00&#8221;,2.77<br />
&#8220;2015-08-08 00:00:00&#8221;,0.8077<br />
.<br />
.<br />
.</p>
<p>Could I use the base from your code above for experimenting and and learning with own datafile?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-435351' data-commentid="435351" data-postid="3882" data-belowelement="comment-435351" data-respondelement="respond" data-replyto="Reply to Gustav" aria-label='Reply to Gustav'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435394" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435394" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 19, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-435394" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I had advice for preparing data for LSTMs here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<p>I have advice on forecasting the stock market here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-435394' data-commentid="435394" data-postid="3882" data-belowelement="comment-435394" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436246" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-436246" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/20483da6ed82dab761c74091cfbdc324?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/20483da6ed82dab761c74091cfbdc324?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jason</span>
	                <span class="date">April 29, 2018 at 6:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-436246" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a general question about predict function.<br />
Say I have trained a LSTM model (one step prediction e.g. X is 1D, Y is 1D), and I want to predict some Ys for given future Xs ( X=(X1, X2, X3, X4, X5, X6, X7) = (0.1, 0.2, 0.1, 0.5, 0.5, 0.9. 0.3) )</p>
<p>I know I will get a set of Y ( Y = (Y1, Y2, Y3, Y4, Y5, Y6, Y7) )<br />
Since X1=X3=0.1,   X4=X5=0.5, does it mean Y1=Y3 and Y4=Y5 ?<br />
My thought is for a given model, the coefficients are fixed after trained, when input a same value (e.g. value=0.1), it will ouput(preditc) a fixed value.</p>
<p>If not the case, could you briefly tell me how does the predict function work in the above example? Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-436246' data-commentid="436246" data-postid="3882" data-belowelement="comment-436246" data-respondelement="respond" data-replyto="Reply to Jason" aria-label='Reply to Jason'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436281" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436281" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 30, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-436281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The LSTM weights are fixed after training, but the LSTM also has an interal state, like a local variable that is accumulated over the input sequence.</p>
<p>You can learn more about how LSTMs work here:<br />
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#lstm</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-436281' data-commentid="436281" data-postid="3882" data-belowelement="comment-436281" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437132" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-437132" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0a1d3decb30e14c6f11bbef0b935cda8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0a1d3decb30e14c6f11bbef0b935cda8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://imgur.com/a/1Kp1oXA' rel='external nofollow ugc' class='url'>Ting</a></span>
	                <span class="date">May 10, 2018 at 6:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437132" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your sharing.</p>
<p>It is very helpful for a rookie try to handle time series data. </p>
<p>Below please find question I faced when reproducing code.</p>
<p>ValueError: Error when checking : expected lstm_2_input to have shape (1, 1) but got array with shape (1, 0)</p>
<p>(more info on url)</p>
<p>My environment is:<br />
Windows 10<br />
Python 3</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-437132' data-commentid="437132" data-postid="3882" data-belowelement="comment-437132" data-respondelement="respond" data-replyto="Reply to Ting" aria-label='Reply to Ting'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437178" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-437178" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 11, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m sorry to hear that, here are some suggestions:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-437178' data-commentid="437178" data-postid="3882" data-belowelement="comment-437178" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437417" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-437417" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c9bd85fe2c3943057c2501f935749385?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9bd85fe2c3943057c2501f935749385?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sanjoy Datta</span>
	                <span class="date">May 14, 2018 at 1:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437417" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Struggling to get shampoo data in. Getting the following errors:</p>
<p>TypeError: strptime() argument 1 must be str, not numpy.ndarray</p>
<p>ValueError: time data &#8216;190&#8243;1-01&#8243;,266.0&#8217; does not match format &#8216;%Y-%m&#8217;</p>
<p>Input data is a comma delimited csv file with no footer:</p>
<p>&#8220;Month&#8221;,&#8221;Sales&#8221;<br />
&#8220;1-01&#8221;,266.0<br />
&#8220;1-02&#8221;,145.9<br />
&#8220;1-03&#8221;,183.1<br />
&#8220;1-04&#8221;,119.3<br />
&#8220;1-05&#8221;,180.3<br />
&#8220;1-06&#8221;,168.5<br />
&#8220;1-07&#8221;,231.8<br />
&#8220;1-08&#8221;,224.5<br />
&#8220;1-09&#8221;,192.8<br />
&#8220;1-10&#8221;,122.9<br />
&#8220;1-11&#8221;,336.5<br />
&#8220;1-12&#8221;,185.9<br />
&#8220;2-01&#8221;,194.3<br />
&#8220;2-02&#8221;,149.5<br />
&#8220;2-03&#8221;,210.1<br />
&#8220;2-04&#8221;,273.3<br />
&#8220;2-05&#8221;,191.4<br />
&#8220;2-06&#8221;,287.0<br />
&#8220;2-07&#8221;,226.0<br />
&#8220;2-08&#8221;,303.6<br />
&#8220;2-09&#8221;,289.9<br />
&#8220;2-10&#8221;,421.6<br />
&#8220;2-11&#8221;,264.5<br />
&#8220;2-12&#8221;,342.3<br />
&#8220;3-01&#8221;,339.7<br />
&#8220;3-02&#8221;,440.4<br />
&#8220;3-03&#8221;,315.9<br />
&#8220;3-04&#8221;,439.3<br />
&#8220;3-05&#8221;,401.3<br />
&#8220;3-06&#8221;,437.4<br />
&#8220;3-07&#8221;,575.5<br />
&#8220;3-08&#8221;,407.6<br />
&#8220;3-09&#8221;,682.0<br />
&#8220;3-10&#8221;,475.3<br />
&#8220;3-11&#8221;,581.3<br />
&#8220;3-12&#8221;,646.9</p>
<p>Would be grateful for your help</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-437417' data-commentid="437417" data-postid="3882" data-belowelement="comment-437417" data-respondelement="respond" data-replyto="Reply to Sanjoy Datta" aria-label='Reply to Sanjoy Datta'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437456" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-437456" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 14, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437456" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is the data file:<br />
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/shampoo.csv" rel="nofollow ugc">https://raw.githubusercontent.com/jbrownlee/Datasets/master/shampoo.csv</a></p>
<p>If you are still having trouble, perhaps double check you copied the code exactly, with white space.</p>
<p>Here are some more suggestions:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-437456' data-commentid="437456" data-postid="3882" data-belowelement="comment-437456" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-438231" class="comment odd alt depth-2">

	      	<div id="li-comment-438231" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6a92d08d286686aed4d66602b216e5e5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6a92d08d286686aed4d66602b216e5e5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kevin</span>
	                <span class="date">May 22, 2018 at 6:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can check your x.csv file, It&#8217;s best to change the format of column month to short date, just like this:<br />
Month	Sales<br />
2018/1/1	266<br />
2018/1/2	145.9<br />
2018/1/3	183.1<br />
2018/1/4	119.3<br />
2018/1/5	180.3</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438231' data-commentid="438231" data-postid="3882" data-belowelement="comment-438231" data-respondelement="respond" data-replyto="Reply to Kevin" aria-label='Reply to Kevin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437729" class="comment even thread-even depth-1">

	      	<div id="li-comment-437729" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4001d8d9a80b60426e8f2280f6d5fedc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4001d8d9a80b60426e8f2280f6d5fedc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hirotaka Nakagame</span>
	                <span class="date">May 17, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437729" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It looks like my result is shifted by 1 timestep into the future but I am not sure where it came from.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-437729' data-commentid="437729" data-postid="3882" data-belowelement="comment-437729" data-respondelement="respond" data-replyto="Reply to Hirotaka Nakagame" aria-label='Reply to Hirotaka Nakagame'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437742" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-437742" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 17, 2018 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-437742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is common, see my explanation here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-437742' data-commentid="437742" data-postid="3882" data-belowelement="comment-437742" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438270" class="comment even depth-3">

	      	<div id="li-comment-438270" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4001d8d9a80b60426e8f2280f6d5fedc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4001d8d9a80b60426e8f2280f6d5fedc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hirotaka Nakagame</span>
	                <span class="date">May 23, 2018 at 3:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>do you have links to further tuning? Or if not predictable, why does it look like a pretty good &#8216;shifted&#8217; forecast? Any math reasons behind it?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438270' data-commentid="438270" data-postid="3882" data-belowelement="comment-438270" data-respondelement="respond" data-replyto="Reply to Hirotaka Nakagame" aria-label='Reply to Hirotaka Nakagame'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438293" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-438293" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 23, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438293" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438293' data-commentid="438293" data-postid="3882" data-belowelement="comment-438293" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438230" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-438230" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6a92d08d286686aed4d66602b216e5e5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6a92d08d286686aed4d66602b216e5e5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">kevin</span>
	                <span class="date">May 22, 2018 at 6:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438230" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,Thanks for your great article, May I ask some questions?</p>
<p>What if I wanna predict different products&#8217; sales?<br />
For example, shampo 、 cellphone 、 T-shirt, etc.<br />
Should I predict each items independently or together？</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438230' data-commentid="438230" data-postid="3882" data-belowelement="comment-438230" data-respondelement="respond" data-replyto="Reply to kevin" aria-label='Reply to kevin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438281" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438281" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 23, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>It depends on the data. It might be better to model each separately, to model them in groups or to model all products together. Some experimentation is required.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438281' data-commentid="438281" data-postid="3882" data-belowelement="comment-438281" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438375" class="comment even depth-3">

	      	<div id="li-comment-438375" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/829cf9a1f6773a63be795ced45edc7f6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/829cf9a1f6773a63be795ced45edc7f6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chirag mandot</span>
	                <span class="date">May 24, 2018 at 1:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438375" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it a good idea to build 10k different models for all products? Is there a better approach that you have used before for such scenarios?<br />
Thank you<br />
Great article Jason</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438375' data-commentid="438375" data-postid="3882" data-belowelement="comment-438375" data-respondelement="respond" data-replyto="Reply to Chirag mandot" aria-label='Reply to Chirag mandot'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438414" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-438414" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 24, 2018 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, models for categories of products, models for similar products, and models for all products.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438414' data-commentid="438414" data-postid="3882" data-belowelement="comment-438414" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438538" class="comment even thread-even depth-1">

	      	<div id="li-comment-438538" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4001d8d9a80b60426e8f2280f6d5fedc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4001d8d9a80b60426e8f2280f6d5fedc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hiro</span>
	                <span class="date">May 25, 2018 at 7:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I need to take a second difference, is this what I am supposed to do?</p>
<p>first_diff = difference(raw_values, 1)<br />
second_diff = difference(first_diff, 1)<br />
first_diff.index = raw_values.index[1:]<br />
.<br />
.<br />
.<br />
predictions = []<br />
temp = []<br />
for i in range(len(test_scaled)):<br />
  X, y = test_scaled[i, 0:-1], test_scaled[i, -1]</p>
<p>  yhat = forecast_lstm(lstm_model, 1, X)<br />
  yhat = invert_scale(scaler, X, yhat)<br />
  temp.append(yhat)<br />
  yhat = inverse_difference(first_diff, yhat, len(test_scaled)+1-i)<br />
  yhat = inverse_difference(raw_values, yhat, len(test_scaled)+12-i)<br />
  predictions.append(yhat)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438538' data-commentid="438538" data-postid="3882" data-belowelement="comment-438538" data-respondelement="respond" data-replyto="Reply to Hiro" aria-label='Reply to Hiro'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438571" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 25, 2018 at 9:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-438571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can difference the differenced series or use an ARIMA model that can do differencing for you at different orders.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-438571' data-commentid="438571" data-postid="3882" data-belowelement="comment-438571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439173" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-439173" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/98500a471c09ad376b5b54b7fa6ce6a3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/98500a471c09ad376b5b54b7fa6ce6a3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">WEIKE</span>
	                <span class="date">May 31, 2018 at 3:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-439173" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason:<br />
I am a little confuse about why yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)<br />
instead of yhat = inverse_difference(raw_values, yhat, len(test_scaled)-i). I am not sure why we need the 1.<br />
I am a new man to access the LSTM.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-439173' data-commentid="439173" data-postid="3882" data-belowelement="comment-439173" data-respondelement="respond" data-replyto="Reply to WEIKE" aria-label='Reply to WEIKE'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-539929" class="comment odd alt depth-2">

	      	<div id="li-comment-539929" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/596d51278622cf3225f67d94be77343e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/596d51278622cf3225f67d94be77343e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leon</span>
	                <span class="date">June 18, 2020 at 3:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-539929" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>In the section where you show us how to difference and reverse difference the time series you use this line code:<br />
inverse_difference(series, differenced[i], len(series)-i)</p>
<p>And in the example you use this line of code:<br />
yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)</p>
<p>What would be the reason to add &#8220;1&#8221; to the code? Much appreciated.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-539929' data-commentid="539929" data-postid="3882" data-belowelement="comment-539929" data-respondelement="respond" data-replyto="Reply to Leon" aria-label='Reply to Leon'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-539969" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-539969" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 18, 2020 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-539969" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe it is required to align the operation correctly. Try the transform on [1,2,3,4,5,6,7,8,9,10] and inspect the results.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-539969' data-commentid="539969" data-postid="3882" data-belowelement="comment-539969" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440111" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-440111" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c027fa68fd5da5eec88c0dab5230bcbb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c027fa68fd5da5eec88c0dab5230bcbb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ger</span>
	                <span class="date">June 7, 2018 at 11:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440111" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason!</p>
<p>I am working with your example of the LSTM.<br />
Since the data is transformed to a supervised learning problem (t-1) shouldn&#8217;t we shift the predictions by -1 aswel? Right now my graph seems to line up almost exactly with the real data but shifted one day ahead.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440111' data-commentid="440111" data-postid="3882" data-belowelement="comment-440111" data-respondelement="respond" data-replyto="Reply to Ger" aria-label='Reply to Ger'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440161" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-440161" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 8, 2018 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440161" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will help better explain how to prepare time series data for supervised learning:<br />
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow ugc">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440161' data-commentid="440161" data-postid="3882" data-belowelement="comment-440161" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440237" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-440237" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3f89557c819c01a83bc300a2751d14b1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3f89557c819c01a83bc300a2751d14b1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ari</span>
	                <span class="date">June 9, 2018 at 1:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440237" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I was getting errors about expecting 2D but being 1D so I changed scaler to be:<br />
    scaler = scaler.fit([train])  # &lt;&#8212;Different from tutorial<br />
i.e. adding brackets</p>
<p>That fixed the problem but now I get &quot;IndexError: tuple index out of range&quot; referencing this line:<br />
    train = train.reshape(train.shape[0], train.shape[1])</p>
<p>The code other than that one change is the same. Do you know why this might be? I&#039;m using python 3.5.5</p>
<p>Thank you for any help!</p>
<p>## Shampoo sales dataset<br />
# LSTM<br />
# 1. Transform the time series into a supervised learning problem<br />
# 2. Transform the time series data so that it is stationary<br />
# 3. Transform the observations to have a specific sale</p>
<p># Import packages<br />
from pandas import DataFrame<br />
from pandas import Series<br />
from pandas import concat<br />
from pandas import read_csv<br />
from pandas import datetime<br />
from sklearn.metrics import mean_squared_error<br />
from sklearn.preprocessing import MinMaxScaler<br />
from keras.models import Sequential<br />
from keras.layers import Dense<br />
from keras.layers import LSTM<br />
from math import sqrt<br />
from matplotlib import pyplot<br />
import numpy</p>
<p># date-time parsing function for loading the dataset<br />
def parser(x):<br />
    return datetime.strptime(&#039;190&#039;+x, &#039;%Y-%m&#039;)</p>
<p># Transform time series to supervised learning<br />
# Shift all values down to create t-1 input and t output<br />
# Helper function time_series_to_supervised()</p>
<p># Test the function with loaded sales data &amp; convert to supervised learning problem<br />
# Frame a sequence as a supervised learning problem<br />
def timeseries_to_supervised(data, lag=1):<br />
    df = DataFrame(data)<br />
    columns = [df.shift(i) for i in range(1, lag+1)]<br />
    columns.append(df)<br />
    df = concat(columns, axis=1)<br />
    df.fillna(0, inplace=True)<br />
    return df</p>
<p># Transform Time Series to Stationary (remove trend)<br />
# Stationary = Not dependent on time<br />
# Method = Differencing the data; observation from t-1 is subtracted from t, only leaves<br />
# Create a differenced series<br />
def difference(dataset, interval=1):<br />
    diff = list()<br />
    for i in range(interval, len(dataset)):<br />
        value = dataset[i] &#8211; dataset[i &#8211; interval]<br />
        diff.append(value)<br />
    return Series(diff)</p>
<p># Invert differenced value<br />
# Necessary to take forecasts made on the differenced series back into their original scale<br />
def inverse_difference(history, yhat, interval=1):<br />
    return yhat + history[-interval]</p>
<p># Scale train and test data to [-1, 1]<br />
def scaler(train, test):<br />
    # Fit scaler<br />
    scaler = MinMaxScaler(feature_range=(-1, 1))<br />
    scaler = scaler.fit([train])  #  Supervised learning format, batch size, epochs, neurons<br />
def fit_lstm(train, batch_size, nb_epoch, neurons):<br />
    # Reshape data from X, y to Samples/TimeSteps/Features<br />
    X, y = train[:, 0:-1], train[:, -1]<br />
    X = X.reshape(X.shape[0], 1, X.shape[1])<br />
# Specify network -&gt; Compile in efficient symbolic representation using backend library<br />
# Specify loss function and optimization algorithm (mean sq. error here)<br />
    model = Sequential()<br />
    model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True))<br />
    model.add(Dense(1))<br />
    model.compile(loss=&#8217;mean_squared_error&#8217;, optimizer=&#8217;adam&#8217;)<br />
# Once compiled, fit to training data<br />
# Default in epoch = shuffled = not ideal for LSTM- SET TO FALSE!<br />
# Verbose = Reporting of debug info<br />
# Loop manually fits the network to training data<br />
    for i in range(nb_epoch):<br />
        model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)<br />
        model.reset_states()<br />
    return model</p>
<p># Fixed approach = Fit the model once on all of the training data<br />
# then predict each new time step one at a time from the test data (used here).<br />
# Dynamic approach = Re-fit the model or update the model each time<br />
# step of the rest data as new obs from the test data are made available.<br />
# Given a fit model, a batch size used when fitting the model (1), and a row<br />
# from the test data, the function will separate out the input data from the<br />
# test row, reshape it, and return the prediction as a single floating point value.</p>
<p># Make a one-step forecast<br />
def forecast(model, batch_size, row):<br />
    X = row[0: -1]<br />
    X = X.reshape(1, 1, len(X))<br />
    yhat = model.predict(X, batch_size=batch_size)<br />
    return yhat[0,0]</p>
<p>#Load dataset w/ earlier parser function<br />
series = read_csv(&#8216;/Users/arianalemadriscoll/Documents/SeasonalityData/shampoo-sales.csv&#8217;,<br />
                  header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser, engine=&#8217;python&#8217;,<br />
                  skipfooter=3)</p>
<p># Transform to be stationary<br />
raw_values = series.values<br />
diff_values = difference(raw_values, 1)</p>
<p># Transform to supervised learning<br />
supervised = timeseries_to_supervised(diff_values, 1)<br />
supervised_values = series.values</p>
<p># Split data into train and test sets<br />
train, test = supervised_values[0:-12], supervised_values[-12:]</p>
<p># Transform the scale of the data<br />
scaler, train_scaled, test_scaled = scaler(train, test)</p>
<p># Fit the model<br />
lstm_model = fit_lstm(train_scaled, 1, 3000, 4)<br />
# Also try 1, 1500, 2?</p>
<p># Forecast the entire training dataset to build up state for forecasting<br />
train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
lstm_model.predict(train_reshaped, batch_size=1)</p>
<p># Walk-forward validation on the test data (rolling forecast scenario)<br />
predictions = list()<br />
for i in range(len(test_scaled)):<br />
    # Make one-step forecast<br />
    X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br />
    yhat = forecast_lstm(lstm_model, 1, X)<br />
    # Invert scaling<br />
    yhat = invert_scale(scaler, X, yhat)<br />
    # Invert differencing<br />
    yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)<br />
    # Store forecast<br />
    predictions.append(yhat)<br />
    expected = raw_values[len(train) + i + 1]<br />
    print(&#8216;Month=%d, Predicted=%f, Expected=%f&#8217; % (i+1, yhat, expected))</p>
<p># Report performance<br />
# RMSE punishes large errors and the score reports in the same units as the forecast data (monthly shampoo sales)</p>
<p>rmse = sqrt(mean_squared_error(raw_values[-12:], predictions))<br />
print(&#8216;Test RMSE: %.3f&#8217; % rmse)</p>
<p>#Line plot of observed vs. predicted<br />
pyplot.plot(raw_values[-12:])<br />
pyplot.plot(predictions)<br />
pyplot.show()</p>
<p># batch_input_shape = tuple that specifies the expected # obs to read each batch<br />
# + # time steps, # features<br />
# Batch size and epochs define how quickly the network learns the data<br />
# i.e. how often the weights are updated<br />
# Number of neurons/memory units/blocks (1-5 for simple problem is sufficient)</p>
<p>#layer = LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440237' data-commentid="440237" data-postid="3882" data-belowelement="comment-440237" data-respondelement="respond" data-replyto="Reply to Ari" aria-label='Reply to Ari'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440277" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-440277" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 9, 2018 at 6:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440277" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440277' data-commentid="440277" data-postid="3882" data-belowelement="comment-440277" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440499" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-440499" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0e92c13f1ed1bd49bea08c6b21917a7b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0e92c13f1ed1bd49bea08c6b21917a7b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rafael Caballero</span>
	                <span class="date">June 12, 2018 at 2:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440499" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think there is a bug in your proposal.  Just  change arbitrarily points of the test set, and you will find that your model still predicts the right values!! As you know this is not possible.</p>
<p>The error, I think is in the inverse_difference function. In this function your are adding the predicted increment to the previous raw value. But you are not supposed to have access to this value.</p>
<p>That is, the last point you can &#8216;see&#8217; is the last value of the training set v=raw_values[train_size]. When you predict an increment yhat0 the predicted value should be v+yhat0. Then, the next iteration you get a new value yhat1 from yhat0. Then the predicted value is v+ yhat0 + yhat1, but you are using raw_values[train_size+1]+yhay1, which is wrong. </p>
<p>I think the same happens in other of your posts about LSTM.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440499' data-commentid="440499" data-postid="3882" data-belowelement="comment-440499" data-respondelement="respond" data-replyto="Reply to Rafael Caballero" aria-label='Reply to Rafael Caballero'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440530" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-440530" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 12, 2018 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440530" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model is not skilful. Don&#8217;t use LSTMs for time series forecasting:<br />
<a href="https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/suitability-long-short-term-memory-networks-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440530' data-commentid="440530" data-postid="3882" data-belowelement="comment-440530" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440541" class="comment odd alt depth-3">

	      	<div id="li-comment-440541" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0e92c13f1ed1bd49bea08c6b21917a7b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0e92c13f1ed1bd49bea08c6b21917a7b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rafael Caballero</span>
	                <span class="date">June 12, 2018 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440541" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see, thanks for the reference. However, I have found that LSTM can beat ARIMA in very short time predictions, just in the first units of time.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440541' data-commentid="440541" data-postid="3882" data-belowelement="comment-440541" data-respondelement="respond" data-replyto="Reply to Rafael Caballero" aria-label='Reply to Rafael Caballero'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440564" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-440564" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 12, 2018 at 2:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-440564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Really!? </p>
<p>I have not seen that myself. </p>
<p>I find that a grid search&#8217;ed SARIMA or Holt-Winters model outperforms a neural net on every univariate time series dataset I try.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-440564' data-commentid="440564" data-postid="3882" data-belowelement="comment-440564" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441383" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-441383" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3069d047af60e6b6ec36a6f7395aec58?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3069d047af60e6b6ec36a6f7395aec58?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aditya</span>
	                <span class="date">June 20, 2018 at 9:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-441383" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>while_loop() got an unexpected keyword argument &#8216;maximum_iterations&#8217; . Has anyone encountered this error? I believe this is an error due to Keras/ Tensorflow version?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-441383' data-commentid="441383" data-postid="3882" data-belowelement="comment-441383" data-respondelement="respond" data-replyto="Reply to Aditya" aria-label='Reply to Aditya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441470" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441470" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 21, 2018 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-441470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have not seen this error sorry. Perhaps try posting to stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-441470' data-commentid="441470" data-postid="3882" data-belowelement="comment-441470" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-442109" class="comment odd alt depth-2">

	      	<div id="li-comment-442109" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/992e8cf9cd45200e69f629422e6dd832?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/992e8cf9cd45200e69f629422e6dd832?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mario</span>
	                <span class="date">June 27, 2018 at 1:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442109" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have the same error, i thought the problem was about the Keras version i changed but the problem persist.</p>
<p>TypeError                                 Traceback (most recent call last)<br />
 in ()<br />
      1 # fit the model<br />
&#8212;-&gt; 2 lstm_model = fit_lstm(train_scaled, 1, 3000, 4)<br />
      3 # forecast the entire training dataset to build up state for forecasting<br />
      4 train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
      5 lstm_model.predict(train_reshaped, batch_size=1)</p>
<p> in fit_lstm(train, batch_size, nb_epoch, neurons)<br />
     50         X = X.reshape(X.shape[0], 1, X.shape[1])<br />
     51         model = Sequential()<br />
&#8212;&gt; 52         model.add(LSTM(neurons, batch_input_shape=(batch_size, X.shape[1], X.shape[2]), stateful=True))<br />
     53         model.add(Dense(1))<br />
     54         model.compile(loss=&#8217;mean_squared_error&#8217;, optimizer=&#8217;adam&#8217;)</p>
<p>C:\Users\mmariscal\Anaconda3\lib\site-packages\keras\engine\sequential.py in add(self, layer)</p>
<p>C:\Users\mmariscal\Anaconda3\lib\site-packages\keras\layers\recurrent.py in __call__(self, inputs, initial_state, constants, **kwargs)<br />
    498<br />
    499         if initial_state is None and constants is None:<br />
&#8211;&gt; 500             return super(RNN, self).__call__(inputs, **kwargs)<br />
    501<br />
    502         # If any of <code>initial_state</code> or <code>constants</code> are specified and are Keras</p>
<p>C:\Users\mmariscal\Anaconda3\lib\site-packages\keras\engine\base_layer.py in __call__(self, inputs, **kwargs)</p>
<p>C:\Users\mmariscal\Anaconda3\lib\site-packages\keras\layers\recurrent.py in call(self, inputs, mask, training, initial_state)<br />
   2110                                       mask=mask,<br />
   2111                                       training=training,<br />
-&gt; 2112                                       initial_state=initial_state)<br />
   2113<br />
   2114     @property</p>
<p>C:\Users\mmariscal\Anaconda3\lib\site-packages\keras\layers\recurrent.py in call(self, inputs, mask, training, initial_state, constants)<br />
    607                                              mask=mask,<br />
    608                                              unroll=self.unroll,<br />
&#8211;&gt; 609                                              input_length=timesteps)<br />
    610         if self.stateful:<br />
    611             updates = []</p>
<p>C:\Users\mmariscal\Anaconda3\lib\site-packages\keras\backend\tensorflow_backend.py in rnn(step_function, inputs, initial_states, go_backwards, mask, constants, unroll, input_length)<br />
   2955     # Arguments<br />
   2956         x: A tensor or variable.<br />
-&gt; 2957         axis: The dimension softmax would be performed on.<br />
   2958             The default is -1 which indicates the last dimension.<br />
   2959 </p>
<p>TypeError: while_loop() got an unexpected keyword argument &#8216;maximum_iterations&#8217;</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-442109' data-commentid="442109" data-postid="3882" data-belowelement="comment-442109" data-respondelement="respond" data-replyto="Reply to Mario" aria-label='Reply to Mario'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442140" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-442140" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 27, 2018 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442140" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you able to confirm that you are using the latest version of Keras and TensorFlow?</p>
<p>For example:</p>
<p>tensorflow: 1.8.0<br />
keras: 2.1.6</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-442140' data-commentid="442140" data-postid="3882" data-belowelement="comment-442140" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442216" class="comment odd alt depth-4">

	      	<div id="li-comment-442216" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b18fe2645deba78046163c08acc82554?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b18fe2645deba78046163c08acc82554?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://na' rel='external nofollow ugc' class='url'>Pei</a></span>
	                <span class="date">June 28, 2018 at 6:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442216" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I got the same error with tensorflow=1.3.1, keras=2.2.0.</p>
<p>After I upgraded to tensorflow=1.8.0, (keras=2.2.0),  the error was gone!</p>
<p>So the error is caused by lower versions of tensorflow.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-442216' data-commentid="442216" data-postid="3882" data-belowelement="comment-442216" data-respondelement="respond" data-replyto="Reply to Pei" aria-label='Reply to Pei'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442231" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-442231" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 28, 2018 at 2:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m glad to hear that!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441578" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-441578" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0bd4c83fc9fae7d5cc5c40333806cf2c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0bd4c83fc9fae7d5cc5c40333806cf2c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sonya</span>
	                <span class="date">June 22, 2018 at 1:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-441578" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason, </p>
<p>I have a multidimensional data with 24 features.<br />
I would like to convert my data into batches of lets say size 100, so that&#8217;s 100 rows 24 columns:  (100,24). Then I would like to predict the next batch based on the lets say previous 20. Is this possible, how can I achieve this?</p>
<p>Thanks for your help.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-441578' data-commentid="441578" data-postid="3882" data-belowelement="comment-441578" data-respondelement="respond" data-replyto="Reply to Sonya" aria-label='Reply to Sonya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441611" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441611" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 22, 2018 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-441611" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-441611' data-commentid="441611" data-postid="3882" data-belowelement="comment-441611" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442743" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-442743" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/16cba8f2f90dab03bc6518b185087c1b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/16cba8f2f90dab03bc6518b185087c1b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fatima</span>
	                <span class="date">July 5, 2018 at 9:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can you please guide me if i can do this process in R.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-442743' data-commentid="442743" data-postid="3882" data-belowelement="comment-442743" data-respondelement="respond" data-replyto="Reply to Fatima" aria-label='Reply to Fatima'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442774" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-442774" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 6, 2018 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442774" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don&#8217;t have material on deep learning in R.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-442774' data-commentid="442774" data-postid="3882" data-belowelement="comment-442774" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442851" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-442851" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/baf881fb5f53c85a9b0ec85b37ef5430?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/baf881fb5f53c85a9b0ec85b37ef5430?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">ibrahim</span>
	                <span class="date">July 7, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442851" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks for posting such a useful post. I would like to ask what does neurons mean?What does it mean when it is 4 and 1?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-442851' data-commentid="442851" data-postid="3882" data-belowelement="comment-442851" data-respondelement="respond" data-replyto="Reply to ibrahim" aria-label='Reply to ibrahim'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442877" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-442877" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 7, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-442877" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is the number of nodes within a layer.</p>
<p>Maybe this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-442877' data-commentid="442877" data-postid="3882" data-belowelement="comment-442877" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443325" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-443325" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/baf881fb5f53c85a9b0ec85b37ef5430?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/baf881fb5f53c85a9b0ec85b37ef5430?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">ibrahim</span>
	                <span class="date">July 13, 2018 at 3:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-443325" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanx again Jason. I have been searching an issue for a long time. There is some revelations about my question in this site however, there is not the exact one. I have an electricity time series consumption with hourly loads and temperatures. I implemented NARXnet to the time series(3 years hourly loads) and predicted next 24 hrs&#8217; values. There is a cycle that repeats every week so that i have chosen 168 time delay for NARXnet. The predictions is satisfactory. Now, i would like to implement LSTM for the time series, however, i cannot conceptualize some LSTM inputs for modelling. For example inputs in the LSTM layer must be 3d format  [samples, timesteps, features].What is samples, timesteps and features for my 26304 observations, 2-11 prediction attributes(some dummies for days) and 168 cycles?The second question is can i adopt autoregressiveness to LSTM?The third question is setting stateful as True enable autoregression adaption to LSTM and is it related to batch_size for implementing say 168 for my time series? Fourth one is how can i represent 168 step cycle in LSTM due to this cycle has dominant patterns in data?The last one is can i use CNN for time series with 24&#215;7 dimension each to catch correlations in the days?<br />
Thanks from now for your responses.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-443325' data-commentid="443325" data-postid="3882" data-belowelement="comment-443325" data-respondelement="respond" data-replyto="Reply to ibrahim" aria-label='Reply to ibrahim'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443347" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443347" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 13, 2018 at 7:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-443347" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Samples are sub-sequences, time steps are observations ordered by a time variable, features are what was recorded or observed at each time step.</p>
<p>You can use LSTMs for autoregressive type models. </p>
<p>Stateful may not be required, I find it is often not required.</p>
<p>This may help you prepare your data:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-443347' data-commentid="443347" data-postid="3882" data-belowelement="comment-443347" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444381" class="comment odd alt depth-3">

	      	<div id="li-comment-444381" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/baf881fb5f53c85a9b0ec85b37ef5430?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/baf881fb5f53c85a9b0ec85b37ef5430?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">ibrahim</span>
	                <span class="date">July 25, 2018 at 8:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,hello again<br />
I tried to do sth to prepare my data that you directed. As mentioned earlier, my data has 26304 rows (with hourly observations)and 1(features)+9 (day and holdiays&#8217; dummies) columns. I wanted to add autoregression to the problem so that i prepared my data with the shape (this part contained validation and train sets) 25969x168x10.Here 25969 refers observation numbers,168 refers 168 previous look back of to be predicted value(namely 168 back step AR values for 169th value that will be predicted) and 10 refers data dimensions. In implementation i have some challenges.Train and val sets have 24000 and 1969 values with 168&#215;10 matrices. When i determine timesteps different from 168 with input_shape=(time_steps,data_dim), it causes error such that expected lstm_1_input to have shape (None,24,10) but got array with shape (24000,168,10). Does it mean my sequence will be chain in length of 168 or 24 by determining timesteps as if 168 or 24?Namely 168 timesteps refer 168 lstm units will be in chain with horizontal row?<br />
When i take timesteps 168, it is OK.<br />
Another question,return sequences cause problem in the dataset when i use it?The problem is actually in data dimension mismatch.<br />
My aim was that when i prepared my data with 3d matrix, by specifying timesteps 24, each of my 168&#215;10 values will be fed to chain with length of 24.When i specified batch size say 48, my weights will be updated at then end of 48x168x10 th round in the chain of 24 horizontal lstm units. I tried to use first tensor as days sequence as you expect. However, i failed in these implementations. I am struggling with finding where am i wrong ? I will be glad if you can help me also?<br />
Thanks from now.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444381' data-commentid="444381" data-postid="3882" data-belowelement="comment-444381" data-respondelement="respond" data-replyto="Reply to ibrahim" aria-label='Reply to ibrahim'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444408" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-444408" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 26, 2018 at 7:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444408" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have posts on how to prepare time series data for LSTMs, you can start here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<p>You can output a sequence either as a vector or using an encoder-decoder architecture.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444408' data-commentid="444408" data-postid="3882" data-belowelement="comment-444408" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443981" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-443981" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d54a202047e160e0d5d3fc078fa42510?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d54a202047e160e0d5d3fc078fa42510?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Finn</span>
	                <span class="date">July 20, 2018 at 8:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-443981" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jsaon:<br />
I am doing the univariate lstm, but the result is very bad with more than 300 mse, and I saw your tutorial：<br />
Comment out the line that fits the LSTM model in walk-forward validation:</p>
<p>yhat = forecast_lstm(lstm_model, 1, X)<br />
And replace it with the following:<br />
yhat = y<br />
This should produce a model with perfect skill (e.g. a model that predicts the expected outcome as the model output).</p>
<p>The results should look as follows, showing that if the LSTM model could predict the series perfectly, the inverse transforms and error calculation would show it correctly.</p>
<p>what is this part meaning, why use yhat=y, if use this, the prediction result is the testset, right? which is not the lstm predicted reslut.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-443981' data-commentid="443981" data-postid="3882" data-belowelement="comment-443981" data-respondelement="respond" data-replyto="Reply to Finn" aria-label='Reply to Finn'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444024" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-444024" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 21, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>LSTMs are poor at time series forecasting, I recommend trying classical methods first:<br />
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444024' data-commentid="444024" data-postid="3882" data-belowelement="comment-444024" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444146" class="comment odd alt depth-3">

	      	<div id="li-comment-444146" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9886cf512ed4de548469a6d35e8bae89?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9886cf512ed4de548469a6d35e8bae89?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Finn</span>
	                <span class="date">July 23, 2018 at 3:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Cheers Jason</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444146' data-commentid="444146" data-postid="3882" data-belowelement="comment-444146" data-respondelement="respond" data-replyto="Reply to Finn" aria-label='Reply to Finn'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444810" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-444810" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2fad71235aed7417568d055823a9c6ab?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2fad71235aed7417568d055823a9c6ab?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Awes</span>
	                <span class="date">July 31, 2018 at 12:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444810" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,<br />
So i followed few tutos of yours and i&#8217;m trying to build an LSTM that takes 3 last inputs<br />
Let&#8217;s say my data is as (1,2,3,4,5,6,7,8) so i want that in the prediction i input (1,2,3) and the prediction should be 4 (in the best case).<br />
so here what i did<br />
for the training which i assume is ok </p>
<p>train_reshaped = train_scaled[:, 0:3 ].reshape(len(train_scaled), 1, 3)<br />
lstm_model.predict(train_reshaped, batch_size=2)</p>
<p>and for the test<br />
 X,y= test_scaled[i, 0:3].reshape(1, 1, 3), test_scaled[i, -1]<br />
 yhat = forecast_lstm(lstm_model, 1, X)</p>
<p>here is my test input [[[-0.94936709 -0.97468354 -0.8630137 ]]] # the shape</p>
<p>def forecast_lstm(model, batch_size, X):<br />
    yhat = model.predict(X, batch_size=batch_size)<br />
    return yhat[0,0]</p>
<p>i get this ValueError: could not broadcast input array from shape (2,1) into shape (1,1)</p>
<p>i could not figure it out why its coming</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444810' data-commentid="444810" data-postid="3882" data-belowelement="comment-444810" data-respondelement="respond" data-replyto="Reply to Awes" aria-label='Reply to Awes'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444834" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444834" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 31, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444834" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think the input shape would be (1,3,1) not (1,1,3).</p>
<p>Other than that, I&#8217;m not sure I follow your problem, sorry. Perhaps you can explain the issue another way or give more context?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444834' data-commentid="444834" data-postid="3882" data-belowelement="comment-444834" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445677" class="comment even depth-3">

	      	<div id="li-comment-445677" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2fad71235aed7417568d055823a9c6ab?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2fad71235aed7417568d055823a9c6ab?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Awes</span>
	                <span class="date">August 9, 2018 at 8:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445677" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So what I&#8217;m trying to do is the following.<br />
i have a sequence of timestamp say [1,2,3,4,5,6,7,8,9,10,11]<br />
i want to input the networking [[1],[2],[3]] and it predicts [4] then i slide the window by one [[2],[3],[4]] and it predicts [5] etc</p>
<p>here is the modified code </p>
<p>repeats = 30<br />
error_scores = list()<br />
for r in range(repeats):<br />
    # fit the model<br />
    lstm_model = fit_lstm(train_scaled,1, 500, 3)<br />
    print(&#8216;trained&#8217;,r,&#8217;/30\n&#8217;)<br />
    train_reshaped = train_scaled[:, 0:3 ].reshape(len(train_scaled), 1, 3)<br />
       #print(train_reshaped[0].shape)<br />
    lstm_model.predict(train_reshaped, batch_size=1)<br />
    # walk-forward validation on the test data<br />
    predictions = list()<br />
    for i in range(len(test_scaled)):<br />
        # make one-step forecast<br />
       # X, y = test_scaled[i, 0:3].reshape(1, 1, 3), test_scaled[i, -1]<br />
        X, y = test_scaled[i, 0:3], test_scaled[i, -1]<br />
        yhat = forecast_lstm(lstm_model, 1, X)<br />
        # invert scaling<br />
        yhat = invert_scale(scaler, X, yhat)<br />
        # invert differencing<br />
        #yhat = inverse_difference(raw_values[-10:], yhat, len(test_scaled)+1-i)<br />
        yhat = inverse_difference(raw_values, yhat, len(test_scaled)-i)<br />
        #print(convertToDate(yhat),convertToDate(raw_values[-(len(test_scaled)-i+1)]))<br />
        print(day_diff(yhat,raw_values[-(len(test_scaled)-i+1)]))<br />
        #yhat = inverse_difference(raw_values[-10:], yhat, len(test_scaled)+1-i)<br />
        # store forecast<br />
        predictions.append(yhat/86400)<br />
    # report performance<br />
    ytrue=raw_values[-(len(test_scaled)+1):-1]/86400<br />
    rmse = sqrt(mean_squared_error(ytrue, predictions))<br />
    mae = numpy.sum(numpy.absolute((ytrue/86400, predictions)))<br />
    print(&#8216;%d) Test RMSE: %.3f&#8217; % (r+1, rmse))<br />
    print(&#8216;%d) Test MAE: %.3f&#8217; % (r+1, mae))<br />
    error_scores.append(rmse)<br />
# summarize results<br />
results = DataFrame()<br />
results[&#8216;rmse&#8217;] = error_scoresl<br />
print(results.describe())</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-445677' data-commentid="445677" data-postid="3882" data-belowelement="comment-445677" data-respondelement="respond" data-replyto="Reply to Awes" aria-label='Reply to Awes'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445716" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-445716" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 10, 2018 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds great, this function will help to prepare the data:<br />
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow ugc">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-445716' data-commentid="445716" data-postid="3882" data-belowelement="comment-445716" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445783" class="comment even depth-5">

	      	<div id="li-comment-445783" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2fad71235aed7417568d055823a9c6ab?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2fad71235aed7417568d055823a9c6ab?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Awes</span>
	                <span class="date">August 10, 2018 at 8:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445783" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,<br />
I already did that. So my what I did here is taking timestamps series, make the difference between them (in days), scale those differences and input it to the network. I just wanted to make sure that I input a sequence 3 data points and the network should predict the 4th data point.<br />
Another question is: is it really important to reset the states during the training?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-445815" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-445815" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 11, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445815" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Depends on the problem, generally, I don&#8217;t find the state adding much.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444868" class="comment even thread-even depth-1">

	      	<div id="li-comment-444868" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/cccbe269d6a033fe7e5d2a94f4c18224?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cccbe269d6a033fe7e5d2a94f4c18224?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jiapeng Yuan</span>
	                <span class="date">July 31, 2018 at 11:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444868" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello Jason, could you please explain why the LSTM seems lagged (based on blue and orange line)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444868' data-commentid="444868" data-postid="3882" data-belowelement="comment-444868" data-respondelement="respond" data-replyto="Reply to Jiapeng Yuan" aria-label='Reply to Jiapeng Yuan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444888" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444888" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 31, 2018 at 2:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-444888" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Bad performance. E.g. it has learned a persistence model.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-444888' data-commentid="444888" data-postid="3882" data-belowelement="comment-444888" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445130" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-445130" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e70eb4744c53304bab16457deae6e130?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e70eb4744c53304bab16457deae6e130?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jingfei</span>
	                <span class="date">August 3, 2018 at 10:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445130" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,  While I am checking your multi-step prediction, I am wondering if you feed your predicted value back for next step prediction, it might result in passing the inaccurate data to the next step and causing the whole result inaccurate.  Is there any technique to minimize this side effect?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-445130' data-commentid="445130" data-postid="3882" data-belowelement="comment-445130" data-respondelement="respond" data-replyto="Reply to Jingfei" aria-label='Reply to Jingfei'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445140" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-445140" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 3, 2018 at 2:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445140" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is called an iterative or recursive model.</p>
<p>An alternative with neural networks is to forecast the multiple steps directly as a vector.</p>
<p>Perhaps this post will help to understand the difference between recursive and direct multi-step forecasting:<br />
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-445140' data-commentid="445140" data-postid="3882" data-belowelement="comment-445140" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445212" class="comment even depth-3">

	      	<div id="li-comment-445212" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e70eb4744c53304bab16457deae6e130?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e70eb4744c53304bab16457deae6e130?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jingfei</span>
	                <span class="date">August 4, 2018 at 10:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445212" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much for your hint. It&#8217;s been very help. Do you have more tutorial about modeling building stratergies like using multiple datasets to build a model and make use of different activation and regulation to find the best way to improve the model behavior? or you have any book on this topic?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-445212' data-commentid="445212" data-postid="3882" data-belowelement="comment-445212" data-respondelement="respond" data-replyto="Reply to Jingfei" aria-label='Reply to Jingfei'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445255" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-445255" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 5, 2018 at 5:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-445255" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This general process might help:<br />
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#process</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-445255' data-commentid="445255" data-postid="3882" data-belowelement="comment-445255" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447161" class="comment even thread-even depth-1">

	      	<div id="li-comment-447161" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ce94c841914f2d4e5323073244e86cfb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ce94c841914f2d4e5323073244e86cfb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Oleg Iegorov</span>
	                <span class="date">August 29, 2018 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-447161" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>This phrase seems to be false &#8220;By default, an LSTM layer in Keras maintains state between data within one batch&#8221;. According to Keras documentation, samples withtin a batch are processed independently.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-447161' data-commentid="447161" data-postid="3882" data-belowelement="comment-447161" data-respondelement="respond" data-replyto="Reply to Oleg Iegorov" aria-label='Reply to Oleg Iegorov'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447192" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-447192" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 29, 2018 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-447192" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why do you say that? Can you point to a reference?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-447192' data-commentid="447192" data-postid="3882" data-belowelement="comment-447192" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447247" class="comment even depth-3">

	      	<div id="li-comment-447247" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ce94c841914f2d4e5323073244e86cfb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ce94c841914f2d4e5323073244e86cfb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Oleg Iegorov</span>
	                <span class="date">August 30, 2018 at 12:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-447247" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, here <a href="https://keras.io/getting-started/faq/#what-does-sample-batch-epoch-mean" rel="nofollow ugc">https://keras.io/getting-started/faq/#what-does-sample-batch-epoch-mean</a><br />
&#8220;Batch: a set of N samples. The samples in a batch are processed independently, in parallel.&#8221;</p>
<p>I&#8217;m new to neural networks and was curious to see how RNNs can help in detecting anomalies in time series. In my current understanding, the only Keras setup that would allow an LSTM to learn arbitrarily long dependencies is to have one neuron in the input layer, use batch_size=1 and specify stateful=True</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-447247' data-commentid="447247" data-postid="3882" data-belowelement="comment-447247" data-respondelement="respond" data-replyto="Reply to Oleg Iegorov" aria-label='Reply to Oleg Iegorov'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447278" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-447278" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 30, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-447278" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice find. You could be right, but I&#8217;m not convinced that applies to an RNN.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-447278' data-commentid="447278" data-postid="3882" data-belowelement="comment-447278" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447915" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-447915" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fb17e6c50364be11dec338e9da42d081?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fb17e6c50364be11dec338e9da42d081?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.360doc.com/content/16/0727/10/30824912_578703968.shtml' rel='external nofollow ugc' class='url'>Andrew Jidw</a></span>
	                <span class="date">September 5, 2018 at 6:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-447915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, I would like to ask, if the time series itself is stable, I need to establish a persistence model. After the establishment, I found that the performance is better than LSTM.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-447915' data-commentid="447915" data-postid="3882" data-belowelement="comment-447915" data-respondelement="respond" data-replyto="Reply to Andrew Jidw" aria-label='Reply to Andrew Jidw'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447949" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-447949" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 6, 2018 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-447949" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is often the case. Try a suite of other methods like MLPs, CNNs and hybrids. Also try classical methods like SARIMA and ETS.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-447949' data-commentid="447949" data-postid="3882" data-belowelement="comment-447949" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449209" class="comment even thread-even depth-1">

	      	<div id="li-comment-449209" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d5ee2df4e85fd56b08868e0c92904a51?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5ee2df4e85fd56b08868e0c92904a51?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Geeta</span>
	                <span class="date">September 18, 2018 at 11:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449209" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>If we want to apply this to log analytics, how can we transform the data and apply to Time Series and NN</p>
<p>Thanks,<br />
Geeta</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449209' data-commentid="449209" data-postid="3882" data-belowelement="comment-449209" data-respondelement="respond" data-replyto="Reply to Geeta" aria-label='Reply to Geeta'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449225" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-449225" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 18, 2018 at 2:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on the logs. </p>
<p>You will likely have to write code to make your data clean and ready for modeling.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449225' data-commentid="449225" data-postid="3882" data-belowelement="comment-449225" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449249" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-449249" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7227aa6c39b7d946012749a64e7c2313?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7227aa6c39b7d946012749a64e7c2313?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Suker</span>
	                <span class="date">September 18, 2018 at 6:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449249" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>      I&#8217;m not clear that is this problem itself a destined to be overfitted? Should we initially consider LSTM to solve such problems?</p>
<p>Thanks,<br />
Suker</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449249' data-commentid="449249" data-postid="3882" data-belowelement="comment-449249" data-respondelement="respond" data-replyto="Reply to Suker" aria-label='Reply to Suker'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449287" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-449287" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 19, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449287" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, LSTMs are terrible at univariate time series forecasting and are easily out-performed by SARIMA and ETS.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449287' data-commentid="449287" data-postid="3882" data-belowelement="comment-449287" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449518" class="comment even thread-even depth-1">

	      	<div id="li-comment-449518" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/32afb331b597c8bcfb7885f366a750f2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/32afb331b597c8bcfb7885f366a750f2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">via</span>
	                <span class="date">September 22, 2018 at 12:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449518" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello!</p>
<p>Why did you reverse he order in this line:<br />
X, y = train[:, 0:-1], train[:, -1]</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449518' data-commentid="449518" data-postid="3882" data-belowelement="comment-449518" data-respondelement="respond" data-replyto="Reply to via" aria-label='Reply to via'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449541" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-449541" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 22, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449541" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t follow, where exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449541' data-commentid="449541" data-postid="3882" data-belowelement="comment-449541" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449708" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-449708" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/99ba73ace9082dd2b93917c048fd5b12?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/99ba73ace9082dd2b93917c048fd5b12?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Melania</span>
	                <span class="date">September 25, 2018 at 1:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you for your explanation,</p>
<p>My question, at this level and after evaluating the model, is to know how to predict and visualize some values in the future.<br />
Otherwise, How visualize the value t + 1 which follows the last value of the data base</p>
<p>thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449708' data-commentid="449708" data-postid="3882" data-belowelement="comment-449708" data-respondelement="respond" data-replyto="Reply to Melania" aria-label='Reply to Melania'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449733" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-449733" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 25, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-449733" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The tutorial shows how to plot y vs yhat.</p>
<p>What problem are you having exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-449733' data-commentid="449733" data-postid="3882" data-belowelement="comment-449733" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-450943" class="comment even thread-even depth-1">

	      	<div id="li-comment-450943" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/08cedd7fe5c1e1dd03b885341bebc5c2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/08cedd7fe5c1e1dd03b885341bebc5c2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tyra Nguyen</span>
	                <span class="date">October 8, 2018 at 3:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-450943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thank for your tutorial, I love it!<br />
I have some questions:<br />
1. I wonder whether LSTM can forecast prices of cryptocurrency in the future.<br />
2. May I use the historical data to forecast? I plan to do this but I&#8217;m still not sure about the result.<br />
3. I see many people use ARIMA to do this, so can you give me some reasons why LSTM is better than ARIMA.<br />
Sorry for my lack of knowledge. I hope to receive your answer.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-450943' data-commentid="450943" data-postid="3882" data-belowelement="comment-450943" data-respondelement="respond" data-replyto="Reply to Tyra Nguyen" aria-label='Reply to Tyra Nguyen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450967" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-450967" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 8, 2018 at 9:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-450967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can develop a model to forecast anything you like. I don&#8217;t know if crypto prices are predictable, I suspect that are a random walk.</p>
<p>By definition, a skillful forecasting model will make use of historical data to predict the future.</p>
<p>Perhaps this will help:<br />
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-450967' data-commentid="450967" data-postid="3882" data-belowelement="comment-450967" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451930" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-451930" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5bf1166fc2dc94c71dec8842a4392c0d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5bf1166fc2dc94c71dec8842a4392c0d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Theekshana</span>
	                <span class="date">October 18, 2018 at 2:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-451930" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jenson,</p>
<p>Can these LTSM neural networks preserve multiple time series variation patterns?  In my project, I have a set of different time series variation patterns. So, the thing I want to know is that, </p>
<p>1. Are LTSM networks capable of identifying the correct pattern (from all the patterns) and then predict the next value accordingly (given the previous variations x(i-1),x(i-2) as supervised learning problem)</p>
<p>2. If not, what will be a solution to this type of problem (Time series pattern identification and prediction)</p>
<p>Can you please give me some guidelines. </p>
<p>Thank you for the tutorials. They were really helpful. !! 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-451930' data-commentid="451930" data-postid="3882" data-belowelement="comment-451930" data-respondelement="respond" data-replyto="Reply to Theekshana" aria-label='Reply to Theekshana'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451952" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451952" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 18, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-451952" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but LSTMs are terrible at time series forecasting. Try MLPs, CNNs and hybrid models as well.</p>
<p>Checkout this tutorial:<br />
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-451952' data-commentid="451952" data-postid="3882" data-belowelement="comment-451952" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452742" class="comment even depth-3">

	      	<div id="li-comment-452742" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ebb61750944eed5ad8d6b554db29d4d1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ebb61750944eed5ad8d6b554db29d4d1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Charles Yu</span>
	                <span class="date">October 26, 2018 at 3:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-452742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Is there any tutorial about single (categorical) variable, LSTM time series forecasting?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-452742' data-commentid="452742" data-postid="3882" data-belowelement="comment-452742" data-respondelement="respond" data-replyto="Reply to Charles Yu" aria-label='Reply to Charles Yu'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452765" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-452765" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 26, 2018 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-452765" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe you are referring to time series classification.</p>
<p>I have an example of time series classification with LSTMs here:<br />
<a href="https://machinelearningmastery.com/how-to-develop-rnn-models-for-human-activity-recognition-time-series-classification/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-rnn-models-for-human-activity-recognition-time-series-classification/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-452765' data-commentid="452765" data-postid="3882" data-belowelement="comment-452765" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452743" class="comment even thread-even depth-1">

	      	<div id="li-comment-452743" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ebb61750944eed5ad8d6b554db29d4d1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ebb61750944eed5ad8d6b554db29d4d1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Charles Yu</span>
	                <span class="date">October 26, 2018 at 3:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-452743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>For categorical variable LSTM based forecasting, the requirement is as follows:</p>
<p>I want to forecast what a person&#8217;s doing @ 10:00AM in some day (weekday) so I collected his doing from day 1 to day n. All of them are in the weekdays. Then, if I want to forecast his doing @ day (n+1) @ 10:00AM. How to do that? Is there any related tutorial in your posting?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-452743' data-commentid="452743" data-postid="3882" data-belowelement="comment-452743" data-respondelement="respond" data-replyto="Reply to Charles Yu" aria-label='Reply to Charles Yu'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452766" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-452766" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 26, 2018 at 5:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-452766" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I believe the time series activity recognition is a close fit for what you want:<br />
<a href="https://machinelearningmastery.com/how-to-develop-rnn-models-for-human-activity-recognition-time-series-classification/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-rnn-models-for-human-activity-recognition-time-series-classification/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-452766' data-commentid="452766" data-postid="3882" data-belowelement="comment-452766" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454781" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-454781" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d4219d9a8164c0ed0477d3a23672fb16?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d4219d9a8164c0ed0477d3a23672fb16?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Devakar Kumar Verma</span>
	                <span class="date">November 15, 2018 at 12:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-454781" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>At the time of training the model, we are resetting the state after each epoch </p>
<p><code></code><code><br />
for i in range(nb_epoch):<br />
		model.fit(X, y, epochs=1, batch_size=batch_size, verbose=0, shuffle=False)<br />
		model.reset_states()<br />
</code><code></code></p>
<p>But, if we want to reduce the learning rate at the time of training by using a callback, &#8220;ReduceLROnPlateau&#8221; defined in keras. The learning rate always becomes constant with the initial value that keras provides due to the resetting of all the parameters. Hence, there is a high probability to get less optimal minima.</p>
<p>What are your views on this?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-454781' data-commentid="454781" data-postid="3882" data-belowelement="comment-454781" data-respondelement="respond" data-replyto="Reply to Devakar Kumar Verma" aria-label='Reply to Devakar Kumar Verma'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454805" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454805" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 15, 2018 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-454805" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can calculate a new learning rate for each epoch manually.</p>
<p>Alternately, you can reset the network state via a callback and use the built in learning rate schedule.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-454805' data-commentid="454805" data-postid="3882" data-belowelement="comment-454805" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454877" class="comment even depth-3">

	      	<div id="li-comment-454877" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d4219d9a8164c0ed0477d3a23672fb16?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d4219d9a8164c0ed0477d3a23672fb16?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Devakar Kumar Verma</span>
	                <span class="date">November 15, 2018 at 7:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-454877" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
As per your implementation learning rate is constant at 0.001 after every epoch, due to initialization of Adam optimizer in keras<br />
<code></code><code><br />
keras.optimizers.Adam(lr=0.001, beta_1=0.9, beta_2=0.999, epsilon=None, decay=0.0, amsgrad=False)<br />
</code><code></code></p>
<p>From your second point, you mean to have the learning rate scheduler which operates on begin_of_epoch.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-454877' data-commentid="454877" data-postid="3882" data-belowelement="comment-454877" data-respondelement="respond" data-replyto="Reply to Devakar Kumar Verma" aria-label='Reply to Devakar Kumar Verma'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454927" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-454927" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 16, 2018 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-454927" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not sure I follow, can you elaborate?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-454927' data-commentid="454927" data-postid="3882" data-belowelement="comment-454927" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458166" class="comment even thread-even depth-1">

	      	<div id="li-comment-458166" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fda5f1787e764f8a4c0b7ba80e7be001?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fda5f1787e764f8a4c0b7ba80e7be001?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">mk</span>
	                <span class="date">December 11, 2018 at 7:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-458166" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
I ran your program ,but,epoch is 23 during trainning.I set epoch 100，epoch is  still 23 during trainning.I&#8217;m a little confused.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-458166' data-commentid="458166" data-postid="3882" data-belowelement="comment-458166" data-respondelement="respond" data-replyto="Reply to mk" aria-label='Reply to mk'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458217" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-458217" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 12, 2018 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-458217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here that might help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<p>And some suggestions related to debugging here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-458217' data-commentid="458217" data-postid="3882" data-belowelement="comment-458217" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458606" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-458606" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3673d6f059681dbe6aa5610389910c07?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3673d6f059681dbe6aa5610389910c07?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muhammad Akbar Almuttaqin</span>
	                <span class="date">December 15, 2018 at 5:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-458606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>I am now working in a project that involves a time series data and considering LSTM method. It came to my mind, how could LSTM performs better than any other model if LSTM is only taking the historical data alone and neglect any other attributes?<br />
For example, in this case we are dealing with the price of a product. The only variable that LSTM takes is the historical price of milk. How could it outperform other model, such as a simple multivariate linear regression, that considers many other factors too?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-458606' data-commentid="458606" data-postid="3882" data-belowelement="comment-458606" data-respondelement="respond" data-replyto="Reply to Muhammad Akbar Almuttaqin" aria-label='Reply to Muhammad Akbar Almuttaqin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458679" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-458679" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 16, 2018 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-458679" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally LSTMs do not perform well on time series forecasting problems.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-458679' data-commentid="458679" data-postid="3882" data-belowelement="comment-458679" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459386" class="comment even thread-even depth-1">

	      	<div id="li-comment-459386" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0816eda6115f1ea67b78eca8060be47f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0816eda6115f1ea67b78eca8060be47f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony</span>
	                <span class="date">December 21, 2018 at 3:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-459386" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, can I edit the function &#8216;def forecast_lstm(model, batch_size, X)&#8217;,<br />
in the line 75, in Complete lstm Example,<br />
before &#8216;yhat = model.predict(X, batch_size=batch_size)&#8217;<br />
to use a previously saved model with model.save(&#8216;Lstm_model.h5 &#8216;),<br />
or where can I edit anywhere else? Thank you very much</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-459386' data-commentid="459386" data-postid="3882" data-belowelement="comment-459386" data-respondelement="respond" data-replyto="Reply to Anthony" aria-label='Reply to Anthony'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459407" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-459407" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 21, 2018 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-459407" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-459407' data-commentid="459407" data-postid="3882" data-belowelement="comment-459407" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459427" class="comment even depth-3">

	      	<div id="li-comment-459427" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0816eda6115f1ea67b78eca8060be47f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0816eda6115f1ea67b78eca8060be47f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony</span>
	                <span class="date">December 21, 2018 at 10:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-459427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excuse me, and then in which step need I edit in Complete lstm Example to use a previously saved model with model.save(‘Lstm_model.h5 ‘) ?  is there an example? Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-459427' data-commentid="459427" data-postid="3882" data-belowelement="comment-459427" data-respondelement="respond" data-replyto="Reply to Anthony" aria-label='Reply to Anthony'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459452" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-459452" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 21, 2018 at 3:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-459452" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, Id on&#8217;t have the capacity to customize the example for you.</p>
<p>Perhaps try getting familiar with the API first:<br />
<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow ugc">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-459452' data-commentid="459452" data-postid="3882" data-belowelement="comment-459452" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-460248" class="comment even depth-5">

	      	<div id="li-comment-460248" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0816eda6115f1ea67b78eca8060be47f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0816eda6115f1ea67b78eca8060be47f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony</span>
	                <span class="date">December 27, 2018 at 11:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-460248" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, of course, you are right, but I just meant in Complete LSTM Example, to replace the line 98 lstm_model = fit_lstm(train_scaled, 1, 3000, 4)  with lstm_model = load_model(&#8216;lstm_model.h5&#8217;), as you did with ARIMA, here <a href="https://machinelearningmastery.com/time-series-forecast-study-python-annual-water-usage-baltimore/" rel="nofollow ugc">https://machinelearningmastery.com/time-series-forecast-study-python-annual-water-usage-baltimore/</a> in the line 15, at the section 7.3, what do you think about it? Thank you very much</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-460370" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-460370" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 28, 2018 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-460370" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can load instead of re-fit a model. </p>
<p>I don&#8217;t have the capacity to advise you on how to best modify the code example for your requirements &#8211; likely a one line change would be insufficient.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464417" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-464417" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/478abb668237771d630adb987fb5bfee?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/478abb668237771d630adb987fb5bfee?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">venkat chana</span>
	                <span class="date">January 21, 2019 at 11:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-464417" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jeson at the section &#8220;Complete LSTM Example&#8221;, what should I edit in the code to change the batch_size? Please could you give me an example?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-464417' data-commentid="464417" data-postid="3882" data-belowelement="comment-464417" data-respondelement="respond" data-replyto="Reply to venkat chana" aria-label='Reply to venkat chana'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464423" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-464423" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 21, 2019 at 12:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-464423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Specify the batch_size argument to the fit() function.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-464423' data-commentid="464423" data-postid="3882" data-belowelement="comment-464423" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464482" class="comment even depth-3">

	      	<div id="li-comment-464482" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/478abb668237771d630adb987fb5bfee?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/478abb668237771d630adb987fb5bfee?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">venkat chana</span>
	                <span class="date">January 22, 2019 at 2:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-464482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jeson , sorry to disturb,<br />
In the code &#8220;Complete LSTM Example&#8221; I used another dataset and 5 is a factor both of the size of the training and test datasets.</p>
<p>so I changed<br />
the line 98: lstm_model = fit_lstm(train_scaled, 1, 3000, 4)<br />
to: lstm_model = fit_lstm(train_scaled, 5, 3000, 4) </p>
<p>the line 101:  lstm_model.predict(train_reshaped, batch_size=1)<br />
to: lstm_model.predict(train_reshaped, batch_size=5)</p>
<p>the line 108: yhat = forecast_lstm(lstm_model, 1, X)<br />
to: yhat = forecast_lstm(lstm_model, 5, X) </p>
<p>but I got this error:<br />
ValueError: could not broadcast input array from shape (5,1) into shape (1,1)<br />
at the line 77 yhat = model.predict(X, batch_size=batch_size)</p>
<p>might you help me to fix this bug? Thank you</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-464482' data-commentid="464482" data-postid="3882" data-belowelement="comment-464482" data-respondelement="respond" data-replyto="Reply to venkat chana" aria-label='Reply to venkat chana'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464514" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-464514" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 22, 2019 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-464514" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-464514' data-commentid="464514" data-postid="3882" data-belowelement="comment-464514" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464535" class="comment even depth-5">

	      	<div id="li-comment-464535" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/478abb668237771d630adb987fb5bfee?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/478abb668237771d630adb987fb5bfee?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">venkat chana</span>
	                <span class="date">January 22, 2019 at 10:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-464535" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, of course, you don&#8217;t have to write the code for me or fix my bugs, I just wanted to change the batch_size from 1 to another number, I just wanted a clarification that I have not understood well by reading your code. Thank you 🙂</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465330" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-465330" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d2893363d5269b67d4f1e9e3cd725b8b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d2893363d5269b67d4f1e9e3cd725b8b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Julius</span>
	                <span class="date">January 28, 2019 at 10:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-465330" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi  Jason,<br />
I&#8217;m a bit confused about the input shape.</p>
<p>Let&#8217;s say I&#8217;ve got 2500 time series of class A, and 2500 time series of class B, both 1000 time steps long. There is only one numerical feature per time series. I want to train a LSTM using Keras to classify the time series into one of the two classes. They can be easily distinguished using features which require the LSTM to understand the time correlation between the data, like one class has a seasonal pattern, while the other hasn&#8217;t. Therefore I guess I need to use a stateful LSTM, and therefore call model.reset_states() manually right?</p>
<p>But I&#8217;m totally confused about how to construct the input_dimensions for Keras.</p>
<p>As far as I understand it the input for the LSTM is defined as (samples, time steps, features).</p>
<p>Is my X now (5000,1000,1) and I call model.fit() exactly once? When do I call model.reset_states()?</p>
<p>Or do I show the time series each time step at a time, so my input is (1,1,1) and I just show it then 5000 times for each time series 1000 times per each time step the single feature, so call model.fit() 5,000,000 times?! I would then call after I&#8217;m finished with one time series the model.reset_states() method to forget everything for the new time series? That is the version you&#8217;ve been using in this tutorial?</p>
<p>Or is it (1,1000,1), and I call model.reset_states() after calling fit() 5000 times (per time series)?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-465330' data-commentid="465330" data-postid="3882" data-belowelement="comment-465330" data-respondelement="respond" data-replyto="Reply to Julius" aria-label='Reply to Julius'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465375" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-465375" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 29, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-465375" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-465375' data-commentid="465375" data-postid="3882" data-belowelement="comment-465375" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465436" class="comment odd alt depth-3">

	      	<div id="li-comment-465436" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d2893363d5269b67d4f1e9e3cd725b8b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d2893363d5269b67d4f1e9e3cd725b8b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Julius</span>
	                <span class="date">January 29, 2019 at 9:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-465436" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, that really helped a lot!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-465436' data-commentid="465436" data-postid="3882" data-belowelement="comment-465436" data-respondelement="respond" data-replyto="Reply to Julius" aria-label='Reply to Julius'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-465447" class="comment even depth-3">

	      	<div id="li-comment-465447" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d2893363d5269b67d4f1e9e3cd725b8b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d2893363d5269b67d4f1e9e3cd725b8b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Julius</span>
	                <span class="date">January 30, 2019 at 12:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-465447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok, I&#8217;m lost again. Let&#8217;s say I&#8217;ve got an LSTM input of (25, 1000,2), so a batch size of 25, 1000 time steps and 2 features. To construct the training X I take 25 time series of different labels and put them together in one batch. After training I want to ask the LSTM to classify one time series. But because I&#8217;ve specified a batch size of 25 I now always need to show it 25 timeseries?!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-465447' data-commentid="465447" data-postid="3882" data-belowelement="comment-465447" data-respondelement="respond" data-replyto="Reply to Julius" aria-label='Reply to Julius'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465491" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-465491" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 30, 2019 at 8:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-465491" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, you can make a prediction for one sample [1,1000,2]</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-465491' data-commentid="465491" data-postid="3882" data-belowelement="comment-465491" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467692" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-467692" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/25db7367dc1be44bff8e6dada93ce84d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/25db7367dc1be44bff8e6dada93ce84d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">February 10, 2019 at 11:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-467692" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, Jason, thanks for your excellent tutorial!<br />
Now I am confused about some places of LSTM in Keras.<br />
Hope you have time to answer those questions! Thanks in advance!</p>
<p>Assumed that there is a time series data set with two variables and one output. The data set is not continuous so it can be actually seen as a group of two independent sequences. Every sequence is not the same length. One has 100 data points and another one has only 50 data points. I want to use the sequence with 100 data points as the training data set and the rest sequence as the test data set.</p>
<p>The first one: Should I use stateful LSTM or stateless LSTM? By the way, it seems that when having only one continuous sequence, we should select stateful LSTM, right?</p>
<p>The second one: How should I deal with the inputs with different length? </p>
<p>Thank you again!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467692' data-commentid="467692" data-postid="3882" data-belowelement="comment-467692" data-respondelement="respond" data-replyto="Reply to Jack" aria-label='Reply to Jack'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467731" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-467731" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 11, 2019 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-467731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Start with stateless and try stateful to see if it makes a difference.</p>
<p>Use padding to make all input the same length:<br />
<a href="https://machinelearningmastery.com/data-preparation-variable-length-input-sequences-sequence-prediction/" rel="nofollow ugc">https://machinelearningmastery.com/data-preparation-variable-length-input-sequences-sequence-prediction/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467731' data-commentid="467731" data-postid="3882" data-belowelement="comment-467731" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467753" class="comment even depth-3">

	      	<div id="li-comment-467753" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/172166e1eee4e2f2ad1dc783dae78e77?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/172166e1eee4e2f2ad1dc783dae78e77?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">February 11, 2019 at 12:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-467753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your prompt reply! You are so nice! I will try some experiments.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467753' data-commentid="467753" data-postid="3882" data-belowelement="comment-467753" data-respondelement="respond" data-replyto="Reply to Jack" aria-label='Reply to Jack'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467777" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-467777" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/172166e1eee4e2f2ad1dc783dae78e77?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/172166e1eee4e2f2ad1dc783dae78e77?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">February 11, 2019 at 6:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-467777" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, Jason. Now I am doing some experiments and I have another question now.</p>
<p>Let&#8217;s say that I want to use the Many-to-Many architecture to predict one output y(t) for one input x(t) at every same time step. So both the input and output data will be a sequence of data. Assumed that I have 50 sequences of data for input and output data, respectively. The maximum length of a sequence of input data or output data is fixed to 100 and padding is used to make all sequences the same length (100).</p>
<p>The question is: the input shape required by Keras (samples, time steps) should be (50, 100), right?</p>
<p>Thanks for your reply in advance!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467777' data-commentid="467777" data-postid="3882" data-belowelement="comment-467777" data-respondelement="respond" data-replyto="Reply to Jack" aria-label='Reply to Jack'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467898" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-467898" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 12, 2019 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-467898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you want to predict one output for one input, then this would be one-to-one.</p>
<p>I have tons of help on how to shape data, start here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467898' data-commentid="467898" data-postid="3882" data-belowelement="comment-467898" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467978" class="comment odd alt depth-3">

	      	<div id="li-comment-467978" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/172166e1eee4e2f2ad1dc783dae78e77?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/172166e1eee4e2f2ad1dc783dae78e77?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">February 12, 2019 at 3:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-467978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply.</p>
<p>Actually I have read the website before. It is very helpful. However, I still feel confused about the below paragraph. </p>
<p>&#8220;As another example, if you have 20 time steps of data for 2 features, you might represent it as 20 samples with 1 time step [20, 1, 2] or as 1 sample with 20 time steps [1, 20, 2]. In the first case, you will have 20 samples, meaning 20 input and output examples and your model will make 20 predictions. In the latter case, you have 1 sample, with 1 input and 1 output and the model will make 1 prediction that is accumulated over 20 time steps.&#8221;</p>
<p>I understand the first case. However, in the second case, you say that we have only one output to be predicted. Which time step will the output be calculated and output at? It is at the last time step (20th time step)?</p>
<p>As for the architecture of LSTM, the below website shows it. X has two features, and Y is a scalar. I want to predict one x for one y at every same time step. I think it is many-to-many, isn&#8217;t it?<br />
<a href="https://www.dropbox.com/s/e8zp520iz6lpk89/RNN.png?dl=0" rel="nofollow ugc">https://www.dropbox.com/s/e8zp520iz6lpk89/RNN.png?dl=0</a></p>
<p>Thanks for your help! I really appreciate it! Thanks again!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467978' data-commentid="467978" data-postid="3882" data-belowelement="comment-467978" data-respondelement="respond" data-replyto="Reply to Jack" aria-label='Reply to Jack'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468050" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-468050" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 13, 2019 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-468050" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct, the output is predicted at the end of the sequence for the input sample (after last time step).</p>
<p>If you want to make a prediction for each time step, this would be one-to-one (one lag ob to one forecast ob) or many-to-one (e.g. many lag obs to one forecast ob). ob is shorthand for observation, in case I was confusing.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-468050' data-commentid="468050" data-postid="3882" data-belowelement="comment-468050" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467970" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-467970" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d465fec7fe005b3c295998a5b6888319?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d465fec7fe005b3c295998a5b6888319?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">dyy</span>
	                <span class="date">February 12, 2019 at 2:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-467970" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!</p>
<p>what if the data contains seasonality which is also anomaly that carry significant information to the domain? Do i need to difference it as well?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467970' data-commentid="467970" data-postid="3882" data-belowelement="comment-467970" data-respondelement="respond" data-replyto="Reply to dyy" aria-label='Reply to dyy'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468047" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-468047" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 13, 2019 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-468047" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the series contains a seasonal structure, remove it from the series and model the residual. </p>
<p>This is called a seasonal adjustment:<br />
<a href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="nofollow ugc">https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-468047' data-commentid="468047" data-postid="3882" data-belowelement="comment-468047" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-468547" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-468547" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6af61054e7b4e941c0ff4ff51ed0c6ee?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6af61054e7b4e941c0ff4ff51ed0c6ee?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">YN</span>
	                <span class="date">February 15, 2019 at 8:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-468547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I was following your steps and testing some synthetic data with straightforward patterns such as (0,0,0,&#8230;,0,1) repeated n times. I was trying to see if LSTM network can learn such patterns with long range dependency and make correct predictions moving forward. It turns out that the optimizer often gets stuck at poor local minimums, even though I tried different learning rates. Instead, if I use the training sequence as a time-series and set the batch_input_shape to be (1, seq_length, n_lags), the training becomes much easier and converges much faster. Do you expect treating training data as one sample multiple steps to be better than as multiple samples one step in general? Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-468547' data-commentid="468547" data-postid="3882" data-belowelement="comment-468547" data-respondelement="respond" data-replyto="Reply to YN" aria-label='Reply to YN'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468599" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-468599" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 15, 2019 at 2:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-468599" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It really depends on the problem.</p>
<p>For example, I show how using 1 time step samples, the LSTM can remember across samples:<br />
<a href="https://machinelearningmastery.com/memory-in-a-long-short-term-memory-network/" rel="nofollow ugc">https://machinelearningmastery.com/memory-in-a-long-short-term-memory-network/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-468599' data-commentid="468599" data-postid="3882" data-belowelement="comment-468599" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-471718" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-471718" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ba75bf19b73c8dbf33124128f640412c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba75bf19b73c8dbf33124128f640412c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rushikesh Khot</span>
	                <span class="date">March 2, 2019 at 11:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-471718" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>X, y = train[:,0:-1], train[:,-1]<br />
X = X.reshape(X.shape[0], 1, X.shape[1])</p>
<p>IError:<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;<br />
IndexError                                Traceback (most recent call last)<br />
 in<br />
&#8212;-&gt; 1 X, y = train[:,0:-1], train[:,-1]<br />
      2 X = X.reshape(X.shape[0], 1, X.shape[1])</p>
<p>IndexError: too many indices for array</p>
<p>I am getting an error as above. Can you help me with this Jason??<br />
​</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-471718' data-commentid="471718" data-postid="3882" data-belowelement="comment-471718" data-respondelement="respond" data-replyto="Reply to Rushikesh Khot" aria-label='Reply to Rushikesh Khot'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-471816" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-471816" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 3, 2019 at 8:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-471816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, I have some suggestions here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-471816' data-commentid="471816" data-postid="3882" data-belowelement="comment-471816" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472531" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-472531" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/04c8ff125b4d91cc822c15824f06f88f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/04c8ff125b4d91cc822c15824f06f88f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joshua</span>
	                <span class="date">March 5, 2019 at 7:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-472531" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!</p>
<p>I have to say, really interesting blog. I&#8217;m recently starting a new project and I&#8217;m new with LSTM (actually still kind of new with NNs ). This is why I&#8217;d like to ask you for advice: My problem is similar to the one on this blog, but instead of having a dataset which is a vector with length 36, I have around 500 vectors with length 8, therefore, instead of training with only 1 vector, I&#8217;d like to train with many of them and then test with many others. </p>
<p>Particularly, I&#8217;d like to train a model to predict the last 3-4 entries of each vector. For this, I&#8217;m thinking of using ~300 vectors for training, and then use the other 200 to test the predictions of the last 3-4 entries of each vector. </p>
<p>Could you give me any recommendation/link of how to proceed? </p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472531' data-commentid="472531" data-postid="3882" data-belowelement="comment-472531" data-respondelement="respond" data-replyto="Reply to Joshua" aria-label='Reply to Joshua'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472691" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-472691" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 6, 2019 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-472691" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds reasonable.</p>
<p>Yes I have tens of tutorials that will help you with this, get started here:<br />
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472691' data-commentid="472691" data-postid="3882" data-belowelement="comment-472691" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472869" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-472869" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8c5fc6d2851f604bdb5c593c40bbd54c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8c5fc6d2851f604bdb5c593c40bbd54c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luan</span>
	                <span class="date">March 6, 2019 at 8:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-472869" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason great job &#8211; </p>
<p>One question, do you have any similar tutorial to use LSTM where the time steps are taken at variable times and so they are not uniform distributed?</p>
<p>Best!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472869' data-commentid="472869" data-postid="3882" data-belowelement="comment-472869" data-respondelement="respond" data-replyto="Reply to Luan" aria-label='Reply to Luan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472936" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-472936" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 7, 2019 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-472936" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No. But perhaps the model does not care. You can try modeling with variable input time steps, or try padding with zeros, or try resampling so they are consistent &#8211; then compare the results of each approach?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472936' data-commentid="472936" data-postid="3882" data-belowelement="comment-472936" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-473056" class="comment odd alt depth-3">

	      	<div id="li-comment-473056" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8c5fc6d2851f604bdb5c593c40bbd54c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8c5fc6d2851f604bdb5c593c40bbd54c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luan</span>
	                <span class="date">March 7, 2019 at 10:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-473056" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean by &#8216;variable input time steps&#8217;? </p>
<p>As far as I know, the time steps need to be fix when constructing the network, since it is required for the batch_input_shape parameter of the LSTM layer. Or am I wrong?</p>
<p>Thx!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-473056' data-commentid="473056" data-postid="3882" data-belowelement="comment-473056" data-respondelement="respond" data-replyto="Reply to Luan" aria-label='Reply to Luan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-473119" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-473119" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 8, 2019 at 7:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-473119" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They can vary, but you can fill the gaps with zeros, you can pretend the time steps are evenly spaced when they&#8217;re not, you can truncate or resample the time series, you have many options.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-473119' data-commentid="473119" data-postid="3882" data-belowelement="comment-473119" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-473631" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-473631" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02a70aa8d1e1b4abf10e3452bfb40aa6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02a70aa8d1e1b4abf10e3452bfb40aa6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Duc</span>
	                <span class="date">March 11, 2019 at 11:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-473631" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for very useful implementation. I would have a following question.</p>
<p>I trained the LSTM model on train data with batch_size = 32. Then I tried do prediction with the test data using the learned model with batch_size = 1 but it does not work.</p>
<p>Is it required to set the batch_size = 1 (in both training and prediction) to to make one-step forecasts?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-473631' data-commentid="473631" data-postid="3882" data-belowelement="comment-473631" data-respondelement="respond" data-replyto="Reply to Duc" aria-label='Reply to Duc'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-473694" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-473694" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 12, 2019 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-473694" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common problem when using stateful LSTMs, I have a workaround here:<br />
<a href="https://machinelearningmastery.com/use-different-batch-sizes-training-predicting-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/use-different-batch-sizes-training-predicting-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-473694' data-commentid="473694" data-postid="3882" data-belowelement="comment-473694" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-473842" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-473842" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/004f89050260770375c0469614023a83?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/004f89050260770375c0469614023a83?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sai</span>
	                <span class="date">March 12, 2019 at 9:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-473842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How to forecast for the future values .. Suppose I have data till December then how can we predict for the month January.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-473842' data-commentid="473842" data-postid="3882" data-belowelement="comment-473842" data-respondelement="respond" data-replyto="Reply to Sai" aria-label='Reply to Sai'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-473952" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-473952" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 13, 2019 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-473952" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help:<br />
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow ugc">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-473952' data-commentid="473952" data-postid="3882" data-belowelement="comment-473952" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474059" class="comment odd alt depth-3">

	      	<div id="li-comment-474059" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/004f89050260770375c0469614023a83?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/004f89050260770375c0469614023a83?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">sai</span>
	                <span class="date">March 13, 2019 at 7:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-474059" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>After saving the model load_model is used bt what is the input value of<br />
X.<br />
ie.Suppose I have a dataset(data.csv) how can I put into it.<br />
code:<br />
# snip&#8230;<br />
# later, perhaps run from another script</p>
<p># load model from single file<br />
model = load_model(&#8216;lstm_model.h5&#8217;)<br />
# make predictions<br />
yhat = model.predict(X, verbose=0)<br />
print(yhat)</p>
<p>How many time steps it gives the result.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-474059' data-commentid="474059" data-postid="3882" data-belowelement="comment-474059" data-respondelement="respond" data-replyto="Reply to sai" aria-label='Reply to sai'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474171" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-474171" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 14, 2019 at 9:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-474171" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>X is whatever your model expects as input in order to make a prediction. E.g. the input components of a given sample in order to get the output component of the sample.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-474171' data-commentid="474171" data-postid="3882" data-belowelement="comment-474171" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474217" class="comment odd alt depth-5">

	      	<div id="li-comment-474217" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/004f89050260770375c0469614023a83?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/004f89050260770375c0469614023a83?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">sai</span>
	                <span class="date">March 14, 2019 at 12:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-474217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I input the dataset which consists of 86 values saved model gives 86 values does those values considered as predicted values&#8230;?<br />
Doesn&#8217;t it work like ARIMA where we give historical data set then it predict for future values ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-474229" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-474229" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 14, 2019 at 2:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-474229" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You model it like any supervised learning problem with inputs and outputs, except here, the input samples are comprised of time steps.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474698" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-474698" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ba962a30d0e263eb8c982c8d0ab3d43d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba962a30d0e263eb8c982c8d0ab3d43d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">March 16, 2019 at 8:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-474698" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this great tutorial.<br />
I was going through it, step by step, but this ends before &#8216;the magic happens&#8217; (unfortunately):</p>
<p>X, y = train[:, 0:-1], train[:, -1]<br />
X = X.reshape(X.shape[0], 1, X.shape[1])</p>
<p>Up to this point, you perfectly adviced me and I could check all the lines by myself.<br />
Now, when using the complete example, this is not that easy ;/</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-474698' data-commentid="474698" data-postid="3882" data-belowelement="comment-474698" data-respondelement="respond" data-replyto="Reply to Michael" aria-label='Reply to Michael'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474753" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-474753" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 17, 2019 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-474753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about reshaping arrays here:<br />
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-474753' data-commentid="474753" data-postid="3882" data-belowelement="comment-474753" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476887" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-476887" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f73ce561b0b97103b03188aa3c09ef0d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f73ce561b0b97103b03188aa3c09ef0d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Athiran</span>
	                <span class="date">March 28, 2019 at 3:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-476887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir,<br />
how to use LSTM Networks to Predict Engine Condition on Large Scale Data Processing</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-476887' data-commentid="476887" data-postid="3882" data-belowelement="comment-476887" data-respondelement="respond" data-replyto="Reply to Athiran" aria-label='Reply to Athiran'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477080" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-477080" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 29, 2019 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-477080" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My best advice is to start here and follow the outlined process:<br />
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-477080' data-commentid="477080" data-postid="3882" data-belowelement="comment-477080" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-478142" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-478142" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/214317c2944af96831c604bb311150c1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/214317c2944af96831c604bb311150c1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kunal</span>
	                <span class="date">April 3, 2019 at 3:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478142" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why rmse ? Why not other types of errors ? Does the type of error also matter on type of dataset or something?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478142' data-commentid="478142" data-postid="3882" data-belowelement="comment-478142" data-respondelement="respond" data-replyto="Reply to Kunal" aria-label='Reply to Kunal'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478178" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-478178" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 3, 2019 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>RMSE is widely used and deeply understood.</p>
<p>MAE is also popular.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478178' data-commentid="478178" data-postid="3882" data-belowelement="comment-478178" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-478143" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-478143" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3deefafd6c8af270bd521d9555ac8103?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3deefafd6c8af270bd521d9555ac8103?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brain</span>
	                <span class="date">April 3, 2019 at 4:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478143" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I&#8217;m not sure if this is the best tutorial to post this question but here I go!<br />
I&#8217;ve gone through multiple of your tutorials of RNN for prediction and classification, and I&#8217;ve been applying them to my data with limited success so far. So I&#8217;d like to go one step further. Here is my problem:<br />
I have 2 features and I want to predict both of them. However, one is a continuous variable and the other one is a class. So far I&#8217;ve been predicting them separately, but now I&#8217;d like to merge the prediction because, of course, both features are related to each other. This why I&#8217;d like to build a network with keras based on LSTM cells that for an input with two features is able to provide two different outputs, one should go behind a binary_crossentropy activation function to obtain the class, and the other one after no-activation function ( f(x)=x ). </p>
<p>I&#8217;ve seen a tutorial where you include attention in a enc-dec network that you show how to merge upper layer of the network. However, do you know how could we split the network to obtain two different results?</p>
<p>Thanks<br />
Brain</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478143' data-commentid="478143" data-postid="3882" data-belowelement="comment-478143" data-respondelement="respond" data-replyto="Reply to Brain" aria-label='Reply to Brain'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478179" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-478179" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 3, 2019 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can try a model with two outputs, each with its own loss function?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478179' data-commentid="478179" data-postid="3882" data-belowelement="comment-478179" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478271" class="comment odd alt depth-3">

	      	<div id="li-comment-478271" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3deefafd6c8af270bd521d9555ac8103?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3deefafd6c8af270bd521d9555ac8103?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brain</span>
	                <span class="date">April 3, 2019 at 5:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks! do you have any example doing such thing?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478271' data-commentid="478271" data-postid="3882" data-belowelement="comment-478271" data-respondelement="respond" data-replyto="Reply to Brain" aria-label='Reply to Brain'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478363" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-478363" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 4, 2019 at 7:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478363" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this tutorial will help:<br />
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow ugc">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478363' data-commentid="478363" data-postid="3882" data-belowelement="comment-478363" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-478509" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-478509" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/dcf066f89473fae2d6c70d76300e2786?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dcf066f89473fae2d6c70d76300e2786?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">lingya</span>
	                <span class="date">April 5, 2019 at 1:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi</p>
<p>ine 25-30</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6092adfebb7e8758542706" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# invert transform
inverted = list()
for i in range(len(differenced)):
	value = inverse_difference(series, differenced[i], len(series)-i)
	inverted.append(value)
inverted = Series(inverted)
print(inverted.head())</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfebb7e8758542706-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfebb7e8758542706-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfebb7e8758542706-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfebb7e8758542706-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfebb7e8758542706-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6092adfebb7e8758542706-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6092adfebb7e8758542706-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfebb7e8758542706-1"><span class="crayon-p"># invert transform</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfebb7e8758542706-2"><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfebb7e8758542706-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">differenced</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfebb7e8758542706-4"><span class="crayon-h">	</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">inverse_difference</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">differenced</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfebb7e8758542706-5"><span class="crayon-h">	</span><span class="crayon-v">inverted</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6092adfebb7e8758542706-6"><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">inverted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6092adfebb7e8758542706-7"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inverted</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<p>I got key error since the index is negative for history[-interval], which is series[-interval] here.</p>
<p>Should I use history = series.values instead of series(line 28<br />
value = inverse_difference(series.values, differenced[i], len(series)-i)?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478509' data-commentid="478509" data-postid="3882" data-belowelement="comment-478509" data-respondelement="respond" data-replyto="Reply to lingya" aria-label='Reply to lingya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478558" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-478558" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 5, 2019 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-478558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see how you go.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-478558' data-commentid="478558" data-postid="3882" data-belowelement="comment-478558" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-479068" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-479068" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1f7a6e42255fcaba90ce3e3e8276bee6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f7a6e42255fcaba90ce3e3e8276bee6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">JZ</span>
	                <span class="date">April 8, 2019 at 2:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-479068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>You have many posts on LSTM for time series and some seem to be dated. Is this the most current one. For the dated one&#8217;s can you clearly mention that in the title.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-479068' data-commentid="479068" data-postid="3882" data-belowelement="comment-479068" data-respondelement="respond" data-replyto="Reply to JZ" aria-label='Reply to JZ'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-479174" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-479174" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 9, 2019 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-479174" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can see my most recent / best posts on LSTMs for time series here:<br />
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-479174' data-commentid="479174" data-postid="3882" data-belowelement="comment-479174" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-479534" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-479534" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2eb50b4b6c3fb3bd5dd105b0c4dad865?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2eb50b4b6c3fb3bd5dd105b0c4dad865?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">mbelahcen</span>
	                <span class="date">April 11, 2019 at 12:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-479534" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>So i&#8217;m trying to use LSTM to forecast a timeseries but I have an issue with an important feature. Let&#8217;s say that X is what i&#8217;m trying to predict.<br />
Let&#8217;s consider X= a+b+c. The values of a,b,c depend not only on time but on a another column that represents for example a color. What&#8217;s the best way to proceed?<br />
1- Use LSTM to predict a,b,c depending on time only and then sum up to get my X<br />
2- sum up the values a,b,c and then apply LSTM</p>
<p>To make more sens out of this, let&#8217;s say that a,b,c are the profits of 3 different business units and X is the total profit.</p>
<p>I also would like to understand why there is no validation set in your data split.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-479534' data-commentid="479534" data-postid="3882" data-belowelement="comment-479534" data-respondelement="respond" data-replyto="Reply to mbelahcen" aria-label='Reply to mbelahcen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-479605" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-479605" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 11, 2019 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-479605" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Using two models one after the other is a good start.</p>
<p>Try predicting all elements and see of the model can keep the values consistent?</p>
<p>Get creative, perhaps brainstorm alternate framings of the problem and test them put?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-479605' data-commentid="479605" data-postid="3882" data-belowelement="comment-479605" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481247" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-481247" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7d5aad8a42bbfcfd31dba0545a539136?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7d5aad8a42bbfcfd31dba0545a539136?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex Teng</span>
	                <span class="date">April 19, 2019 at 2:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-481247" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thank you so much for the tutorial in detail! After training the data and validating it with test dataset, I would like to produce predictions on new data, say for the future time steps without real values y (i.e., trained data for 10 years, and predict for future years). Could you please tell me how to make a proper X to use the trained model to predict?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-481247' data-commentid="481247" data-postid="3882" data-belowelement="comment-481247" data-respondelement="respond" data-replyto="Reply to Alex Teng" aria-label='Reply to Alex Teng'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481260" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-481260" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 19, 2019 at 3:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-481260" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can call model.predict().</p>
<p>Perhaps this post will help:<br />
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow ugc">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-481260' data-commentid="481260" data-postid="3882" data-belowelement="comment-481260" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482416" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-482416" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2eb50b4b6c3fb3bd5dd105b0c4dad865?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2eb50b4b6c3fb3bd5dd105b0c4dad865?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">belahcenm</span>
	                <span class="date">April 25, 2019 at 1:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-482416" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason! Thank you for your tutorials.</p>
<p>I have tuned my model through epochs, number of neurons and batch size and  I ran repeated experiments. The rmse in many cases is very satisfying for my problem. However, in some cases the error is not. Is it normal? Should I consider my model ready if the majority of experiments are satisfying or a model is ready only if the rmse is almost stable?</p>
<p>Also, what&#8217;s the difference between forecasting before and within the for loop? (See below)</p>
<p>case 1: lstm_model.predict() before for loop</p>
<p>output = lstm_model.predict(test_reshaped, batch_size=batch_size)<br />
		predictions = list()<br />
		for i in range(len(output)):<br />
			yhat = output[i,0]<br />
			X = test_scaled[i, 0:-1]<br />
			# invert scaling<br />
			yhat = invert_scale(scaler, X, yhat)<br />
			# invert differencing<br />
			yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)<br />
			# store forecast<br />
			predictions.append(yhat)</p>
<p>case 2: lstm_model.predict() inside for loop</p>
<p>for i in range(len(test_scaled)):<br />
	# make one-step forecast<br />
	X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br />
	yhat = forecast_lstm(lstm_model, 1, X)<br />
	# invert scaling<br />
	yhat = invert_scale(scaler, X, yhat)<br />
	# invert differencing<br />
	yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)<br />
	# store forecast<br />
	predictions.append(yhat)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-482416' data-commentid="482416" data-postid="3882" data-belowelement="comment-482416" data-respondelement="respond" data-replyto="Reply to belahcenm" aria-label='Reply to belahcenm'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482477" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-482477" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 25, 2019 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-482477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It might be a good idea to counter the variance of the final model by making ensemble predictions:<br />
<a href="https://machinelearningmastery.com/ensemble-methods-for-deep-learning-neural-networks/" rel="nofollow ugc">https://machinelearningmastery.com/ensemble-methods-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-482477' data-commentid="482477" data-postid="3882" data-belowelement="comment-482477" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483048" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-483048" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b5b7e5ac7e2894cf9773de93d4306540?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b5b7e5ac7e2894cf9773de93d4306540?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neil z</span>
	                <span class="date">April 28, 2019 at 6:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-483048" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent blog !</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-483048' data-commentid="483048" data-postid="3882" data-belowelement="comment-483048" data-respondelement="respond" data-replyto="Reply to Neil z" aria-label='Reply to Neil z'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483146" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-483146" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-483146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-483146' data-commentid="483146" data-postid="3882" data-belowelement="comment-483146" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483958" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-483958" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5b8a504b719b2a253c2d02bbc5b031d2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5b8a504b719b2a253c2d02bbc5b031d2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">help</span>
	                <span class="date">May 4, 2019 at 8:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-483958" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi , please would you mindwriting us the function for future prediction (values we don&#8217;t know) and where we put it in the code .i had a problem dealing with it and thank you so much</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-483958' data-commentid="483958" data-postid="3882" data-belowelement="comment-483958" data-respondelement="respond" data-replyto="Reply to help" aria-label='Reply to help'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484068" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-484068" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 5, 2019 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-484068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I explain how here:<br />
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow ugc">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484068' data-commentid="484068" data-postid="3882" data-belowelement="comment-484068" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484264" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-484264" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fd5062693bedda98b8d5cb3eabc54678?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fd5062693bedda98b8d5cb3eabc54678?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">JCR</span>
	                <span class="date">May 7, 2019 at 2:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-484264" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I am having an issue with the walk forward validation</p>
<p>Running:</p>
<p>predictions = list()<br />
for i in range(len(test_scaled)):<br />
	# make one-step forecast<br />
	X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br />
	yhat = forecast_lstm(lstm_model, 1, X)<br />
	# invert scaling<br />
	yhat = invert_scale(scaler, X, yhat)<br />
	# invert differencing<br />
	yhat = inverse_difference(raw_values, yhat, len(test_scaled)+1-i)<br />
	# store forecast<br />
	predictions.append(yhat)<br />
	expected = raw_values[len(train) + i + 1]<br />
	print(&#8216;Month=%d, Predicted=%f, Expected=%f&#8217; % (i+1, yhat, expected))</p>
<p>returns &#8220;KeyError: -76&#8221;</p>
<p>The length of my testing data is 75 days, so it seems to be related to that. There&#8217;s nothing in the chunk above that needs to be specified for my specific data, right?</p>
<p>Interestingly, editing the inverse_difference function to return &#8220;yhat + history[interval]&#8221; rather than &#8220;history[-interval]&#8221; seems to rectify the issue, but I&#8217;m not sure why&#8230;</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484264' data-commentid="484264" data-postid="3882" data-belowelement="comment-484264" data-respondelement="respond" data-replyto="Reply to JCR" aria-label='Reply to JCR'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484289" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-484289" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 7, 2019 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-484289" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this post will help:<br />
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<p>Also try removing or data scaling until you get the model/test harness working the way you want, then add it back in.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484289' data-commentid="484289" data-postid="3882" data-belowelement="comment-484289" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486318" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-486318" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/cbb280a4be067eda2fff477c7addcf11?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cbb280a4be067eda2fff477c7addcf11?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Berta</span>
	                <span class="date">May 23, 2019 at 4:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-486318" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi! </p>
<p>Really nice blog!</p>
<p>I was reading this section and I don&#8217;t really understand the difference between this example and the one shown here (<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a>). Both cases are predicting one time-step ahead values right?</p>
<p>I am doing a project where the dataset is the speed of some vehicles during a period of time and I am trying to predict the future speed. Right now I get accurate results with both examples (0.51 RMSE) but I would like to know the main differences between these two.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-486318' data-commentid="486318" data-postid="3882" data-belowelement="comment-486318" data-respondelement="respond" data-replyto="Reply to Berta" aria-label='Reply to Berta'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486351" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-486351" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 23, 2019 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-486351" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The linked example is older and this version is new, making use of better practices.</p>
<p>I have even better examples here that may help:<br />
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-486351' data-commentid="486351" data-postid="3882" data-belowelement="comment-486351" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486902" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-486902" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amin</span>
	                <span class="date">May 28, 2019 at 5:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-486902" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
in the line:</p>
<p># forecast the entire training dataset to build up state for forecasting<br />
train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)</p>
<p>you are going to reshape the first column of train_scaled. If lag=1 is used then it is ok it reshapes the feature column (1 column). But if you use for example 3 previous time step (timeseries_to_supervised(data, lag=3) it generates features with 3 columns. So, in this case, what does &#8220;train_scaled[:, 0]&#8221; mean? should it be train_scaled[0:-1, 0] ?<br />
Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-486902' data-commentid="486902" data-postid="3882" data-belowelement="comment-486902" data-respondelement="respond" data-replyto="Reply to Amin" aria-label='Reply to Amin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487320" class="comment even depth-2">

	      	<div id="li-comment-487320" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amin</span>
	                <span class="date">May 31, 2019 at 9:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487320" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Have you had time to look into this? Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487320' data-commentid="487320" data-postid="3882" data-belowelement="comment-487320" data-respondelement="respond" data-replyto="Reply to Amin" aria-label='Reply to Amin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487413" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-487413" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 31, 2019 at 2:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ideally the data should be scaled prior to being transformed into a supervised learning problem.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487413' data-commentid="487413" data-postid="3882" data-belowelement="comment-487413" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486941" class="comment even thread-even depth-1">

	      	<div id="li-comment-486941" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2eb50b4b6c3fb3bd5dd105b0c4dad865?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2eb50b4b6c3fb3bd5dd105b0c4dad865?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">mbelahcen</span>
	                <span class="date">May 29, 2019 at 2:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-486941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>say I have after differencing the data I have history_data with length 100. Now I load and use my model with: model.predict(history, batch_size=1). Then i get a prediction array of length 100 same as the history data. I&#8217;m confused with what should I revert differencing with? Should I difference for example predicted June 2019 with the month before or with the same month from the year before?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-486941' data-commentid="486941" data-postid="3882" data-belowelement="comment-486941" data-respondelement="respond" data-replyto="Reply to mbelahcen" aria-label='Reply to mbelahcen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486979" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-486979" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 29, 2019 at 8:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-486979" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The last known observation before the prediction is used to invert the differencing.</p>
<p>I give an example here that might help:<br />
<a href="https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-486979' data-commentid="486979" data-postid="3882" data-belowelement="comment-486979" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487037" class="comment even depth-3">

	      	<div id="li-comment-487037" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ec66d88227585b855971377eac76f295?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec66d88227585b855971377eac76f295?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">guzuomuse</span>
	                <span class="date">May 29, 2019 at 10:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks for this great article. i have a question: is it necessary (important) to make the data</p>
<p>stationary when using neural network (deep learning).</p>
<p>i have searched some articles. most of them said that the answer should be &#8220;NO&#8221;</p>
<p>here they are:</p>
<p><a href="https://www.oreilly.com/ideas/3-reasons-to-add-deep-learning-to-your-time-series-toolkit" rel="nofollow ugc">https://www.oreilly.com/ideas/3-reasons-to-add-deep-learning-to-your-time-series-toolkit</a></p>
<p><a href="https://www.researchgate.net/post/In_financial_time_series_we_have_non-stationary_time_series_Is_it_needed_to_transfer_the_data_to_stationary_time_series_for_forecasting_or_not" rel="nofollow ugc">https://www.researchgate.net/post/In_financial_time_series_we_have_non-stationary_time_series_Is_it_needed_to_transfer_the_data_to_stationary_time_series_for_forecasting_or_not</a></p>
<p>can you give me your opinion? thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487037' data-commentid="487037" data-postid="3882" data-belowelement="comment-487037" data-respondelement="respond" data-replyto="Reply to guzuomuse" aria-label='Reply to guzuomuse'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487076" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-487076" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 30, 2019 at 9:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487076" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It can help, but is not required.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487076' data-commentid="487076" data-postid="3882" data-belowelement="comment-487076" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487100" class="comment even depth-5">

	      	<div id="li-comment-487100" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ec66d88227585b855971377eac76f295?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec66d88227585b855971377eac76f295?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">guzuomuse</span>
	                <span class="date">May 30, 2019 at 2:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487100" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks Man!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-487585" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-487585" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amin</span>
	                <span class="date">June 1, 2019 at 6:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Could you please check the below issue.</p>
<p>I used r2_Score for test set: </p>
<p>from sklearn.metrics import  r2_score,<br />
results[&#8216;r2train&#8217;] = r2_score(train_scaled[:, -1], lstm_model.predict(train_reshaped, batch_size=1))<br />
results[&#8216;r2test&#8217;] = r2_score(raw_values[-12:], predictions)</p>
<p>Results:<br />
1) Test RMSE: 113.155<br />
             rmse    r2test   r2train<br />
count    1.000000  1.000000  1.000000<br />
mean   113.155189 -0.016695 -0.389893<br />
min    113.155189 -0.016695 -0.389893<br />
25%    113.155189 -0.016695 -0.389893<br />
50%    113.155189 -0.016695 -0.389893<br />
75%    113.155189 -0.016695 -0.389893<br />
max    113.155189 -0.016695 -0.389893</p>
<p>The R2 value is negative while RMSE is 113.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487585' data-commentid="487585" data-postid="3882" data-belowelement="comment-487585" data-respondelement="respond" data-replyto="Reply to Amin" aria-label='Reply to Amin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487628" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-487628" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 2, 2019 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487628" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487628' data-commentid="487628" data-postid="3882" data-belowelement="comment-487628" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487921" class="comment odd alt depth-3">

	      	<div id="li-comment-487921" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/219dac27acc059ecce7e1b47a8d2d785?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amin</span>
	                <span class="date">June 5, 2019 at 1:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487921" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I used your original code and data (Section: Develop a Robust Result)  and just added R2 SCORE in addition to RMSE:      r2=r2_score(raw_values[-12:], predictions) which inputs are the same as mean_squared_error  in the original code.<br />
Results:<br />
1) Test RMSE: 94.286 R2: 0.294<br />
2) Test RMSE: 86.854 R2: 0.401<br />
3) Test RMSE: 189.482 R2: -1.851<br />
4) Test RMSE: 147.910 R2: -0.737<br />
5) Test RMSE: 204.352 R2: -2.316<br />
6) Test RMSE: 219.807 R2: -2.836<br />
7) Test RMSE: 106.188 R2: 0.105<br />
8) Test RMSE: 108.560 R2: 0.064<br />
9) Test RMSE: 199.271 R2: -2.153<br />
10) Test RMSE: 129.355 R2: -0.329<br />
&#8230;</p>
<p>As you can see, R2 values are low or even negative.<br />
If there is no error in my code, my question is that should we check multi-criteria like RMSE, R2, etc. simultaneously? or is there any rule for selecting between R2 or RMSE based on the data. </p>
<p>Another example is that I used Grid Search for wide ranges of hyperparameters based on AIC to generate SARIMA Model (Best AIC:4779) and the test R2 is 70 %. When I check the Training R2, it is around 45%. Is the model acceptable or I should use Training R2 instead of AIC? Many Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487921' data-commentid="487921" data-postid="3882" data-belowelement="comment-487921" data-respondelement="respond" data-replyto="Reply to Amin" aria-label='Reply to Amin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487928" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-487928" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 5, 2019 at 2:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-487928" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend choosing a metric that makes the most sense to project stakeholders or domain experts for your specific dataset.</p>
<p>If you&#8217;re unsure, RMSE is a good start.</p>
<p>Model selection is challenging. It is important to both choose a metric and also choose a model evaluation strategy that captures how you intend to use the model in practice.</p>
<p>That is the best that I can say without diving into the specifics of your dataset, which I don&#8217;t have the capacity to do.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487928' data-commentid="487928" data-postid="3882" data-belowelement="comment-487928" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-488586" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-488586" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8711c5d97f371ae7a81c265f7b682be4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8711c5d97f371ae7a81c265f7b682be4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tayyab</span>
	                <span class="date">June 11, 2019 at 8:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the amount of data is in thousands of lines, in my case 40K plus lines, the algorithm takes forever to train and evaluate or tune. One approach is to reduce the data but then the evaluation and training results are not for the whole data. How can I evaluate my algorithm in such a scenario?</p>
<p>I am using ARIMA and LSTM and both take forever, like sometimes a whole day. I shifted to google colab GPU but still the same issue.I want to get a solution for the above issue so that I can tune and evaluate both the algorithms in less time.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488586' data-commentid="488586" data-postid="3882" data-belowelement="comment-488586" data-respondelement="respond" data-replyto="Reply to Tayyab" aria-label='Reply to Tayyab'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488625" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-488625" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 12, 2019 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use a small sample to estimate skill and choose a model, then use all data and a large computer over night to compute the final skill estimate.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488625' data-commentid="488625" data-postid="3882" data-belowelement="comment-488625" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-488716" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-488716" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lopa</span>
	                <span class="date">June 13, 2019 at 3:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have gone through all your tutorials on LSTM forecasting. I have trained the model using 549 data points &amp; in order to make predictionI have used 90 data points .</p>
<p>X2 = scaler.fit_transform(X2)<br />
X3 = X2[0:-1]<br />
X3=np.reshape(X3, (X3.shape[0], 1, X3.shape[1]))</p>
<p>yhat = model.predict(X3, 1)</p>
<p>This generates 89 forecasts. But what if I want to predict only 31 data points using 89 data points how should I modify my code. It would be great if I can get some help.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488716' data-commentid="488716" data-postid="3882" data-belowelement="comment-488716" data-respondelement="respond" data-replyto="Reply to Lopa" aria-label='Reply to Lopa'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488742" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-488742" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 13, 2019 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can provide 31 input samples to make 31 output predictions.</p>
<p>Perhaps I don&#8217;t understand your question?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488742' data-commentid="488742" data-postid="3882" data-belowelement="comment-488742" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-488804" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-488804" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lopa</span>
	                <span class="date">June 13, 2019 at 7:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your prompt reply. It is so that I have daily data from Jul 2017-Dec 2018 which makes 549 data points. I was trying to forecast Jan 2019 using Oct 2018 -Dec 2018. In this example that is demonstrated above I can understand that in doing that it will generate as many number of output data as the number of inputs.</p>
<p>My questions are :</p>
<p>1. that can these predictions which are generated using Oct 2018-Dec 2018 data be considered to be the predictions for Jan 2019 &#8211; Mar 2019 . Is my understanding correct ? </p>
<p>2. Is there a way that I input 90 data points to predict 31 future data points ?</p>
<p> In case of vanilla LSTM I have seen that we can input an array of 3 elements [70,80,90] &amp; predict [100] as shown in on elf your tutorials:</p>
<p><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>
<p>Thanks for helping out by designing these useful tutorials.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488804' data-commentid="488804" data-postid="3882" data-belowelement="comment-488804" data-respondelement="respond" data-replyto="Reply to Lopa" aria-label='Reply to Lopa'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488874" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-488874" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 14, 2019 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488874" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can frame the prediction problem any way that you wish. It is up to you.</p>
<p>Perhaps I don&#8217;t understand the problem?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488874' data-commentid="488874" data-postid="3882" data-belowelement="comment-488874" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-488844" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-488844" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lopa</span>
	                <span class="date">June 14, 2019 at 2:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Also do I have to convert the new series to supervised format in order to get the predictions?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488844' data-commentid="488844" data-postid="3882" data-belowelement="comment-488844" data-respondelement="respond" data-replyto="Reply to Lopa" aria-label='Reply to Lopa'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488889" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-488889" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 14, 2019 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-488889" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Typically, yes.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488889' data-commentid="488889" data-postid="3882" data-belowelement="comment-488889" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491759" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-491759" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5b9470fe05c4d248b58d33e58045a7ce?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5b9470fe05c4d248b58d33e58045a7ce?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">skyrim4ever</span>
	                <span class="date">July 5, 2019 at 9:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-491759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello. I am trying to understand the code implementation. I find few of these defined functions hard to grasp but maybe I need take more time understanding. However, I wonder what&#8217;s the purpose of these reshape lines that you used for variables &#8216;train&#8217; and &#8216;test&#8217; in your scale-function? </p>
<p>train = train.reshape(train.shape[0], train.shape[1])<br />
test = test.reshape(test.shape[0], test.shape[1])</p>
<p>The variables do not change their shape at all am I right? Because they are 2D-arrays anyways?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-491759' data-commentid="491759" data-postid="3882" data-belowelement="comment-491759" data-respondelement="respond" data-replyto="Reply to skyrim4ever" aria-label='Reply to skyrim4ever'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491828" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-491828" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 6, 2019 at 8:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-491828" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with a much simpler implementation here:<br />
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-491828' data-commentid="491828" data-postid="3882" data-belowelement="comment-491828" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492612" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-492612" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a8791cb87c9a155d3d0a18655310ceb7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a8791cb87c9a155d3d0a18655310ceb7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Roma</span>
	                <span class="date">July 12, 2019 at 10:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-492612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are using the last month&#8217;s shampoo sales to predict the next month&#8217;s sales.  </p>
<p>1. Why do we need an LSTM to do this?  I don&#8217;t understand how the time component of LSTM plays into this.</p>
<p>2. When we set statefulness to True, I think the network is accounting for what came before with when it reads in a new month&#8217;s sales.  But then how is that info used in predict, when we have just 1 datapoint (and not a series as predictors)?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-492612' data-commentid="492612" data-postid="3882" data-belowelement="comment-492612" data-respondelement="respond" data-replyto="Reply to Roma" aria-label='Reply to Roma'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492695" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-492695" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 13, 2019 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-492695" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>An LSTM is not needed, in fact it is worse than a linear method.  It is an example you might want to use as a starting point.</p>
<p>Statefulness means we control when the internal state is reset, instead of at the end of every batch/weight update.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-492695' data-commentid="492695" data-postid="3882" data-belowelement="comment-492695" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-497381" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-497381" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9f9bdd846f0e7e8ee0a1dfc1a570e7ff?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9f9bdd846f0e7e8ee0a1dfc1a570e7ff?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">psychologie</span>
	                <span class="date">August 20, 2019 at 2:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-497381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What&#8217;s up, after reading this awesome article i am as well<br />
glad to share my knowledge here with friends.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-497381' data-commentid="497381" data-postid="3882" data-belowelement="comment-497381" data-respondelement="respond" data-replyto="Reply to psychologie" aria-label='Reply to psychologie'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-497423" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-497423" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 20, 2019 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-497423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-497423' data-commentid="497423" data-postid="3882" data-belowelement="comment-497423" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500892" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-500892" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/00cc9a27373bf30cd67f8efdb38cb54f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/00cc9a27373bf30cd67f8efdb38cb54f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dillan Muthanna</span>
	                <span class="date">September 10, 2019 at 10:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-500892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How to apply the same method when we have multiple products instead of a single shampoo? I am trying to solve a forecasting problem at my internship where i need to forecast around 300 products on a day basis. I  would really really appreciate your guidance  even if my question seems dumb.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-500892' data-commentid="500892" data-postid="3882" data-belowelement="comment-500892" data-respondelement="respond" data-replyto="Reply to Dillan Muthanna" aria-label='Reply to Dillan Muthanna'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500931" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-500931" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 11, 2019 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-500931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, you can adapt the suggestions here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-to-develop-forecast-models-for-multiple-sites" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-to-develop-forecast-models-for-multiple-sites</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-500931' data-commentid="500931" data-postid="3882" data-belowelement="comment-500931" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505178" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-505178" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a7fe893a835d9104c1422465de8f090d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a7fe893a835d9104c1422465de8f090d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vivaka Nand</span>
	                <span class="date">October 11, 2019 at 5:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-505178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sir,</p>
<p>your blogs are very informative.</p>
<p>my question is how can i find the accuracy of this model?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-505178' data-commentid="505178" data-postid="3882" data-belowelement="comment-505178" data-respondelement="respond" data-replyto="Reply to Vivaka Nand" aria-label='Reply to Vivaka Nand'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505273" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-505273" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 12, 2019 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-505273" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You cannot calculate accuracy for regression, you must calculate error, more details here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-calculate-accuracy-for-regression" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-calculate-accuracy-for-regression</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-505273' data-commentid="505273" data-postid="3882" data-belowelement="comment-505273" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506629" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-506629" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fa1dbc037ed41fa549a9fc677c3e8f54?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fa1dbc037ed41fa549a9fc677c3e8f54?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ricardo</span>
	                <span class="date">October 21, 2019 at 12:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-506629" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, thank you for your post, I enjoyed it, very clear and to the point. I have a question about GPU vs CPU performance. I initially run the example on my CPU, when I noticed it was taking too long I installed tensorflow-gpu and used a Nvidia RTX2070 card instead, but still didn&#8217;t see much improvement. As far as I know Im using the GPU but it still takes a long time to go over the each epoch. What are the causes or how can I improved the performance? I have worked before with CNN and Pytorch and noticed a great difference in the performances of CPU and GPU, thus, I don&#8217;t think is an issue with the card. </p>
<p>Thanks again,</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506629' data-commentid="506629" data-postid="3882" data-belowelement="comment-506629" data-respondelement="respond" data-replyto="Reply to Ricardo" aria-label='Reply to Ricardo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506640" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-506640" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 1:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-506640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. Performance of LSTMs is typically not improved with GPUs.</p>
<p>You can try exploring some of unrolling parameters that will take my more memory but improve execution.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506640' data-commentid="506640" data-postid="3882" data-belowelement="comment-506640" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-508937" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-508937" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/39f1b687e2a76533dfcd02ecf858f798?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/39f1b687e2a76533dfcd02ecf858f798?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark Hendrix</span>
	                <span class="date">November 6, 2019 at 11:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-508937" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I have a question, How can i predict the next 12 months after 3 year? What kind of code should i use and input?</p>
<p>I hope you can help me!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-508937' data-commentid="508937" data-postid="3882" data-belowelement="comment-508937" data-respondelement="respond" data-replyto="Reply to Mark Hendrix" aria-label='Reply to Mark Hendrix'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-508978" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-508978" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 7, 2019 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-508978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-508978' data-commentid="508978" data-postid="3882" data-belowelement="comment-508978" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-509610" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-509610" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/284fa2994e9c618d8d65122cb2a60889?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/284fa2994e9c618d8d65122cb2a60889?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Malcolm</span>
	                <span class="date">November 10, 2019 at 4:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-509610" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, have been trying to plot loss function; ive added these lines of code at line 126. The Code is as follows:</p>
<p>training_loss = lstm_model.history.history[&#8216;loss&#8217;]<br />
epoch_count = range(1, len(training_loss) + 1)</p>
<p>pyplot.plot(epoch_count, training_loss, &#8216;r&#8211;&#8216;)<br />
pyplot.legend([&#8216;Training Loss&#8217;, &#8216;Test Loss&#8217;])<br />
pyplot.xlabel(&#8216;Epoch&#8217;)<br />
pyplot.ylabel(&#8216;Loss&#8217;)<br />
pyplot.show()</p>
<p>However, i keep getting a blank loss function; How can i edit the previous/ these lines of code to plot the loss function?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-509610' data-commentid="509610" data-postid="3882" data-belowelement="comment-509610" data-respondelement="respond" data-replyto="Reply to Malcolm" aria-label='Reply to Malcolm'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-509730" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-509730" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 11, 2019 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-509730" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps confirm that the history object contains the data you expect?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-509730' data-commentid="509730" data-postid="3882" data-belowelement="comment-509730" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511785" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-511785" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/18d477915dcd9b8fea05a4652ad1f4b1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/18d477915dcd9b8fea05a4652ad1f4b1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">vusal</span>
	                <span class="date">November 21, 2019 at 1:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-511785" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I attempted to modify the lag size (e.g., window size to 3) in the above code but I faced the ValueError: cannot reshape array of size of&#8230;</p>
<p>The code seems to be pretty adaptable. Do you know why this is the case?</p>
<p>Vusal</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-511785' data-commentid="511785" data-postid="3882" data-belowelement="comment-511785" data-respondelement="respond" data-replyto="Reply to vusal" aria-label='Reply to vusal'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511794" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-511794" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 21, 2019 at 1:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-511794" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not sure off hand, you may need to debug it.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-511794' data-commentid="511794" data-postid="3882" data-belowelement="comment-511794" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512670" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-512670" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e937e6d06ce608b20292a6dc935d7f33?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e937e6d06ce608b20292a6dc935d7f33?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.uwaterloo.ca" rel='external nofollow ugc' class='url'>Tanushree Banerjee</a></span>
	                <span class="date">November 27, 2019 at 8:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-512670" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, can I use this kind of LSTM model for my research work, which is &#8211;<br />
Training Phase: I&#8217;ll supply input and output signal, both 1D time series,<br />
Test case: I&#8217;ll provide input signal and I want the model to predict the output signal for me based on what it has learnt in training phase</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-512670' data-commentid="512670" data-postid="3882" data-belowelement="comment-512670" data-respondelement="respond" data-replyto="Reply to Tanushree Banerjee" aria-label='Reply to Tanushree Banerjee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512726" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-512726" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 28, 2019 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-512726" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That sounds like a great project.</p>
<p>Perhaps try the LSTM and compare the results?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-512726' data-commentid="512726" data-postid="3882" data-belowelement="comment-512726" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514691" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-514691" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/071b6fb8d33104424d0da2f06fc3f145?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/071b6fb8d33104424d0da2f06fc3f145?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sushanth</span>
	                <span class="date">December 12, 2019 at 11:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-514691" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>I have gone through many of your articles especially LSTM. There are predictions based on testing set where we have values till t-1 &amp; we predict &#8216;t&#8217; value. But I would like to understand how do we predict for 1 month or 10 days of future? </p>
<p>I have tried feeding the predicted value as input to the model, but this is leading to a flat output, variance is getting lost.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514691' data-commentid="514691" data-postid="3882" data-belowelement="comment-514691" data-respondelement="respond" data-replyto="Reply to Sushanth" aria-label='Reply to Sushanth'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514699" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-514699" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 12, 2019 at 1:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-514699" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See these examples:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514699' data-commentid="514699" data-postid="3882" data-belowelement="comment-514699" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514869" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-514869" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">December 13, 2019 at 1:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-514869" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks greatly fort this article. What about if I want to predict a future occurence that I don&#8217;t have data for based on this model.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514869' data-commentid="514869" data-postid="3882" data-belowelement="comment-514869" data-respondelement="respond" data-replyto="Reply to Femi" aria-label='Reply to Femi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514870" class="comment even depth-2">

	      	<div id="li-comment-514870" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">December 13, 2019 at 1:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-514870" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean, forecast for future dates not in my current dataset</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514870' data-commentid="514870" data-postid="3882" data-belowelement="comment-514870" data-respondelement="respond" data-replyto="Reply to Femi" aria-label='Reply to Femi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-514884" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514884" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 13, 2019 at 1:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-514884" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Call the predict() function with the inputs prior to the period you want to predict.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514884' data-commentid="514884" data-postid="3882" data-belowelement="comment-514884" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514909" class="comment even thread-even depth-1">

	      	<div id="li-comment-514909" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">December 13, 2019 at 4:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-514909" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are no inputs (because it is univariate). I only have the date index with &#8220;nan&#8221; values in place of my target values since the events have not occurred. To make predictions by splitting data into train and test is easy because there are available for that period.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514909' data-commentid="514909" data-postid="3882" data-belowelement="comment-514909" data-respondelement="respond" data-replyto="Reply to Femi" aria-label='Reply to Femi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515018" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-515018" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 14, 2019 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-515018" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not quite.</p>
<p>Time series framed as a supervised learning problems has inputs and outputs, e.g. the model takes some number of prior obs and uses it to predict future obs.</p>
<p>This applies to all forecasting models.</p>
<p>More on this here:<br />
<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow ugc">https://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-515018' data-commentid="515018" data-postid="3882" data-belowelement="comment-515018" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514910" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-514910" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">December 13, 2019 at 5:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-514910" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>projecting beyond my train and test data is what I wanna achieve.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514910' data-commentid="514910" data-postid="3882" data-belowelement="comment-514910" data-respondelement="respond" data-replyto="Reply to Femi" aria-label='Reply to Femi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515019" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-515019" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 14, 2019 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-515019" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I understood and answered accordingly.</p>
<p>Perhaps start with this to understand the basics:<br />
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-515019' data-commentid="515019" data-postid="3882" data-belowelement="comment-515019" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516254" class="comment even depth-3">

	      	<div id="li-comment-516254" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">December 25, 2019 at 7:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-516254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I understand this procedure. Using a supervised method means I&#8217;d to have X for what I want to predict in the and this X is actually still gotten from the value. Your article on supervised time-series explains this. This means if I am to predict for the non-sample-dataset I&#8217;d still need the results that I am trying to predict.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516254' data-commentid="516254" data-postid="3882" data-belowelement="comment-516254" data-respondelement="respond" data-replyto="Reply to Femi" aria-label='Reply to Femi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516277" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-516277" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 25, 2019 at 10:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-516277" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No. Outcomes are only needed to train the model &#8211; e.g. historical data.</p>
<p>To make a prediction, even a multiple step prediction you only need the inputs to the model.</p>
<p>You have choice over how to frame the problem. Frame it to only use the data you have available at prediction time.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516277' data-commentid="516277" data-postid="3882" data-belowelement="comment-516277" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516284" class="comment even thread-even depth-1">

	      	<div id="li-comment-516284" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d3f3778e287ff3d8f3f3f5f9c465db91?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">December 25, 2019 at 12:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-516284" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I forget to mention I&#8217;m dealing with a univariate dataset. So only inputs I have are dates, which will be my index. This why I&#8217;m aasking though because with univariate I can&#8217;t seem to hack my way around what my input (X) will be for non-sample-dataset.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516284' data-commentid="516284" data-postid="3882" data-belowelement="comment-516284" data-respondelement="respond" data-replyto="Reply to Femi" aria-label='Reply to Femi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516329" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516329" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 26, 2019 at 7:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-516329" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The index/dates/times are dropped and you only work with the series of observations.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516329' data-commentid="516329" data-postid="3882" data-belowelement="comment-516329" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-517774" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-517774" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4495194de38ddc0d76161b18698b5c04?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4495194de38ddc0d76161b18698b5c04?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thefenix</span>
	                <span class="date">January 12, 2020 at 8:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-517774" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I just follow your instruction and code in <a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a>  (Multivariate LSTM Models- Multi input). And I set step size =3, feature =3, predict 1 output in 3 day forward.   From the result,  the predicted_output was plotted look like(a little bit different) actual_output, but it was shifted forward(delay) about 1-3 days. Is there anything wrong? or I have to add reset_state like this post?.  What the difference between these two code (Multivariate multi input vs. this post)? (In LSTM part). Thank you</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-517774' data-commentid="517774" data-postid="3882" data-belowelement="comment-517774" data-respondelement="respond" data-replyto="Reply to Thefenix" aria-label='Reply to Thefenix'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517806" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-517806" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 13, 2020 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-517806" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe the model learned a persistence forecast:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-517806' data-commentid="517806" data-postid="3882" data-belowelement="comment-517806" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522832" class="comment even thread-even depth-1">

	      	<div id="li-comment-522832" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/85f4eb9933b3039d08cc857f825671a8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85f4eb9933b3039d08cc857f825671a8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">KHADIJA AIT DERHEM</span>
	                <span class="date">February 23, 2020 at 5:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-522832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>le premier exemple comment je peut l’excité qui ce que je dois met au lieu de x </p>
<p>parser(x)<br />
j&#8217;ai pas arrivé à trouver malgré qu&#8217;ai enregistrer les donnée sur excel</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-522832' data-commentid="522832" data-postid="3882" data-belowelement="comment-522832" data-respondelement="respond" data-replyto="Reply to KHADIJA AIT DERHEM" aria-label='Reply to KHADIJA AIT DERHEM'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522866" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-522866" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 23, 2020 at 7:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-522866" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You may not need it if your date-times are well formatted. E.g. the read_csv function can parse the dates for you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-522866' data-commentid="522866" data-postid="3882" data-belowelement="comment-522866" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-523040" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-523040" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/85f4eb9933b3039d08cc857f825671a8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/85f4eb9933b3039d08cc857f825671a8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">KHADIJA AIT DERHEM</span>
	                <span class="date">February 24, 2020 at 9:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-523040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you for your answer now I have another problem is that if I put for the executed it gave me &#8216;Data_Digital_Currencies .csv&#8217; does not exist: b&#8217;Data_Digital_Currencies .csv&#8217;<br />
hat I save all the data in the same folder<br />
from pandas import read_csv<br />
from pandas import datetime<br />
from matplotlib import pyplot<br />
# load dataset<br />
def parser(x):<br />
    return datetime.strptime( &#8216;%Y-%m&#8217;)<br />
series = read_csv(&#8216;Data_Digital_Currencies .csv&#8217;, header=0, parse_dates=[0], index_col=0, squeeze=True)<br />
# summarize first few rows<br />
print(series.head())<br />
# line plot<br />
series.plot()<br />
pyplot.show()</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-523040' data-commentid="523040" data-postid="3882" data-belowelement="comment-523040" data-respondelement="respond" data-replyto="Reply to KHADIJA AIT DERHEM" aria-label='Reply to KHADIJA AIT DERHEM'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523098" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-523098" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 25, 2020 at 7:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-523098" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ensure the data file is in the same directory as your code file, or specify the full path to the file.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-523098' data-commentid="523098" data-postid="3882" data-belowelement="comment-523098" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-525179" class="comment even thread-even depth-1">

	      	<div id="li-comment-525179" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/992d232a404eee52f01dc071d60123c9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/992d232a404eee52f01dc071d60123c9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kavya</span>
	                <span class="date">March 11, 2020 at 7:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-525179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I would like to know is it possible to predict multi outputs time series from multi input time series data using LSTM( like if i have 10 input attributes  and  4 output attributes in time series). Is there any of your blog that explains about this kind of modeling.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-525179' data-commentid="525179" data-postid="3882" data-belowelement="comment-525179" data-respondelement="respond" data-replyto="Reply to Kavya" aria-label='Reply to Kavya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525186" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-525186" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 11, 2020 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-525186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can start here for simple examples:<br />
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>
<p>More advanced examples here:<br />
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-525186' data-commentid="525186" data-postid="3882" data-belowelement="comment-525186" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-525602" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-525602" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a47a68401740b04d0ed23a319e2c509a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a47a68401740b04d0ed23a319e2c509a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luca</span>
	                <span class="date">March 15, 2020 at 2:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-525602" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Congratulations for your great site. I have a question for you that i posted also on stackoverflow ( <a href="https://stackoverflow.com/questions/60669182/forecasting-with-multilayer-perceptron" rel="nofollow ugc">https://stackoverflow.com/questions/60669182/forecasting-with-multilayer-perceptron</a> ). Why when i predict on a test set the predictions are very good but when i perform a forecasting the predictions or converged to a unique value or diverged? I tried many models (MLP, LSTM, GRU, ecc) . All of them cause the same problem. I think is beacuse the models can&#8217;t forecasting for many steps. What do you think? Thank you.<br />
Luca.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-525602' data-commentid="525602" data-postid="3882" data-belowelement="comment-525602" data-respondelement="respond" data-replyto="Reply to Luca" aria-label='Reply to Luca'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525630" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-525630" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 15, 2020 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-525630" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, perhaps your model is overfit the training or does not have skill.</p>
<p>Perhaps try other model configs, other model types, etc. and discover what works best for your dataset. See this:<br />
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-525630' data-commentid="525630" data-postid="3882" data-belowelement="comment-525630" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-528151" class="comment even thread-even depth-1">

	      	<div id="li-comment-528151" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2897e4c24b93915a1a8e848a306a83f7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2897e4c24b93915a1a8e848a306a83f7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maunish</span>
	                <span class="date">April 2, 2020 at 11:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-528151" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, excellent article</p>
<p>I have one doubt that can we scale the data before performing the shift() function<br />
because after shifting data gets converted to shape of (len(data),2)<br />
and then at the time of prediction data is of shape (len(data),1)<br />
so we have to write a complicated invert_scale function, </p>
<p>so can we scale before shifting so that it saves us from writing complicated code and just perform simple scaler.inverse_transform(prediction)?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-528151' data-commentid="528151" data-postid="3882" data-belowelement="comment-528151" data-respondelement="respond" data-replyto="Reply to Maunish" aria-label='Reply to Maunish'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-528209" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-528209" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 3, 2020 at 6:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-528209" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, things get very sticky!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-528209' data-commentid="528209" data-postid="3882" data-belowelement="comment-528209" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-528716" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-528716" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/21aa7bf21bb9c359bbac171a660697ba?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/21aa7bf21bb9c359bbac171a660697ba?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">sarah</span>
	                <span class="date">April 7, 2020 at 12:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-528716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your great site, </p>
<p>Can I use the model,( with the same coding structure) on my own dataset and my own hyperparameter? </p>
<p>Could you help me what should I consider to use a different batch size other than 1, please? </p>
<p>Another question, do you have any courses about automatic hyperparameter tuning? and ensemble learning methods?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-528716' data-commentid="528716" data-postid="3882" data-belowelement="comment-528716" data-respondelement="respond" data-replyto="Reply to sarah" aria-label='Reply to sarah'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-528732" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-528732" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 7, 2020 at 1:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-528732" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps.</p>
<p>I recommend this process:<br />
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>
<p>The tutorials here will help you to get started:<br />
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-528732' data-commentid="528732" data-postid="3882" data-belowelement="comment-528732" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529258" class="comment even thread-even depth-1">

	      	<div id="li-comment-529258" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4dc32a0963ca97d84eb83b10a55227e2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4dc32a0963ca97d84eb83b10a55227e2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Erik</span>
	                <span class="date">April 11, 2020 at 12:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529258" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey, thanks for the great help you&#8217;ve been!</p>
<p>I was wonder how to plot the train loss versus test loss for this particular example. I have looked at how you usually do it from other examples but I can&#8217;t get it to work. </p>
<p>I am still kind of new to LSTM so it would be of great help if you could assist me.</p>
<p>Thanks<br />
Erik</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529258' data-commentid="529258" data-postid="3882" data-belowelement="comment-529258" data-respondelement="respond" data-replyto="Reply to Erik" aria-label='Reply to Erik'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529305" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529305" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 11, 2020 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529305" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It can be challenging for LSTMs, I expect you will either have to collect the history your self with custom code or change the way the model is fit.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529305' data-commentid="529305" data-postid="3882" data-belowelement="comment-529305" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529499" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-529499" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4dc32a0963ca97d84eb83b10a55227e2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4dc32a0963ca97d84eb83b10a55227e2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Erik</span>
	                <span class="date">April 13, 2020 at 12:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529499" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the fast reply! </p>
<p>Yes you were right, I changed the way the model is fit and it works.<br />
Awesome work, and thanks for providing these guides!</p>
<p>Br<br />
Erik</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529499' data-commentid="529499" data-postid="3882" data-belowelement="comment-529499" data-respondelement="respond" data-replyto="Reply to Erik" aria-label='Reply to Erik'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529535" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529535" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 13, 2020 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529535" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529535' data-commentid="529535" data-postid="3882" data-belowelement="comment-529535" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529682" class="comment even thread-even depth-1">

	      	<div id="li-comment-529682" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f2f9cfa30d6be9d3c58e450ea804cdf6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f2f9cfa30d6be9d3c58e450ea804cdf6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Meisam</span>
	                <span class="date">April 14, 2020 at 7:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529682" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>Thanks for this great article.. I&#8217;m new in time series prediction and have an important question to ask:<br />
When I fit the model and test that, it will not predict when the price is going to go up or down. When the price did change, it will adopt to change not predict it. For example, if day 1 expected price was 201, the day 2 price was 220 and the third day was 200, it will not predict the the price rotation in day 3 and it will show it in day4&#8230; It&#8217;s like the model copy the move or something&#8230; Please help me&#8230;I stuck in this and don&#8217;t know what&#8217;s the problem. Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529682' data-commentid="529682" data-postid="3882" data-belowelement="comment-529682" data-respondelement="respond" data-replyto="Reply to Meisam" aria-label='Reply to Meisam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529697" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529697" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 14, 2020 at 10:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe your model has learned a persistance model:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529697' data-commentid="529697" data-postid="3882" data-belowelement="comment-529697" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529754" class="comment even depth-3">

	      	<div id="li-comment-529754" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f2f9cfa30d6be9d3c58e450ea804cdf6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f2f9cfa30d6be9d3c58e450ea804cdf6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Meisam</span>
	                <span class="date">April 15, 2020 at 12:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529754" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank&#8217;s so much&#8230; You made my day 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529754' data-commentid="529754" data-postid="3882" data-belowelement="comment-529754" data-respondelement="respond" data-replyto="Reply to Meisam" aria-label='Reply to Meisam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529789" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-529789" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 15, 2020 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529789' data-commentid="529789" data-postid="3882" data-belowelement="comment-529789" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529797" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-529797" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f2f9cfa30d6be9d3c58e450ea804cdf6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f2f9cfa30d6be9d3c58e450ea804cdf6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Meisam</span>
	                <span class="date">April 15, 2020 at 8:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi<br />
Sorry for bothering again&#8230; But I&#8217;m still stuck on that&#8230; I couldn&#8217;t get rid of persistent forecasting even with changing data or the hyper parameters&#8230; I don&#8217;t know what to do&#8230;please help me&#8230;<br />
( Also another question&#8230; Can we use GRU to predict stock market, because I didn&#8217;t run into any article that include GRU for stock prediction )</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529797' data-commentid="529797" data-postid="3882" data-belowelement="comment-529797" data-respondelement="respond" data-replyto="Reply to Meisam" aria-label='Reply to Meisam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529816" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529816" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 15, 2020 at 1:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-529816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps explore using an alternate model?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529816' data-commentid="529816" data-postid="3882" data-belowelement="comment-529816" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-531669" class="comment even thread-even depth-1">

	      	<div id="li-comment-531669" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/809075279d258f3acbb3a04b00cd532a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/809075279d258f3acbb3a04b00cd532a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Randall Kakaire</span>
	                <span class="date">April 25, 2020 at 8:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-531669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, </p>
<p>could you provide example on how to increase the window size, for predicting the next time step. for example instead of just using the previous value, i would like to use the model to use the previous 10 values.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-531669' data-commentid="531669" data-postid="3882" data-belowelement="comment-531669" data-respondelement="respond" data-replyto="Reply to Randall Kakaire" aria-label='Reply to Randall Kakaire'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-531718" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-531718" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 26, 2020 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-531718" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This requires a change to the model, called multi-step forecasting:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-531718' data-commentid="531718" data-postid="3882" data-belowelement="comment-531718" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-535381" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-535381" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5e6d8ea89bc31f09425dc0a9cbf36c56?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5e6d8ea89bc31f09425dc0a9cbf36c56?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jagadeesh</span>
	                <span class="date">May 19, 2020 at 11:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-535381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tutorial Jason. </p>
<p>I was planning to predict the values beyond the test data and got stuck in a confused state. It will be really helpful if you can provide some code snippets on predicting future unseen values, thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-535381' data-commentid="535381" data-postid="3882" data-belowelement="comment-535381" data-respondelement="respond" data-replyto="Reply to Jagadeesh" aria-label='Reply to Jagadeesh'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535399" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-535399" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 19, 2020 at 1:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-535399" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see this:<br />
<a href="https://machinelearningmastery.com/make-sample-forecasts-arima-python/" rel="nofollow ugc">https://machinelearningmastery.com/make-sample-forecasts-arima-python/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-535399' data-commentid="535399" data-postid="3882" data-belowelement="comment-535399" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535453" class="comment even depth-3">

	      	<div id="li-comment-535453" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5e6d8ea89bc31f09425dc0a9cbf36c56?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5e6d8ea89bc31f09425dc0a9cbf36c56?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jagadeesh</span>
	                <span class="date">May 19, 2020 at 11:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-535453" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That&#8217;s great Jason. Thank you for the link.<br />
Can you please provide any links related to LSTM unseen data forecast. Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-535453' data-commentid="535453" data-postid="3882" data-belowelement="comment-535453" data-respondelement="respond" data-replyto="Reply to Jagadeesh" aria-label='Reply to Jagadeesh'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535495" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-535495" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 20, 2020 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-535495" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, here:<br />
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow ugc">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-535495' data-commentid="535495" data-postid="3882" data-belowelement="comment-535495" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-536350" class="comment even thread-even depth-1">

	      	<div id="li-comment-536350" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3b12b341d24767598421a2b254a39a3f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3b12b341d24767598421a2b254a39a3f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/' rel='external nofollow ugc' class='url'>younes</a></span>
	                <span class="date">May 25, 2020 at 10:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-536350" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tutorial Jason.<br />
I have a question.</p>
<p>do we apply the difference() on all the data then we split it on trainset and testset</p>
<p>or first split the data into trainset and testset and then diffluence only the trainset</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-536350' data-commentid="536350" data-postid="3882" data-belowelement="comment-536350" data-respondelement="respond" data-replyto="Reply to younes" aria-label='Reply to younes'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-536413" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-536413" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 26, 2020 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-536413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There&#8217;s no right answer, perhaps choose an approach that is easiest for you to work with and does not lead to data leakage.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-536413' data-commentid="536413" data-postid="3882" data-belowelement="comment-536413" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-537544" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-537544" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c1f106d09f06f15dec5d424c18714e79?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c1f106d09f06f15dec5d424c18714e79?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">RAYENNE AMMAR</span>
	                <span class="date">June 1, 2020 at 11:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-537544" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Thanks a lot for this great article. I have a question on the Persistence Model if it works like the naif model as they both require the previous observation to predict the next one?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-537544' data-commentid="537544" data-postid="3882" data-belowelement="comment-537544" data-respondelement="respond" data-replyto="Reply to RAYENNE AMMAR" aria-label='Reply to RAYENNE AMMAR'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537564" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-537564" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 1, 2020 at 1:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-537564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>What is &#8220;naif&#8221;?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-537564' data-commentid="537564" data-postid="3882" data-belowelement="comment-537564" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537614" class="comment even depth-3">

	      	<div id="li-comment-537614" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c1f106d09f06f15dec5d424c18714e79?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c1f106d09f06f15dec5d424c18714e79?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">RAYENNE AMMAR</span>
	                <span class="date">June 1, 2020 at 11:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-537614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m sorry, I meant naive model</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-537614' data-commentid="537614" data-postid="3882" data-belowelement="comment-537614" data-respondelement="respond" data-replyto="Reply to RAYENNE AMMAR" aria-label='Reply to RAYENNE AMMAR'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-540654" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-540654" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e283a61459f99da103b5e6dbbe23e2d7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e283a61459f99da103b5e6dbbe23e2d7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pablo</span>
	                <span class="date">June 23, 2020 at 11:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-540654" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the great post. My question is, does it make sense to use LSTM when looking only one step back? Or is just for example purpose.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-540654' data-commentid="540654" data-postid="3882" data-belowelement="comment-540654" data-respondelement="respond" data-replyto="Reply to Pablo" aria-label='Reply to Pablo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-540676" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-540676" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 23, 2020 at 1:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-540676" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Probably not. Generally, I recommend testing a suite of models and discover what works best for your dataset.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-540676' data-commentid="540676" data-postid="3882" data-belowelement="comment-540676" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-543059" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-543059" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9d7d442d98d19c33167b97bc1d76e762?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9d7d442d98d19c33167b97bc1d76e762?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">July 7, 2020 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543059" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, many thanks for your brilliant post. I am a beginner and I have three questions if I might ask:</p>
<p>1. In feature scaling, when you do scaler_fit(train), does it mean that you will scale the test data using the fit of the scaler on the training data?</p>
<p>2. You mentioned that to achieve a better level of accuracy and minimise the loss, we could tune our LSTM model. How do you find the best configuration for your model and data?</p>
<p>3. How would you add a Dropout layer (in coding terms) for better regularisation?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543059' data-commentid="543059" data-postid="3882" data-belowelement="comment-543059" data-respondelement="respond" data-replyto="Reply to Marco" aria-label='Reply to Marco'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-543087" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-543087" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 7, 2020 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543087" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>When we fit the scaler on training data, we estimate the properties required by the scaler from the training dataset. We can then use the scaler to transform the training dataset, test dataset, and other datasets:<br />
<a href="https://machinelearningmastery.com/standardscaler-and-minmaxscaler-transforms-in-python/" rel="nofollow ugc">https://machinelearningmastery.com/standardscaler-and-minmaxscaler-transforms-in-python/</a></p>
<p>The only way to find a good/best config for a model is to use controlled experiments and test many hyperparameter configurations.</p>
<p>Here&#8217;s an example of adding dropout for LSTMs:<br />
<a href="https://machinelearningmastery.com/use-dropout-lstm-networks-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/use-dropout-lstm-networks-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543087' data-commentid="543087" data-postid="3882" data-belowelement="comment-543087" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-543089" class="comment odd alt depth-3">

	      	<div id="li-comment-543089" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9d7d442d98d19c33167b97bc1d76e762?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9d7d442d98d19c33167b97bc1d76e762?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">July 7, 2020 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543089" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Many thanks for your reply.</p>
<p>I get the testing many hyperparameters, but perhaps do you have an example on how to conduct controlled experiments?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543089' data-commentid="543089" data-postid="3882" data-belowelement="comment-543089" data-respondelement="respond" data-replyto="Reply to Marco" aria-label='Reply to Marco'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-543112" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-543112" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 7, 2020 at 1:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543112" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can see many exampels on the blog, perhaps start here:<br />
<a href="https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543112' data-commentid="543112" data-postid="3882" data-belowelement="comment-543112" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-543096" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-543096" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4a993a5069e6fc0a7f9d982739c30384?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a993a5069e6fc0a7f9d982739c30384?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thomas</span>
	                <span class="date">July 7, 2020 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, your website is dope! </p>
<p>I have tried this model with a larger data (3774 rows) and set the test at 20%. However, when I plot the predictions, they are just like the raw data! Does this mean that I am overfitting the model? Any solution in regards? cheers!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543096' data-commentid="543096" data-postid="3882" data-belowelement="comment-543096" data-respondelement="respond" data-replyto="Reply to Thomas" aria-label='Reply to Thomas'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-543117" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-543117" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 7, 2020 at 2:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543117" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>I recommend testing a suite of models, model configurations and data preparation techniques in order to discover what works best for your specific dataset.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543117' data-commentid="543117" data-postid="3882" data-belowelement="comment-543117" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-543126" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-543126" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0c7ae5d64e8cd75989d7b73810b1f8ad?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0c7ae5d64e8cd75989d7b73810b1f8ad?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jacob</span>
	                <span class="date">July 7, 2020 at 6:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543126" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, My question is, if I want to try different learning rates, do I just have to put it next to adam? e.g., optimizer=&#8217;adam(lr=n)&#8217;</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543126' data-commentid="543126" data-postid="3882" data-belowelement="comment-543126" data-respondelement="respond" data-replyto="Reply to Jacob" aria-label='Reply to Jacob'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-543179" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-543179" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 8, 2020 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-543179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You. must use SGD to test different learning rates.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-543179' data-commentid="543179" data-postid="3882" data-belowelement="comment-543179" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-545049" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-545049" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">July 19, 2020 at 8:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, great tutorial!</p>
<p>I am struggling to implement your differencing (and inverse difference) method on multivariate data. It works when I have only one column of data, but how do I modify it when I have more than one column?</p>
<p>Thanks and keep doing this amazing work!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545049' data-commentid="545049" data-postid="3882" data-belowelement="comment-545049" data-respondelement="respond" data-replyto="Reply to James" aria-label='Reply to James'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545098" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-545098" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 20, 2020 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545098" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could try the transforms one variable at a time, then once your comfortable try simplifying the code to do it all at once.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545098' data-commentid="545098" data-postid="3882" data-belowelement="comment-545098" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545176" class="comment odd alt depth-3">

	      	<div id="li-comment-545176" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">July 20, 2020 at 11:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your reply Jason.</p>
<p>I have figured out how to differentiate all variables &#8211; using .diff(periods=n).</p>
<p>Then I know how to inverse it:<br />
e.g.,<br />
data_differentiated.iloc[0] = normal_data.iloc[0]<br />
data_inverted_back = data_diff.cumsum()</p>
<p>However, I am struggling to implement this after having made a one-step forecast and after having scaled back. Do you think you could help me with that? that would be very appreciated!<br />
Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545176' data-commentid="545176" data-postid="3882" data-belowelement="comment-545176" data-respondelement="respond" data-replyto="Reply to James" aria-label='Reply to James'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545206" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-545206" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 21, 2020 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Maybe this will help:<br />
<a href="https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545206' data-commentid="545206" data-postid="3882" data-belowelement="comment-545206" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545295" class="comment odd alt depth-5">

	      	<div id="li-comment-545295" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">July 21, 2020 at 10:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545295" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your response.</p>
<p>I have tried to follow this post, but when I use my multivariate data I get , which relates to the interval but I do not know how to correctly modify it. Any advise ?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-545349" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-545349" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 22, 2020 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545349" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don&#8217;t have the capacity to prepare custom code for you. Perhaps you can learn from other examples on the blog, there are hundreds on this topic, perhaps start here:<br />
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-545337" class="comment odd alt depth-5">

	      	<div id="li-comment-545337" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e222e5f5a09ccd2d537876d0fbc818f9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">July 22, 2020 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545337" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p># I get </p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-545645" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-545645" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/180a979041e5e37652210640aa6161c1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/180a979041e5e37652210640aa6161c1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sanat</span>
	                <span class="date">July 23, 2020 at 4:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I have a dataset of customers_number ,sales and date. I have used LSTM and ARIMA both worked for whole dataset but I want to find it customer wise so how can I do it? I there another way? can you please enlighten me in this issue?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545645' data-commentid="545645" data-postid="3882" data-belowelement="comment-545645" data-respondelement="respond" data-replyto="Reply to Sanat" aria-label='Reply to Sanat'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545711" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-545711" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 24, 2020 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-545711" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don&#8217;t follow your question, perhaps you can rephrase it?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545711' data-commentid="545711" data-postid="3882" data-belowelement="comment-545711" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-575660" class="comment even thread-even depth-1">

	      	<div id="li-comment-575660" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9b6bda4a5f9fe2ba9c7d5512e9be9f14?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9b6bda4a5f9fe2ba9c7d5512e9be9f14?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">dis</span>
	                <span class="date">November 16, 2020 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-575660" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the detailed and well-explained post. I wonder if there is a way to add some covariates to help prediction in the LSTM model? Or is it possible to do multi-dimensional time series prediction in LSTM? Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-575660' data-commentid="575660" data-postid="3882" data-belowelement="comment-575660" data-respondelement="respond" data-replyto="Reply to dis" aria-label='Reply to dis'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-575663" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-575663" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 16, 2020 at 8:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-575663" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see examples here:<br />
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-575663' data-commentid="575663" data-postid="3882" data-belowelement="comment-575663" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-580926" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-580926" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0778445c8d7acb7a1df9375c2ac6965b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0778445c8d7acb7a1df9375c2ac6965b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dr D Niyogi</span>
	                <span class="date">December 5, 2020 at 7:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-580926" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jasan,</p>
<p>Excellent post! Thank you!!!</p>
<p>I have a question: suppose I have the following code:</p>
<p># fit the model<br />
lstm_model = fit_lstm(train_scaled, 1, 3000, 4)<br />
# forecast the entire training dataset to build up state for forecasting<br />
train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br />
train_predicted = lstm_model.predict(train_reshaped, batch_size=1)</p>
<p>where train_predicted will have the predictions for the training data. Now we have to invert scale and invert differentiation. The routines you have provided (invert_scale and inverse_difference) cannot be applied for &#8220;train_predicted&#8221;. Could you please show me how to invert scale and invert differentiate &#8220;train_predicted&#8221;?</p>
<p>Many thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-580926' data-commentid="580926" data-postid="3882" data-belowelement="comment-580926" data-respondelement="respond" data-replyto="Reply to Dr D Niyogi" aria-label='Reply to Dr D Niyogi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-580965" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-580965" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 5, 2020 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-580965" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Yes, see this:<br />
<a href="https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-580965' data-commentid="580965" data-postid="3882" data-belowelement="comment-580965" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-588484" class="comment even thread-even depth-1">

	      	<div id="li-comment-588484" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/65db411d81249217881ba4aa3d7b5d8a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65db411d81249217881ba4aa3d7b5d8a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joseph</span>
	                <span class="date">December 25, 2020 at 2:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-588484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey,</p>
<p>I&#8217;ve seen examples where you don&#8217;t reset the states. Which would you recommend?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-588484' data-commentid="588484" data-postid="3882" data-belowelement="comment-588484" data-respondelement="respond" data-replyto="Reply to Joseph" aria-label='Reply to Joseph'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-588516" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-588516" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 25, 2020 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-588516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend testing a suite of algorithms and algorithm configurations and discover what works best for your specific dataset.</p>
<p>In practice, I have not seen much difference between stateful and stateless LSTMs. Perhaps I&#8217;m too heavy-handed with my model training.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-588516' data-commentid="588516" data-postid="3882" data-belowelement="comment-588516" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-588520" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-588520" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/65db411d81249217881ba4aa3d7b5d8a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65db411d81249217881ba4aa3d7b5d8a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joseph</span>
	                <span class="date">December 25, 2020 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-588520" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, </p>
<p>You used a long loop (walk-forward) to predict each input, when you could&#8217;ve just given the predict function all the samples, and it seems to loop through them and give the predictions. Whether loop was used to go through each input of the test or not, the results seem to be the same. Correct me if I&#8217;m wrong.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-588520' data-commentid="588520" data-postid="3882" data-belowelement="comment-588520" data-respondelement="respond" data-replyto="Reply to Joseph" aria-label='Reply to Joseph'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-588528" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-588528" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 25, 2020 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-588528" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps, as long as the data is not shuffled.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-588528' data-commentid="588528" data-postid="3882" data-belowelement="comment-588528" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-594096" class="comment even thread-even depth-1">

	      	<div id="li-comment-594096" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3d546bb9b44bdd5dd39d2057507b2e62?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d546bb9b44bdd5dd39d2057507b2e62?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SRan</span>
	                <span class="date">January 23, 2021 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-594096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br />
Thanks a lot for your post. I want to make predictions for the next 12 months, so in my test data, I only have months, but no sales value. It can only prediction for the first month, and the rest shows NAN. So seems like it also use expected value as input. So how to predict for the next 12 steps instead of only 1 step?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-594096' data-commentid="594096" data-postid="3882" data-belowelement="comment-594096" data-respondelement="respond" data-replyto="Reply to SRan" aria-label='Reply to SRan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594106" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-594106" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 23, 2021 at 12:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-594106" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>One approach is to use the same model and use the output as input 12 times.</p>
<p>Another approach is to change the model to predict 12 steps directly.</p>
<p>Perhaps try both approaches and see what works best for you.</p>
<p>This will help you get started:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-594106' data-commentid="594106" data-postid="3882" data-belowelement="comment-594106" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594267" class="comment even depth-3">

	      	<div id="li-comment-594267" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3d546bb9b44bdd5dd39d2057507b2e62?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d546bb9b44bdd5dd39d2057507b2e62?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SRan</span>
	                <span class="date">January 25, 2021 at 4:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-594267" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks a lot for your reply. I went through all the comments from other people. Seems like many people have the same question as I do. I wonder if you can post an example to predict next many steps (not the test data). There are at least two problems I am suffering with (many other people as well): 1. how to keep using the output as input to continuously predict 2. how to scale the predicted data and inverse scale it (what if the future data is not in the scale of the training data? For example, I would expect the total Covid number keeps growing, the number I want to predict might be hundred times larger than the training data. How to do the scale?) I would really appreciate if you can post such an example. That will help to answer many people&#8217;s questions. Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-594267' data-commentid="594267" data-postid="3882" data-belowelement="comment-594267" data-respondelement="respond" data-replyto="Reply to SRan" aria-label='Reply to SRan'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594279" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-594279" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 25, 2021 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-594279" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>
<p>There are tens of examples of LSTMs for multi-step prediction on the blog. I recommend starting with them.</p>
<p>If you are having trouble with scaling the data, this will help:<br />
<a href="https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-594279' data-commentid="594279" data-postid="3882" data-belowelement="comment-594279" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594284" class="comment even depth-5">

	      	<div id="li-comment-594284" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3d546bb9b44bdd5dd39d2057507b2e62?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d546bb9b44bdd5dd39d2057507b2e62?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SRan</span>
	                <span class="date">January 25, 2021 at 7:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-594284" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason. I am aware of your nice posts on the multi-step predictions. But they all work on test data. I think what we are looking for is an example to predict for a period of time in the future, either one step or multi step methods.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-594286" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-594286" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 25, 2021 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-594286" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is exactly the same code to predict on a test set vs out of sample data.</p>
<p>If making a prediction on data is a new idea for you, this may help:<br />
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-598844" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-598844" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shervin</span>
	                <span class="date">February 26, 2021 at 2:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-598844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.<br />
I have rather simple question.<br />
Where do we actually define number of cells of each block in each LSTM layer?<br />
I haven&#8217;t found the answer any where in your tutorials about LSTM implementation with keras.<br />
Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598844' data-commentid="598844" data-postid="3882" data-belowelement="comment-598844" data-respondelement="respond" data-replyto="Reply to Shervin" aria-label='Reply to Shervin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598880" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-598880" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 26, 2021 at 5:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-598880" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>An LSTM layer has a number of units, like &#8220;neurons&#8221; or &#8220;nodes&#8221;. Cells and blocks are no longer discussed.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598880' data-commentid="598880" data-postid="3882" data-belowelement="comment-598880" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598915" class="comment even depth-3">

	      	<div id="li-comment-598915" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shervin</span>
	                <span class="date">February 26, 2021 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-598915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot for reply.<br />
Do you have any tutorial on the mentioned difference or any useful links discussed?<br />
If not, so how do these nodes interact in this case?<br />
I fully appreciate your assistance.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598915' data-commentid="598915" data-postid="3882" data-belowelement="comment-598915" data-respondelement="respond" data-replyto="Reply to Shervin" aria-label='Reply to Shervin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598917" class="comment odd alt depth-4">

	      	<div id="li-comment-598917" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shervin</span>
	                <span class="date">February 26, 2021 at 8:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-598917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In this case, do we act each LSTM layer as single block consisting cells with given number of neurons (in terms of blocks and cells)?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598917' data-commentid="598917" data-postid="3882" data-belowelement="comment-598917" data-respondelement="respond" data-replyto="Reply to Shervin" aria-label='Reply to Shervin'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-598941" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-598941" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 26, 2021 at 1:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-598941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The nodes do not interact.</p>
<p>Perhaps this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-is-data-processed-by-an-lstm" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-is-data-processed-by-an-lstm</a></p>
<p>And this:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>
<p>And these:<br />
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#lstm</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598941' data-commentid="598941" data-postid="3882" data-belowelement="comment-598941" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598997" class="comment odd alt depth-5">

	      	<div id="li-comment-598997" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b8167c5d4fcd603d1d8861583c1e70f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shervin</span>
	                <span class="date">February 26, 2021 at 10:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-598997" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks so much Jason.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-599060" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-599060" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 27, 2021 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-599060" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-599711" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-599711" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1b97cdf27ddae517602009d0ff2ff9b1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b97cdf27ddae517602009d0ff2ff9b1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://-' rel='external nofollow ugc' class='url'>Belle</a></span>
	                <span class="date">March 3, 2021 at 1:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-599711" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi  Jason, I have a question&#8230;<br />
How to fix seed ?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-599711' data-commentid="599711" data-postid="3882" data-belowelement="comment-599711" data-respondelement="respond" data-replyto="Reply to Belle" aria-label='Reply to Belle'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-599724" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-599724" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 3, 2021 at 1:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-599724" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Tough question, see this:<br />
<a href="https://machinelearningmastery.com/reproducible-results-neural-networks-keras/" rel="nofollow ugc">https://machinelearningmastery.com/reproducible-results-neural-networks-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-599724' data-commentid="599724" data-postid="3882" data-belowelement="comment-599724" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-600454" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-600454" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e0af973a1b4af24608532966e60455c5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e0af973a1b4af24608532966e60455c5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">ronak</span>
	                <span class="date">March 10, 2021 at 8:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-600454" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, i have a question&#8230; I am new on Machin learning and Python also Anaconda&#8230;</p>
<p>I tried your first example in machin learning (iris flowers) and it was easy to follow and apply the commands on the Anaconda powershell prompt.<br />
But now for the time-series forecasting, at the very beginig stage i have a problem with opening .CSV file and define it as the variable (series). i have saved it as you said in the my current diroctory and i see it clearly when i search in the prompt. i have no error untill print(series.head())=&gt; here i get this error:</p>
<p>&gt;&gt;&gt; # summarize first few rows<br />
&gt;&gt;&gt; print(series.head())<br />
Traceback (most recent call last):<br />
  File &#8220;&#8221;, line 1, in<br />
NameError: name &#8216;series&#8217; is not defined</p>
<p>I do not know why it did not defined the series variable containing shampoosales.csv values!</p>
<p>it is good to mention thet i have tried to enter my csv values using URL and it worked to show the head of dataset.</p>
<p>thank you for your response in advance,<br />
Ronak</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-600454' data-commentid="600454" data-postid="3882" data-belowelement="comment-600454" data-respondelement="respond" data-replyto="Reply to ronak" aria-label='Reply to ronak'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-600480" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-600480" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 11, 2021 at 5:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/#comment-600480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The error suggests you might have skipped some lines of code.</p>
<p>Perhaps save the code in a .py script file and run from the command line, this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-600480' data-commentid="600480" data-postid="3882" data-belowelement="comment-600480" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/time-series-forecasting-long-short-term-memory-network-python/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required='true' /><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required='true' /><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30" /><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment" /> <input type='hidden' name='comment_post_ID' value='3882' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="18356b7fb7" /></p><input type="hidden" id="ak_js" name="ak_js" value="55"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt='' src='https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=88&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=176&#038;d=mm&#038;r=g 2x' class='avatar avatar-88 photo' height='88' width='88' loading='lazy'/></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_linkedin3.png" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_twitter3.png" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_facebook3.png" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="/newsletter/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_email3.png" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_rss3.png" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-48" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2018/11/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Develop LSTM Models for Time Series Forecasting" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow">How to Develop LSTM Models for Time Series Forecasting</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2018/08/Plot-of-Multi-Headed-1D-CNN-for-Multivariate-Time-Series-Forecasting-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of Multi-Headed 1D CNN for Multivariate Time Series Forecasting" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/" rel="nofollow">How to Develop Convolutional Neural Network Models for Time Series Forecasting</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2018/10/How-to-Develop-LSTM-Models-for-Multi-Step-Time-Series-Forecasting-of-Household-Power-Consumption-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Develop LSTM Models for Multi-Step Time Series Forecasting of Household Power Consumption" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/" rel="nofollow">Multi-Step LSTM Time Series Forecasting Models for Power Usage</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/cnn-models-for-human-activity-recognition-time-series-classification/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2018/07/Histograms-of-each-variable-in-the-training-data-set-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Histograms of each variable in the training data set" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/cnn-models-for-human-activity-recognition-time-series-classification/" rel="nofollow">1D Convolutional Neural Network Models for Human Activity Recognition</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2017/06/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Line Plots of Air Pollution Time Series" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow">Multivariate Time Series Forecasting with LSTMs in Keras</a></div></div></div></div><div id="custom_html-11" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p><h4>Loving the Tutorials?</h4></p>

<p>The <a href="/deep-learning-for-time-series-forecasting/" rel="nofollow">Deep Learning for Time Series</a> EBook is where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<a href="/deep-learning-for-time-series-forecasting/" class="woo-sc-button  red" ><span class="woo-">&gt;&gt; See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2021 Machine Learning Mastery Pty. Ltd. All Rights Reserved.<br />
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="/newsletter/">Newsletter</a> |
<a href="/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a> |
<a href="/sitemap/">Sitemap</a> |
<a href="/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script data-cfasync="false" type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip -->
<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript" id='rocket-browser-checker-js-after'>
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript" id='rocket-delay-js-js-after'>
(function() {
"use strict";var e=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function r(e,t){n(this,r),this.attrName="data-rocketlazyloadscript",this.browser=t,this.options=this.browser.options,this.triggerEvents=e,this.userEventListener=this.triggerListener.bind(this)}return e(r,[{key:"init",value:function(){this._addEventListener(this)}},{key:"reset",value:function(){this._removeEventListener(this)}},{key:"_addEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.addEventListener(e,t.userEventListener,t.options)})}},{key:"_removeEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.removeEventListener(e,t.userEventListener,t.options)})}},{key:"_loadScriptSrc",value:function(){var r=this,e=document.querySelectorAll("script["+this.attrName+"]");0!==e.length&&Array.prototype.slice.call(e).forEach(function(e){var t=e.getAttribute(r.attrName);e.setAttribute("src",t),e.removeAttribute(r.attrName)}),this.reset()}},{key:"triggerListener",value:function(){this._loadScriptSrc(),this._removeEventListener(this)}}],[{key:"run",value:function(){RocketBrowserCompatibilityChecker&&new r(["keydown","mouseover","touchmove","touchstart","wheel"],new RocketBrowserCompatibilityChecker({passive:!0})).init()}}]),r}();t.run();
}());
</script>
<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript" id='rocket-preload-links-js-extra'>
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/register\/machine-learning-university\/|\/courses\/\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/|\/courses\/course-get-started\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/lessons\/why-machine-learning-does-not-have-to-be-so-hard\/|\/courses\/course-get-started\/lessons\/how-to-think-about-machine-learning\/|\/courses\/course-get-started\/lessons\/find-your-machine-learning-tribe\/|\/courses\/step-by-step-process\/|\/courses\/probability-for-machine-learning\/|\/account\/|\/register\/|\/courses\/|\/machine-learning-mastery-university-registration\/|\/register\/|\/(.+\/)?feed\/?.+\/?|\/(?:.+\/)?embed\/|\/(index\\.php\/)?wp\\-json(\/.*|$)|\/wp-admin\/|\/logout\/|\/login\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|php|pdf|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript" id='rocket-preload-links-js-after'>
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>



<script type="3b5abb8e72fb21a4ffcb9f32-text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="https://machinelearningmastery.com/wp-content/plugins/wp-rocket/assets/js/lazyload/16.1/lazyload.min.js" type="3b5abb8e72fb21a4ffcb9f32-text/javascript"></script><script src="https://machinelearningmastery.com/wp-content/cache/min/1/37f2c3ef4d16d45db0325b5a99297c4b.js" data-minify="1" defer type="3b5abb8e72fb21a4ffcb9f32-text/javascript"></script><script src="https://ajax.cloudflare.com/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="3b5abb8e72fb21a4ffcb9f32-|49" defer=""></script></body>
</html>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->